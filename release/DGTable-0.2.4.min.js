'use strict';(function(k,c){var g=navigator.userAgent,h=-1!=g.indexOf("MSIE ")?parseFloat(g.substr(g.indexOf("MSIE ")+5)):null,t=h&&10>h,s=h&&10>h,r=_.bind(document.createElement,document),u=Backbone.View.extend({className:"dgtable-wrapper",tagName:"div",VERSION:"0.2.4",initialize:function(a){function b(a){a=a||event;a=a.toElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||g.Pa.call(g,this)}function e(a){a=a||event;
a=a.fromElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||g.Qa.call(g,this)}a=a||{};a.columns=a.columns||[];this.wa=_.bind(this.ab,this);this.ga=_.bind(this.Ya,this);this.xa=_.bind(this.cb,this);this.$el.on("dragend",this.ga);this.n=!0;this.S=!1;this.j=void 0===a.virtualTable?!0:!!a.virtualTable;this.r=a.rowsBufferSize||10;this.m=Math.max(a.minColumnWidth||35,0);this.U=a.resizeAreaWidth||8;this.M=void 0===a.resizableColumns?
!0:!!a.resizableColumns;this.B=void 0===a.movableColumns?!0:!!a.movableColumns;this.s=void 0===a.sortableColumns?1:parseInt(a.sortableColumns,10)||1;this.ca=void 0===a.adjustColumnWidthForSortArrow?!0:!!a.adjustColumnWidthForSortArrow;this.Oa=void 0===a.cellClasses?"":a.cellClasses;this.jb=void 0===a.resizerClassName?"dgtable-resize":a.resizerClassName;this.ha=void 0===a.tableClassName?"dgtable":a.tableClassName;this.R=void 0===a.allowCellPreview?!0:a.allowCellPreview;this.Ra=void 0===a.cellPreviewClassName?
"dgtable-cell-preview":a.cellPreviewClassName;this.qa=void 0===a.cellPreviewCreateCallback?null:a.cellPreviewCreateCallback;this.ra=void 0===a.cellPreviewDestroyCallback?null:a.cellPreviewDestroyCallback;this.H=void 0===a.comparatorCallback?null:a.comparatorCallback;this.Y=void 0===a.width?u.Width.NONE:a.width;this.fb=void 0===a.relativeWidthGrowsToFillWidth?!0:!!a.relativeWidthGrowsToFillWidth;this.gb=void 0===a.relativeWidthShrinksToFillWidth?!1:!!a.relativeWidthShrinksToFillWidth;this.I=a.formatter||
function(a){return a};var f,d,c,p,l=new u.La;for(p=f=0;f<a.columns.length;f++)d=a.columns[f],c=this.va(d),void 0!==d.e?(d.e>p&&(p=d.e+1),c.e=d.e):c.e=p++,l.push(c);l.oa();this.b=l;this.c=l.D();if(void 0===a.sortColumn)a.sortColumn=null;else if("string"==typeof a.sortColumn)this.b.get(a.sortColumn)?a.sortColumn=[{column:a.sortColumn,descending:!1}]:a.sortColumn=null;else if(a.sortColumn instanceof Array){p=[];f=0;d=a.sortColumn.length;for(c;f<d&&(c=a.sortColumn[f],c=void 0!==c.column?c:{column:c,descending:!1},
(c=this.b.get(c.column))&&!_.contains(p,c.name)&&p.push(c.name),p.length!=this.s&&p.length!=this.c.length);f++);a.sortColumn=p}else"object"==typeof a.sortColumn?this.b.get(a.sortColumn.column)||(a.sortColumn=null):a.sortColumn=null;this.f=new u.Ma({sortColumn:a.sortColumn,columns:this.columns});this.listenTo(this.f,"sort",this.render).listenTo(this.f,"requiresComparatorForColumn",_.bind(function(a,b,e){this.H&&(a.mb=this.H(b,e))},this));this.g=null;this.ta=a.height;this.A=0;var g=this;"addEventListener"in
window?(this.J=function(a){a.__hoverIn||a.addEventListener("mouseover",a.__hoverIn=_.bind(e,a));return this},this.X=function(a){a.__hoverIn&&(a.removeEventListener("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.fa=function(a){a.__hoverOut||a.addEventListener("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.ia=function(a){a.__hoverOut&&(a.removeEventListener("mouseout",a.__hoverOut),a.__hoverOut=null);return this}):(this.J=function(a){a.__hoverIn||a.attachEvent("mouseover",
a.__hoverIn=_.bind(e,a));return this},this.X=function(a){a.__hoverIn&&(a.detachEvent("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.fa=function(a){a.__hoverOut||a.attachEvent("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.ia=function(a){a.__hoverOut&&(a.detachEvent("mouseout",a.__hoverOut),a.__hoverOut=null);return this})},za:function(a){var b=parseFloat(a),e=n.AUTO;0<b&&(a==b+"%"?(e=n.RELATIVE,b/=100):0<b&&1>b?e=n.RELATIVE:(b<this.m&&(b=this.m),e=n.ABSOLUTE));return{width:b,
mode:e}},va:function(a){var b=this.za(a.width);return{name:a.name,label:void 0===a.label?a.name:a.label,width:b.width,o:b.mode,resizable:void 0===a.resizable?!0:a.resizable,sortable:void 0===a.sortable?!0:a.sortable,F:void 0===a.F?!0:a.F,visible:void 0===a.visible?!0:a.visible,cellClasses:void 0===a.cellClasses?this.Oa:a.cellClasses}},close:function(){this.i&&(this.i.remove(),this.i=null);this.remove();this.Ea().Fa();this.h.unbind();this.d.unbind();this.$el.unbind();this.unbind();if(this.p){for(var a=
0,b;a<this.p.length;a++)b=this.p[a],b.Ka.removeEventListener("message",b.Ja,!1);this.p.length=0}this.f.length=this.b.length=0;for(var e in this)this.hasOwnProperty(e)&&(this[e]=null)},Fa:function(){if(this.q)for(var a=0,b=this.q[0].childNodes,e=b.length,f;a<e;a++){f=b[a];var d=0;f=f.childNodes;for(var c=f.length;d<c;d++)this.X(f[d])}if(this.d)for(a=0,b=this.d[0].childNodes,e=b.length;a<e;a++)for(f=b[a],d=0,f=f.childNodes,c=f.length;d<c;d++)this.X(f[d]);return this},lb:function(a){var b=0;a=a.childNodes;
for(var e=a.length;b<e;b++)this.X(a[b]);return this},render:function(){if(!0===this.n){this.n=!1;this.d&&(this.A=this.d[0].scrollTop);this.Y==u.Width.AUTO&&this.sa();this.P(!0,!1).hb();var a=this.d[0].scrollHeight-this.d.height();this.A>a&&(this.A=a);this.d[0].scrollTop=this.A;this.j&&(this.d.on("scroll",_.bind(this.ya,this)),this.ya(null,!0));this.ka();for(a=0;a<this.f.sortColumn.length;a++)this.Ca(this.f.sortColumn[a].column,this.f.sortColumn[a].descending);this.ca&&this.P(!0);this.S=!1;this.trigger("renderSkeleton")}else this.j&&
this.Ba(this.A,this.d[0].scrollTop);this.trigger("render");return this},addColumn:function(a,b){if(a&&!this.b.get(a.name)){var e=null;void 0!==b&&(e=this.b.get(b)||this.b.aa(b));var f=this.va(a);f.e=e?e.e:this.b.Ia()+1;for(var e=this.b.Ia(),d=f.e,c;e>=d;e--)(c=this.b.aa(e))&&c.e++;this.b.push(f);this.b.oa();this.n=!0;this.c=this.b.D();this.render();this.trigger("addColumn",f.name)}return this},removeColumn:function(a){var b=this.b.indexOf(a);-1<b&&(this.b.splice(b,1),this.b.oa(),this.n=!0,this.c=
this.b.D(),this.render(),this.trigger("removeColumn",a));return this},filter:function(a,b,e){if(this.b.get(a)){var f=!!this.g;this.g&&(this.g=null);this.g=this.f.Ha(a,b,e);if(f||this.g)this.n=!0,this.render(),this.trigger("filter",a,b,e)}return this},T:function(){this.g&&(this.g=null,this.g=this.f.Ha(this.f.O,this.f.Z,this.f.na));return this},setColumnLabel:function(a,b){var e=this.b.get(a);if(e&&(e.label=void 0===b?e.name:b,e.element))for(var f=0;f<e.element[0].firstChild.childNodes.length;f++){var d=
e.element[0].firstChild.childNodes[f];if(3===d.nodeType){d.textContent=e.label;break}}return this},moveColumn:function(a,b){var e,f;"string"===typeof a?e=this.b.get(a):"number"===typeof a&&(e=this.c[a]);"string"===typeof b?f=this.b.get(b):"number"===typeof b&&(f=this.c[b]);if(e&&f&&a!==b){var d=e.e,c=f.e;this.c=this.b.moveColumn(e,f).D();if(this.j)this.n=!0,this.render();else{var p=this.q.find(">tr>th");f=d<c?c+1:c;p[0].parentNode.insertBefore(p[d],p[f]);for(var p=this.c[d],p=(p.u||p.k)+"px",l=this.c[c],
l=(l.u||l.k)+"px",g=this.d[0].childNodes,m=0,h=g.length,k;m<h;m++)k=g[m],1===k.nodeType&&(k.insertBefore(k.childNodes[d],k.childNodes[f]),k.childNodes[c].firstChild.style.width=l,k.childNodes[d].firstChild.style.width=p)}this.trigger("moveColumn",e.name,d,c)}return this},sort:function(a,b,e){var f=this.b.get(a);if(f){var d=this.f.sortColumn;d.length&&d[d.length-1].column==a&&(b=void 0===b?!d[d.length-1].descending:b);if(e){for(a=0;a<d.length;a++)if(d[a].column==f.name){a<d.length-1?d.length=0:d.splice(d.length-
1,1);break}if(0<this.s&&d.length>=this.s||d.length>=this.c.length)d.length=0}else d.length=0;d.push({column:f.name,descending:!(void 0===b||!b)});this.f.sortColumn=d;this.sa();for(a=0;a<d.length;a++)this.Ca(d[a].column,d[a].descending);this.ca&&this.P(!0);this.j||(this.n=!0);this.f.sort(!!this.g);this.T();this.g&&this.render();b=[];for(a=0;a<d.length;a++)b.push({column:d[a].column,descending:d[a].descending});this.trigger("sort",b)}return this},showColumn:function(a){var b=this.b.get(a);b&&!b.visible&&
(this.n=b.visible=!0,this.c=this.b.D(),this.render(),this.trigger("showColumn",a));return this},hideColumn:function(a){var b=this.b.get(a);b&&b.visible&&(b.visible=!1,this.n=!0,this.c=this.b.D(),this.render(),this.trigger("hideColumn",a));return this},setMinColumnWidth:function(a){a=Math.max(a,0);this.m!=a&&(this.m=a,this.P(!0));return this},getMinColumnWidth:function(){return this.m},setSortableColumns:function(a){if(this.s!=a&&(this.s=a,this.h)){a=this.h.find("thead>tr>th");for(var b=0;b<a.length;b++)c(a[0])[0<
this.s&&this.c[b].sortable?"addClass":"removeClass"]("sortable")}return this},getSortableColumns:function(){return this.s},setMovableColumns:function(a){a=!!a;this.B!=a&&(this.B=a);return this},getMovableColumns:function(){return this.B},setResizableColumns:function(a){a=!!a;this.M!=a&&(this.M=a);return this},getResizableColumns:function(){return this.M},setComparatorCallback:function(a){this.H!=a&&(this.H=a);return this},setColumnWidth:function(a,b){var e=this.za(b),f=this.b.get(a);if(f){var d=this.W(f);
f.width=e.width;f.o=e.mode;e=this.W(f);d!=e&&this.P(!0);this.trigger("setColumnWidth",f.name,d,e)}return this},getColumnWidth:function(a){return(a=this.b.get(a))?this.W(a):null},getColumnWidths:function(){for(var a={},b=0;b<this.b.length;b++)a[this.b[b].name]=this.W(this.b[b]);return JSON.stringify(a)},getComparatorCallback:function(){return this.H},getHtmlForCell:function(a,b){return 0>a||a>this.f.length-1||!this.b.get(b)?null:this.I(this.f[a][b],b)},K:function(a){return(parseFloat(c.css(a,"padding-left"))||
0)+(parseFloat(c.css(a,"padding-right"))||0)},Sa:function(a){return(parseFloat(c.css(a,"border-left"))||0)+(parseFloat(c.css(a,"border-right"))||0)},pa:function(){function a(a){var b=g(a,"width");return"auto"===b?(parseFloat(c(a).css("width"))||0)+1:parseFloat(b)||0}var b=this.$el.width(),e,f,d,v;if(this.h)e=this.h,f=this.q;else{e=d=c("<table></table>").css({position:"absolute",top:"-9999px",visibility:"hidden"}).addClass(this.ha);f=v=c("<thead></thead>");for(var p=c("<tr></tr>"),l=0;l<this.c.length;l++)p.append(c("<th><div></div></th>"));
d.append(v.append(p))}var g=window.getComputedStyle?function(a,b){var e=window.getComputedStyle(a,null);return e?e.getPropertyValue(b):null}:function(a,b){var e=a.currentStyle;return e?e[b]:null},b=b-this.Sa(e[0]);e=f.find(">tr>th");for(var l=0,m;l<e.length;l++)p=c(e[l].firstChild),v=c(e[l]),f=Math.max(parseFloat(v.css("border-left-width"))||0,0<l?parseFloat(c(e[l-1]).css("border-right-width"))||0:0),m="border-box"===v.css("boxSizing"),b-=f+(p.outerWidth()-p.width())+(a(v[0])+(m?0:this.K(v[0]))-p.outerWidth());
b-=parseFloat(c(e[e.length-1]).css("border-right-width"))||0;d&&d.remove();e=f=d=v=null;return b},P:function(){function a(a){a=c("<table><thead><tr><th>"+a+"</th></tr></thead></table>").css({position:"absolute",top:"-9999px",visibility:"hidden"}).addClass(this.ha);var b=a.find(">thead>tr>th");b.css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden"});a.appendTo(document.body);b=b.width();a.remove();return b}var b=null;return function(e,f){var d=this.pa(),c=d,p=0;if(c!=
b||e){b=d;var l,g=[],m,h;for(m=d=0;m<this.b.length;m++)this.b[m].u=null;for(m=0;m<this.c.length;m++)h=this.c[m],h.o==n.ABSOLUTE?(l=h.width,l+=h.ma||0,l<this.m&&(l=this.m),c-=l,l!==h.k&&(h.k=l,g.push(m))):h.o==n.AUTO?(l=_.bind(a,this)(h.label)+20,l+=h.ma||0,l<this.m&&(l=this.m),c-=l,l!==h.k&&(h.k=l,g.push(m))):h.o==n.RELATIVE&&(d+=h.width,p++);if(p&&(1>d&&this.fb||1<d&&this.gb))for(m=0;m<this.c.length;m++)h=this.c[m],h.o==n.RELATIVE&&(h.width/=d);d=c;for(m=0;m<this.c.length;m++)h=this.c[m],h.o==n.RELATIVE&&
(l=Math.round(d*h.width),l<this.m&&(l=this.m),c-=l,p--,0===p&&1===c&&(l++,c--),-1===c&&(l--,c++),l!==h.k&&(h.k=l,g.push(m)));this.c[this.c.length-1].u=this.c[this.c.length-1].k-(this.V||0);if(f||void 0===f)for(m=0;m<g.length;m++)this.ib(g[m])}return this}}(),addRows:function(a){if(a){this.scrollTop=this.$el.find(".table").scrollTop();var b=this.f.length;this.S=!0;this.f.add(a);if(this.j)this.T(),0===b&&(this.g||this.f).length&&(this.n=!0),this.render();else if(this.g)b=this.g.length,this.T(),this.g&&
this.g.length==b||(this.n=!0,this.render());else if(this.d){var e,f,d,c=this.R;d=document.createDocumentFragment();for(var h=0,l,g,m,k=this.c.length,t=a.length;h<t;h++){l=a[h];b=r("tr");b.setAttribute("data-row",h);for(g=0;g<k;g++)m=this.c[g],e=r("div"),e.style.width=(m.u||m.k)+"px",e.innerHTML=this.I(l[m.name],m.name),f=r("td"),m.cellClasses&&(f.className=m.cellClasses),c&&this.J(f),f.appendChild(e),b.appendChild(f);d.appendChild(b)}this.d[0].appendChild(d);this.ja()}this.trigger("addRows",a.length,
!1)}return this},setRows:function(a){this.scrollTop=this.$el.find(".table").scrollTop();this.f.reset(a);this.T();this.n=!0;this.render().trigger("addRows",a.length,!0);return this},getUrlForElementContent:function(a){if(a=document.getElementById(a)){a=a.textContent;if("function"===typeof Blob)a=new Blob([a]);else{var b=k.BlobBuilder||k.WebKitBlobBuilder||k.pb||k.ob;if(!b)return null;b=new b;b.append(a);a=b.getBlob()}return(k.URL||k.webkitURL).createObjectURL(a)}return null},isWorkerSupported:function(){return k.Worker instanceof
Function},createWebWorker:function(a,b){if(this.isWorkerSupported()){var e=this,f=new Worker(a),d=function(a){a.data.append?e.addRows(a.data.rows):e.setRows(a.data.rows)};f.addEventListener("message",d,!1);this.p||(this.p=[]);this.p.push({Ka:f,Ja:d});(b||void 0===b)&&f.postMessage(null);return f}return null},unbindWebWorker:function(a){if(this.p)for(var b=0;b<this.p.length;b++)this.p[b].Ka==a&&(a.removeEventListener("message",this.p[b].Ja,!1),this.p.splice(b,1),b--);return this},ya:function(a,b){if(!0===
b||this.A!==this.d[0].scrollTop){var e=parseInt(this.d[0].scrollTop/this.C,10),f=e-this.r;0>f&&(f=0);this.a.v=this.a.first;this.a.w=this.a.last;this.a.first=f;this.a.last=e+this.t+this.r;e=this.g||this.f;this.a.last>e.length&&(this.a.last=e.length,this.a.first=Math.max(0,this.a.last-this.t-2*this.r));this.Ba(this.A,this.d[0].scrollTop)}},cb:function(){this.q[0].scrollLeft=this.d[0].scrollLeft},ea:function(a){for(var b=this.L(),e=c(a.target).closest("th"),f=e[0],d=e[0].previousSibling;d&&1!=d.nodeType;)d=
d.previousSibling;var h=!d;a=(a.originalEvent.pageX||a.originalEvent.clientX)-e.offset().left;if(b){if(!h&&e.outerWidth()-a<=this.U/2)return d.l;if(a<=this.U/2)return f.l}else{if(!h&&a<=this.U/2)return d.l;if(e.outerWidth()-a<=this.U/2)return f.l}return null},$a:function(a){if(this.M){var b=this.ea(a);a=c(a.target).closest("th")[0];b&&this.b.get(b).resizable?a.style.cursor="e-resize":a.style.cursor=""}},Za:function(a){c(a.target).closest("th")[0].style.cursor=""},Ta:function(a){if(!this.ea(a)&&(a=
c(a.target).closest("th")[0],this.s)){var b=this.b.get(a.l);b&&b.sortable&&this.sort(a.l,void 0,!0)}},bb:function(a){var b=this.ea(a),e;if(b){e=this.b.get(b);if(!this.M||!e||!e.resizable)return!1;b=this.L();this.i&&c(this.i).remove();this.i=c("<div></div>").addClass(this.jb).css({position:"absolute",display:"block","z-index":-1,visibility:"hidden",width:"2px",background:"#000",opacity:0.7}).appendTo(this.$el);e=e.element;var f=this.i.parent(),d=e.offset(),g=f.offset();8==h&&(d=e.offset());g.left+=
parseFloat(f.css("border-left-width"))||0;g.top+=parseFloat(f.css("border-top-width"))||0;d.left-=g.left;d.top-=g.top;d.top-=parseFloat(e.css("border-top-width"))||0;f=this.i.outerWidth();b?d.left-=Math.ceil((parseFloat(e.css("border-left-width"))||0)/2):(d.left+=e.outerWidth(),d.left+=Math.ceil((parseFloat(e.css("border-right-width"))||0)/2));d.left-=Math.ceil(f/2);b=this.h.height()-(this.h.offset().top-e.offset().top);this.i.css({"z-index":"10",visibility:"visible",left:d.left,top:d.top,height:b})[0].l=
e[0].l;try{this.i[0].style.zIndex=""}catch(p){}c(document).on("mousemove",this.wa);c(document).on("mouseup",this.ga);a.preventDefault()}else this.B?(b=c(a.target).closest("th"),(e=this.b.get(b[0].l))&&e.F?(b[0].style.opacity=0.35,this.da=161061273*Math.random(),a.originalEvent.dataTransfer.setData("text",JSON.stringify({Ga:this.da,column:e.name}))):a.preventDefault()):a.preventDefault()},ab:function(a){var b=this.b.get(this.i[0].l),e=this.L(),b=b.element,f=this.i.parent(),d=b.offset(),c=f.offset();
c.left+=parseFloat(f.css("border-left-width"))||0;d.left-=c.left;f=this.i.outerWidth();a=a.pageX-c.left;d=d.left;e?(d+=b.outerWidth(),d-=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),d-=Math.ceil(f/2),d-=this.m,d-=this.K(b[0]),a>d&&(a=d)):(d+=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),d-=Math.ceil(f/2),d+=this.m,d+=this.K(b[0]),a<d&&(a=d));this.i.css("left",a+"px")},Ya:function(a){if(this.i){c(document).off("mousemove",this.wa);c(document).off("mouseup",this.ga);var b=this.b.get(this.i[0].l),
e=this.L(),f=b.element,d=this.i.parent(),h=f.offset(),g=d.offset();g.left+=parseFloat(d.css("border-left-width"))||0;h.left-=g.left;d=this.i.outerWidth();a=a.pageX-g.left;h=g=h.left;h=0;e?(a+=this.K(f[0]),g+=f.outerWidth(),g-=Math.ceil((parseFloat(f.css("border-right-width"))||0)/2),g-=Math.ceil(d/2),h=g-this.m,a>h&&(a=h),h=g-a):(a-=this.K(f[0]),g+=Math.ceil((parseFloat(f.css("border-right-width"))||0)/2),g-=Math.ceil(d/2),h=g+this.m,a<h&&(a=h),h=a-g);this.i.remove();this.i=null;e=h;if(b.o==n.RELATIVE){e=
this.pa();for(f=0;f<this.c.length;f++)d=this.c[f],d.o!=n.RELATIVE&&(e-=d.k);e=h/e*100;e+="%"}this.setColumnWidth(b.name,e)}else a.target.style.opacity=null},Ua:function(a){if(this.B){var b=a.originalEvent.dataTransfer.getData("text"),b=b?JSON.parse(b):null;a=c(a.target).closest("th");(!b||this.da==b.Ga&&a.l!==b.column)&&(b=this.b.get(a[0].l))&&(b.F||b!=this.c[0])&&c(a).addClass("drag-over")}},Wa:function(a){a.preventDefault()},Va:function(a){var b=c(a.target).closest("th");c(b[0].firstChild).has(a.originalEvent.relatedTarget).length||
b.removeClass("drag-over")},Xa:function(a){a.preventDefault();var b=JSON.parse(a.originalEvent.dataTransfer.getData("text"));a=c(a.target).closest("th");if(this.B&&b.Ga==this.da){var b=b.column,e=a[0].l,f=this.b.get(b),d=this.b.get(e);f&&d&&f.F&&(d.F||d!=this.c[0])&&this.moveColumn(b,e)}c(a).removeClass("drag-over")},sa:function(){if(this.h){var a=this.h.find(">thead>tr>th.sorted"),b=a.find(">div>.sort-arrow");_.forEach(b,_.bind(function(a){if(a=this.b.get(a.parentNode.parentNode.l))a.ma=0},this));
b.remove();a.removeClass("sorted").removeClass("desc")}return this},Ca:function(a,b){var e=this.b.get(a),f=r("span");f.className="sort-arrow";e.element.addClass(b?"sorted desc":"sorted");e.element[0].firstChild.insertBefore(f,e.element[0].firstChild.firstChild);e.o!=n.RELATIVE&&this.ca&&(e.ma=f.scrollWidth+(parseFloat(c(f).css("margin-right"))||0)+(parseFloat(c(f).css("margin-left"))||0));return this},ib:function(a){var b=this.h.find(">thead>tr>th"),e=this.b.get(b[a].l);if(e){b[a].firstChild.style.width=
e.k+"px";for(var b=(e.u||e.k)+"px",e=this.d[0].childNodes,c=this.j?1:0,d=e.length-(this.j?1:0),g;c<d;c++)g=e[c],1===g.nodeType&&(g.childNodes[a].firstChild.style.width=b);this.ka()}return this},Ea:function(){this.h&&this.h.find(">thead>tr>th").off("mousemove").off("mouseleave").off("dragstart").off("selectstart").off("click").find(">div").off("dragenter").off("dragover").off("dragleave").off("drop");return this},hb:function(){var a=0;this.N&&(a=parseFloat(this.N.style.height));this.Ea().Fa();var b,
e,f,d,g,h,l,k,m,n,y=this.R,A=r("tr"),q;s&&(q=function(a){a.preventDefault();this.qb();return!1});for(b=0;b<this.c.length;b++)if(d=this.c[b],d.visible&&(l=r("div"),l.style.width=d.k+"px",l.innerHTML=d.label,m=r("th"),m.draggable=!0,this.s&&d.sortable&&(m.className="sortable"),m.l=d.name,y&&this.J(m),m.appendChild(l),A.appendChild(m),this.c[b].element=c(m),c(m).on("mousemove",_.bind(this.$a,this)).on("mouseleave",_.bind(this.Za,this)).on("dragstart",_.bind(this.bb,this)).on("click",_.bind(this.Ta,this)),
c(l).on("dragenter",_.bind(this.Ua,this)).on("dragover",_.bind(this.Wa,this)).on("dragleave",_.bind(this.Va,this)).on("drop",_.bind(this.Xa,this)),s))c(m).on("selectstart",_.bind(q,m));this.h&&this.j&&(this.d.off("scroll"),this.h.remove());"static"==this.$el.css("position")&&this.$el.css("position","relative");y=this.R;this.j||!this.h?(d=document.createDocumentFragment(),b=r("table"),b.className=this.ha,d.appendChild(b),m=r("thead"),m.style.display="block",t&&c(m).css({"float":"rtl"==this.$el.css("direction")?
"right":"left",clear:"both"}),b.appendChild(m),q=r("tbody"),q.style.maxHeight=this.ta+"px",q.style.display="block",q.style.overflowY="auto",q.style.overflowX="hidden",t&&c(q).css({"float":"rtl"==this.$el.css("direction")?"right":"left",clear:"both"}),this.Y==u.Width.SCROLL&&(m.style.overflowX="hidden",q.style.overflowX="auto"),b.appendChild(q),this.el.appendChild(d),this.h=c(b),this.d=c(q),this.q=c(m)):(b=this.h[0],q=this.d[0],m=this.q[0]);this.j&&!this.C&&(l=function(){var a=r("tr");a.appendChild(r("td")).appendChild(r("div")).innerHTML=
"0";a.style.visibility="hidden";a.style.position="absolute";return a},b=q.appendChild(l()),d=q.appendChild(l()),l=q.appendChild(l()),this.C=c(d).outerHeight(),q.removeChild(b),q.removeChild(d),q.removeChild(l),this.t=parseInt(this.ta/this.C,10));var w=this.g||this.f;this.j&&(this.a&&this.a.last-this.a.first>=this.t?(this.a.v=this.a.v!=this.a.first?this.a.v:this.a.first,this.a.w=this.a.w!=this.a.last?this.a.w:this.a.last,this.a.last>w.length&&(this.a.last=w.length,this.a.first=Math.max(0,this.a.last-
this.t-2*this.r))):(b=this.t+this.r,b>w.length&&(b=w.length),this.a={first:0,last:b,v:0,w:b}));var x=document.createDocumentFragment();this.j&&(k=this.N=document.createElement("tr"),k.style.height=a+"px",x.appendChild(k));var z;this.j?(b=this.a.first,z=this.a.last):(b=0,z=w.length);g=this.c.length;for(h=w.length;b<h&&b<z;b++){e=w[b];k=document.createElement("tr");k.setAttribute("data-row",b);for(f=0;f<g;f++)d=this.c[f],l=document.createElement("div"),l.style.width=d.k+"px",l.innerHTML=this.I(e[d.name],
d.name),n=document.createElement("td"),d.cellClasses&&(n.className=d.cellClasses),y&&this.J(n),n.appendChild(l),k.appendChild(n);x.appendChild(k)}this.j&&(k=this.la=document.createElement("tr"),k.style.height=this.C*Math.max(0,w.length-this.t-this.r)-a+"px",x.appendChild(k));try{m.innerHTML=""}catch(B){m.textContent=""}m.appendChild(A);try{q.innerHTML=""}catch(C){q.textContent=""}q.appendChild(x);this.ja(!0);this.j&&this.G();return this},ja:function(a){var b=this.d[0].offsetWidth-this.d[0].clientWidth;
if(b!=this.V||a){this.V=b;for(a=0;a<this.b.length;a++)this.b[a].u=null;if(0<this.V){b=this.c.length-1;this.c[b].u=this.c[b].k-this.V;var e=this.c[b].u+"px",c=this.d[0].childNodes;a=this.j?1:0;for(var d=c.length-(this.j?1:0),g;a<d;a++)g=c[a],1===g.nodeType&&(g.childNodes[b].firstChild.style.width=e)}}return this},Ba:function(a,b){var e,c,d=this.a.last-this.a.first-(this.a.w-this.a.v),g=this.t+this.r;if(b<a)e=this.a.first,c=this.a.v,this.a.last<=this.a.v&&(e=this.a.first,c=this.a.last),this.a.v=this.a.first,
this.a.w=this.a.last,this.Aa(c-e-d,!1),this.ba(e,c,!0),this.G();else if(b>a)e=this.a.w,c=this.a.last,this.a.first>=this.a.w&&(e=this.a.first,c=this.a.last),this.a.v=this.a.first,this.a.w=this.a.last,this.Aa(c-e-d,!0),this.ba(e,c,!1),this.G();else if(this.S)this.S=!1,c=this.g||this.f,this.a.last<c.length&&this.a.last<g&&(e=this.a.last,c=c.length,c>g&&(c=g),this.ba(e,c,!1),this.a.last=c),this.G();else{this.G();this.eb(this.a.first);return}this.ja();this.ka();this.A=this.d[0].scrollTop},G:function(){var a=
((this.g||this.f).length-(this.d[0].childNodes.length-2))*this.C;if(0>a)this.N.style.height=0,this.la.style.height=0;else{var b=this.a.first*this.C;this.N.style.height=b+"px";this.la.style.height=a-b+"px"}},ba:function(a,b,c){if(c)for(c=this.N.nextSibling;c&&1!=c.nodeType;)c=c.nextSibling;else c=this.la;for(;a<b;a++)this.Na(a,c)},Na:function(a,b){var c=document.createElement("tr");c.setAttribute("data-row",a);for(var f=this.g||this.f,d=this.R,g=0,h,l,k;g<this.c.length;g++)h=this.c[g],l=document.createElement("div"),
l.style.width=(h.u||h.k)+"px",l.innerHTML=this.I(f[a][h.name],h.name),k=document.createElement("td"),h.cellClasses&&(k.className=h.cellClasses),d&&this.J(k),k.appendChild(l),c.appendChild(k);this.d[0].insertBefore(c,b)},Aa:function(a,b){var c,f;a>this.t+2*this.r&&(a=this.t+2*this.r);var d=this.d[0],g=d.childNodes;f=this.d[0].childNodes.length-2;b?(c=1,f=Math.min(a+1,f+1)):(c=f+1-a,f+=1);for(var h=c;h<f;f--)this.lb(g[c]),d.removeChild(g[c])},eb:function(a){for(var b=this.d[0].getElementsByTagName("tr"),
e=this.g||this.f,f=1,d,g,h,l;f<b.length-1;f++)for(d=b[f],d.setAttribute("data-row",a+f-1),d=c("td>div",d),g=0;g<d.length;g++)h=d[g],l=this.c[g],l=l.name,h.innerHTML=this.I(e[a+f-1][l],l)},ka:function(){if(this.Y==u.Width.AUTO){for(var a=this.h.find(">thead>tr>th"),b=0,e=0;e<a.length;e++)b+=c(a[e])[0].offsetWidth;this.h.width(b);this.$el.width(b)}else if(this.Y==u.Width.SCROLL)if(a=this.$el.innerWidth(),b=this.h.width(),e=this.q[0].scrollWidth,this.d.off("scroll",this.xa),e>b||e>a)this.q.width(a),
this.d.width(a),this.d.on("scroll",this.xa);else{try{this.q[0].style.width=""}catch(f){}try{this.d[0].style.width=""}catch(d){}}return this},L:function(){return"rtl"==this.h.css("direction")},W:function(a){return a.o==n.AUTO?"auto":a.o==n.RELATIVE?100*a.width+"%":a.width},Qa:function(a){if(a.firstChild.scrollWidth>a.firstChild.clientWidth){this.ua();var b=c(a),e=c(a.firstChild),f=r("div"),d=c(f);f.className=this.Ra;var g=parseFloat(b.css("padding-left"))||0,h=parseFloat(b.css("padding-right"))||0,
l=parseFloat(b.css("padding-top"))||0,k=parseFloat(b.css("padding-bottom"))||0,m=a.firstChild.scrollWidth+a.clientWidth-a.firstChild.offsetWidth,t=a.firstChild.scrollHeight+a.clientHeight-a.firstChild.offsetHeight;"border-box"===b.css("boxSizing")?(m-=parseFloat(c(a).css("border-left-width"))||0,m-=parseFloat(c(a).css("border-right-width"))||0,t-=parseFloat(c(a).css("border-top-width"))||0,t-=parseFloat(c(a).css("border-bottom-width"))||0,d.css("box-sizing","border-box")):(m-=g+h,t-=l+k,d.css({"margin-top":parseFloat(c(a).css("border-top-width"))||
0}));if(!this.Da){var n=document.createElement("div");n.style.backgroundColor="transparent";this.Da=c(n).css("background-color");n.style.backgroundColor="rgba(0,0,0,0)";this.kb=c(n).css("background-color")}n=c(a).css("background-color");if(n==this.Da||n==this.kb)n="#fff";d.css({width:m+"px",height:t+"px","padding-left":g,"padding-right":h,"padding-top":l,"padding-bottom":k,overflow:"hidden",position:"absolute",zIndex:"-1",left:"0",top:"0","background-color":n,cursor:"default"});f.innerHTML=a.innerHTML;
document.body.appendChild(f);f.firstChild.style.width=f.clientWidth-a.clientWidth+parseFloat(a.firstChild.style.width)+"px";f.firstChild.style.direction=e.css("direction");f.firstChild.style.whiteSpace=e.css("white-space");f.__row=a.parentNode.getAttribute("data-row");f.__column=this.c[_.indexOf(a.parentNode.childNodes,a)].name;this.qa&&!1===this.qa(f.firstChild,f.__row,f.__column)||(e=b.offset(),this.L()?(g=d.outerWidth(),b=b.outerWidth(),e.left-=g-b):e.left+=parseFloat(c(a).css("border-left-width"))||
0,e.top+=parseFloat(c(a).css("border-top-width"))||parseFloat(c(a).css("border-bottom-width"))||0,d.css({left:e.left,top:e.top,"z-index":9999,zIndex:9999}),f.__cell=a,this.Q=d,a.__previewEl=f,this.fa(a),this.fa(f))}},Pa:function(){this.ua()},ua:function(){if(this.Q){var a=this.Q[0];this.Q.remove();this.ia(a.__cell);this.ia(a);a.__cell.__previewEl=null;a.__cell=null;this.ra&&this.ra(a.firstChild,a.__row,a.__column);this.Q=null}return this}}),n={AUTO:0,ABSOLUTE:1,RELATIVE:2};u.Width={NONE:"none",AUTO:"auto",
SCROLL:"SCROLL"};k.DGTable=u})(this,jQuery);
DGTable.La=function(){function k(){var c=[];_.extend(c,k.prototype);c.initialize.apply(c,arguments);return c}k.prototype=[];k.prototype.initialize=function(){};k.prototype.get=function(c){for(var g=0,h=this.length;g<h;g++)if(this[g].name==c)return this[g];return null};k.prototype.indexOf=function(c){for(var g=0,h=this.length;g<h;g++)if(this[g].name==c)return g;return-1};k.prototype.aa=function(c){for(var g=0,h=this.length;g<h;g++)if(this[g].e==c)return this[g];return null};k.prototype.oa=function(){var c=
[],g;for(g=0;g<this.length;g++)c.push(this[g]);c.sort(function(c,g){return c.e<g.e?-1:c.e>g.e?1:0});for(g=0;g<c.length;g++)c[g].e=g};k.prototype.D=function(){for(var c=[],g=0,h;g<this.length;g++)h=this[g],h.visible&&c.push(h);c.sort(function(c,g){return c.e<g.e?-1:c.e>g.e?1:0});return c};k.prototype.Ia=function(){for(var c=0,g=0,h;g<this.length;g++)h=this[g],h.e>c&&(c=h.e);return c};k.prototype.moveColumn=function(c,g){if(c&&g){var h=c.e,k=g.e,s;if(h<k)for(h+=1;h<=k;h++)s=this.aa(h),s.e--;else for(h-=
1;h>=k;h--)s=this.aa(h),s.e++;c.e=k}return this};return k}();
DGTable.Ma=function(){function k(){var c=[];_.extend(c,k.prototype);c.initialize.apply(c,arguments);return c}k.prototype=[];_.extend(k.prototype,Backbone.Events);k.prototype.initialize=function(c){c=c||{};this.Z=this.O=null;this.na=!1;this.sortColumn=null==c.sortColumn?[]:c.sortColumn};k.prototype.add=function(c,g){var h,k;if("splice"in c&&"length"in c)if(g)for(h=0,k=c.length;h<k;h++)this.splice(g++,0,c[h]);else for(h=0,k=c.length;h<k;h++)this.push(c[h]);else g?this.splice(g,0,c):this.push(c)};k.prototype.reset=
function(c){this.length=0;c&&this.add(c)};k.prototype.Ha=function(c,g,h){if((g=g.toString())&&null!=c){var t=new k({sortColumn:this.sortColumn});this.O=c;this.Z=g;this.na=h;c=0;for(g=this.length;c<g;c++)h=this[c],this.nb(h)&&t.push(h);return t}return this.Z=this.O=null};k.prototype.nb=function(c){if(c&&this.O){c=c[this.O];if(null==c)return!1;c=c.toString();var g=this.Z;this.na||(c=c.toUpperCase(),g=g.toUpperCase());return-1!==c.indexOf(g)}return!0};(function(){function c(c,g){var k=g?1:-1,r=g?-1:
1;return function(g,n){var a=g[c],b=n[c];return a<b?k:a>b?r:0}}var g=k.prototype.sort;k.prototype.sort=function(h){if(this.sortColumn.length){var k=[],s,r;for(s=0;s<this.sortColumn.length;s++)r={},this.trigger("requiresComparatorForColumn",r,this.sortColumn[s].column,this.sortColumn[s].descending),k.push(_.bind(r.mb||c(this.sortColumn[s].column,this.sortColumn[s].descending),this));if(1===k.length)g.call(this,k[0]);else{var u=k.length,n;g.call(this,function(a,b){for(s=0;s<u&&(n=k[s](a,b),0===n);s++);
return n})}h||this.trigger("sort")}return this}})();return k}();
//# sourceMappingURL=DGTable.min.js.map