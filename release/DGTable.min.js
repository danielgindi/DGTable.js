'use strict';(function(l,e){function h(a){_.contains(["relative","absolute","fixed"],a.css("position"))||a.css("position","relative")}var m=navigator.userAgent,g=-1!=m.indexOf("MSIE ")?parseFloat(m.substr(m.indexOf("MSIE ")+5)):null,u=g&&10>g,s=_.bind(document.createElement,document),r=Backbone.View.extend({className:"dgtable-wrapper",tagName:"div",VERSION:"0.3.1",initialize:function(a){function b(a){a=a||event;a=a.toElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==
this.__previewEl||jQuery.contains(this.__previewEl,a))||h.Ta.call(h,this)}function c(a){a=a||event;a=a.fromElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||h.Ua.call(h,this)}a=a||{};a.columns=a.columns||[];this.Ca=_.bind(this.ab,this);this.da=_.bind(this.Za,this);this.Ea=_.bind(this.bb,this);this.$el.on("dragend",this.da);this.t=!0;this.j=void 0===a.virtualTable?!0:!!a.virtualTable;this.m=Math.max(a.minColumnWidth||
35,0);this.S=a.resizeAreaWidth||8;this.L=void 0===a.resizableColumns?!0:!!a.resizableColumns;this.A=void 0===a.movableColumns?!0:!!a.movableColumns;this.q=void 0===a.sortableColumns?1:parseInt(a.sortableColumns,10)||1;this.Y=void 0===a.adjustColumnWidthForSortArrow?!0:!!a.adjustColumnWidthForSortArrow;this.ra=void 0===a.convertColumnWidthsToRelative?!1:!!a.convertColumnWidthsToRelative;this.Sa=void 0===a.cellClasses?"":a.cellClasses;this.ib=void 0===a.resizerClassName?"dgtable-resize":a.resizerClassName;
this.g=void 0===a.tableClassName?"dgtable":a.tableClassName;this.ma=void 0===a.allowCellPreview?!0:a.allowCellPreview;this.Ra=void 0===a.allowHeaderCellPreview?!0:a.allowHeaderCellPreview;this.p=void 0===a.cellPreviewClassName?"dgtable-cell-preview":a.cellPreviewClassName;this.Q=void 0===a.comparatorCallback?null:a.comparatorCallback;this.M=void 0===a.width?r.Width.NONE:a.width;this.eb=void 0===a.relativeWidthGrowsToFillWidth?!0:!!a.relativeWidthGrowsToFillWidth;this.fb=void 0===a.relativeWidthShrinksToFillWidth?
!1:!!a.relativeWidthShrinksToFillWidth;this.pa=a.cellFormatter||function(a){return a};this.Wa=a.headerCellFormatter||function(a){return a};var f,d,e,q,k=new r.Pa;for(q=f=0;f<a.columns.length;f++)d=a.columns[f],e=this.ua(d),void 0!==d.order?(d.order>q&&(q=d.order+1),e.order=d.order):e.order=q++,k.push(e);k.ja();this.a=k;this.b=k.O();if(void 0===a.sortColumn)a.sortColumn=null;else if("string"==typeof a.sortColumn)this.a.get(a.sortColumn)?a.sortColumn=[{column:a.sortColumn,descending:!1}]:a.sortColumn=
null;else if(a.sortColumn instanceof Array){q=[];f=0;d=a.sortColumn.length;for(e;f<d&&(e=a.sortColumn[f],e=void 0!==e.column?e:{column:e,descending:!1},(e=this.a.get(e.column))&&!_.contains(q,e.name)&&q.push(e.name),q.length!=this.q&&q.length!=this.b.length);f++);a.sortColumn=q}else"object"==typeof a.sortColumn?this.a.get(a.sortColumn.column)||(a.sortColumn=null):a.sortColumn=null;this.c=new r.Qa({sortColumn:a.sortColumn,columns:this.columns});this.listenTo(this.c,"sort",this.render).listenTo(this.c,
"requiresComparatorForColumn",_.bind(function(a,b,c){this.Q&&(a.kb=this.Q(b,c))},this));this.d=null;this.v=a.height;var h=this;"addEventListener"in window?(this.ba=function(a){a.__hoverIn||a.addEventListener("mouseover",a.__hoverIn=_.bind(c,a));return this},this.U=function(a){a.__hoverIn&&(a.removeEventListener("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ca=function(a){a.__hoverOut||a.addEventListener("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.fa=function(a){a.__hoverOut&&
(a.removeEventListener("mouseout",a.__hoverOut),a.__hoverOut=null);return this}):(this.ba=function(a){a.__hoverIn||a.attachEvent("mouseover",a.__hoverIn=_.bind(c,a));return this},this.U=function(a){a.__hoverIn&&(a.detachEvent("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ca=function(a){a.__hoverOut||a.attachEvent("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.fa=function(a){a.__hoverOut&&(a.detachEvent("mouseout",a.__hoverOut),a.__hoverOut=null);return this})},Fa:function(a){var b=
parseFloat(a),c=p.AUTO;0<b&&(a==b+"%"?(c=p.RELATIVE,b/=100):0<b&&1>b?c=p.RELATIVE:(b<this.m&&(b=this.m),c=p.ABSOLUTE));return{width:b,mode:c}},ua:function(a){var b=this.Fa(a.width);return{name:a.name,label:void 0===a.label?a.name:a.label,width:b.width,n:b.mode,resizable:void 0===a.resizable?!0:a.resizable,sortable:void 0===a.sortable?!0:a.sortable,F:void 0===a.F?!0:a.F,visible:void 0===a.visible?!0:a.visible,cellClasses:void 0===a.cellClasses?this.Sa:a.cellClasses}},close:function(){this.h&&(this.h.remove(),
this.h=null);if(this.l)for(var a=this.l[0].childNodes,b=0,c=a.length;b<c;b++)this.trigger("rowdestroy",a[b]);this.remove();this.Ia().Ja();this.i.unbind();this.l.unbind();this.$el.unbind();this.unbind();if(this.o){for(a=0;a<this.o.length;a++)b=this.o[a],b.Oa.removeEventListener("message",b.Na,!1);this.o.length=0}this.c.length=this.a.length=0;for(var f in this)this.hasOwnProperty(f)&&(this[f]=null)},Ja:function(){if(this.ka)for(var a=0,b=this.ka[0].childNodes,c=b.length,f;a<c;a++){f=b[a];var d=0;f=
f.childNodes;for(var e=f.length;d<e;d++)this.U(f[d])}if(this.l)for(a=0,b=this.l[0].childNodes,c=b.length;a<c;a++)for(f=b[a],d=0,f=f.childNodes,e=f.length;d<e;d++)this.U(f[d]);return this},pb:function(a){var b=0;a=a.childNodes;for(var c=a.length;b<c;b++)this.U(a[b]);return this},render:function(){if(!0===this.t){this.t=!1;this.M==r.Width.AUTO&&this.qa();var a=this.f?this.f.scrollTop:0,b=this.f?this.f.scrollLeft:0;this.tableWidthChanged(!0,!1).gb();if(!this.j){var c=(this.d||this.c).length,f=this.G(0,
c-1);this.l.html("").append(f);this.C(!0)}this.f.scrollTop=a;this.f.scrollLeft=b;this.R.scrollLeft=b;this.w(!0);for(f=0;f<this.c.sortColumn.length;f++)this.Ga(this.c.sortColumn[f].column,this.c.sortColumn[f].descending);this.Y&&this.c.sortColumn.length&&this.tableWidthChanged(!0);this.trigger("renderskeleton");this.j&&(this.i.on("scroll",_.bind(this.cb,this)),this.render())}else if(this.j){c=(this.d||this.c).length;b=this.f.scrollTop;a=Math.floor((b-this.D)/this.r)+1;b=Math.ceil((b-this.D+this.jb)/
this.r);0>a&&(a=0);b>=c&&(b=c-1);var d=-1,c=-1,e=this.e.childNodes;e.length&&(d=e[0].rowIndex,c=e[e.length-1].rowIndex);if(-1!==d&&d<a){for(var q=Math.min(c+1,a)-d,f=0;f<q;f++)this.trigger("rowdestroy",e[0]),this.e.removeChild(e[0]);d+=q;d>c&&(d=c=-1)}else if(-1!==c&&c>b){q=c-Math.max(d-1,b);for(f=0;f<q;f++)this.trigger("rowdestroy",e[e.length-1]),this.e.removeChild(e[e.length-1]);c<d&&(d=c=-1)}a<d&&(f=this.G(a,Math.min(b,d-1)),this.l.prepend(f));if(b>c||-1===c)f=this.G(-1===c?a:c+1,b),this.l.append(f)}this.trigger("render");
return this},clearAndRender:function(){this.t=!0;return this.render()},G:function(a,b){var c=this.g,f=c+"-row",c=c+"-cell",d=this.d||this.c,e=!!this.d,q=this.ma,k=this.b,h=this.pa,m=this.j,n=this.D,l=this.r,g,u,p=k.length;g=0;for(var r;g<p;g++)r=k[g],r.Va=r.s||r.k;for(var C=document.createDocumentFragment(),E="rtl"===this.$el.css("direction")?"right":"left",x=a,F=d.length,z,w,y,D;x<F&&x<=b;x++){z=d[x];u=e?z.__i:x;w=s("div");w.className=f;w.rowIndex=x;w.physicalRowIndex=u;for(g=0;g<p;g++)r=k[g],y=
s("div"),y.columnName=r.name,y.className=c,y.style.width=r.Va+"px",r.cellClasses&&(y.className+=" "+r.cellClasses),q&&this.ba(y),D=y.appendChild(s("div")),D.innerHTML=h(z[r.name],r.name,z),w.appendChild(y);m&&(g=0<x?n+(x-1)*l:0,w.style.position="absolute",w.style[E]=0,w.style.top=g+"px");C.appendChild(w);this.trigger("rowcreate",x,u,w,z)}return C},H:function(){if(this.e){var a=(this.d||this.c).length,b=this.r*a;a&&(b+=this.D-this.r,b+=this.ga-this.r);this.e.style.height=b+"px"}return this},na:function(){var a=
this.g,b=a+"-row",c=a+"-cell",f=this.b,d=f.length,t,q,k,b=e("<div>").addClass(b).css("float","left");for(q=0;q<d;q++)k=f[q],t=s("div"),t.className=c,t.style.width=k.k+"px",k.cellClasses&&(t.className+=" "+k.cellClasses),t.appendChild(s("div")),b.append(t);a=e("<div>").addClass(this.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px","float":"left",width:"1px",overflow:"hidden"}).append(e("<div>").addClass(a).append(e("<div>").addClass(a+"-body").css("width",99999).append(b)));
a.appendTo(document.body);c=b.outerWidth();c-=this.B||0;a.remove();return c},addColumn:function(a,b){if(a&&!this.a.get(a.name)){var c=null;void 0!==b&&(c=this.a.get(b)||this.a.W(b));var f=this.ua(a);f.order=c?c.order:this.a.Ma()+1;for(var c=this.a.Ma(),d=f.order,e;c>=d;c--)(e=this.a.W(c))&&e.order++;this.a.push(f);this.a.ja();this.t=!0;this.b=this.a.O();this.render();this.trigger("addColumn",f.name)}return this},removeColumn:function(a){var b=this.a.indexOf(a);-1<b&&(this.a.splice(b,1),this.a.ja(),
this.b=this.a.O(),this.clearAndRender(),this.trigger("removeColumn",a));return this},filter:function(a,b,c){if(this.a.get(a)){var f=!!this.d;this.d&&(this.d=null);this.d=this.c.La(a,b,c);if(f||this.d)this.t=!0,this.j&&this.H(),this.render(),this.trigger("filter",a,b,c)}return this},K:function(){this.d&&(this.d=null,this.d=this.c.La(this.c.N,this.c.V,this.c.ia));return this},setColumnLabel:function(a,b){var c=this.a.get(a);if(c&&(c.label=void 0===b?c.name:b,c.element))for(var f=0;f<c.element[0].firstChild.childNodes.length;f++){var d=
c.element[0].firstChild.childNodes[f];if(3===d.nodeType){d.textContent=c.label;break}}return this},moveColumn:function(a,b){var c,f;"string"===typeof a?c=this.a.get(a):"number"===typeof a&&(c=this.b[a]);"string"===typeof b?f=this.a.get(b):"number"===typeof b&&(f=this.b[b]);if(c&&f&&a!==b){var d=c.order,e=f.order;this.b=this.a.moveColumn(c,f).O();if(this.j)this.clearAndRender().C(!0);else{var q=this.u.find(">div."+this.g+"-header-cell");f=d<e?e+1:e;q[0].parentNode.insertBefore(q[d],q[f]);for(var q=
this.b[d],q=(q.s||q.k)+"px",k=this.b[e],k=(k.s||k.k)+"px",h=this.l[0].childNodes,m=0,n=h.length,g;m<n;m++)g=h[m],1===g.nodeType&&(g.insertBefore(g.childNodes[d],g.childNodes[f]),g.childNodes[e].firstChild.style.width=k,g.childNodes[d].firstChild.style.width=q)}this.trigger("moveColumn",c.name,d,e)}return this},sort:function(a,b,c){var f=this.a.get(a);if(f){var d=this.c.sortColumn;d.length&&d[d.length-1].column==a&&(b=void 0===b?!d[d.length-1].descending:b);if(c){for(a=0;a<d.length;a++)if(d[a].column==
f.name){a<d.length-1?d.length=0:d.splice(d.length-1,1);break}if(0<this.q&&d.length>=this.q||d.length>=this.b.length)d.length=0}else d.length=0;d.push({column:f.name,descending:!(void 0===b||!b)});this.c.sortColumn=d;this.qa();for(a=0;a<d.length;a++)this.Ga(d[a].column,d[a].descending);this.Y&&this.tableWidthChanged(!0);if(this.j)for(;this.e.firstChild;)this.trigger("rowdestroy",this.e.firstChild),this.e.removeChild(this.e.firstChild);else this.t=!0;this.c.sort(!!this.d);this.K();this.d&&this.render();
b=[];for(a=0;a<d.length;a++)b.push({column:d[a].column,descending:d[a].descending});this.trigger("sort",b)}return this},setColumnVisible:function(a,b){var c=this.a.get(a);c&&!!c.visible!=!!b&&(c.visible=!!b,this.b=this.a.O(),this.clearAndRender(),this.trigger(b?"showColumn":"hideColumn",a));return this},isColumnVisible:function(a){return(a=this.a.get(a))?a.visible:!1},setMinColumnWidth:function(a){a=Math.max(a,0);this.m!=a&&(this.m=a,this.tableWidthChanged(!0));return this},getMinColumnWidth:function(){return this.m},
setSortableColumns:function(a){if(this.q!=a&&(this.q=a,this.i)){a=this.u.find(">div."+this.g+"-header-cell");for(var b=0;b<a.length;b++)e(a[0])[0<this.q&&this.b[b].sortable?"addClass":"removeClass"]("sortable")}return this},getSortableColumns:function(){return this.q},setMovableColumns:function(a){a=!!a;this.A!=a&&(this.A=a);return this},getMovableColumns:function(){return this.A},setResizableColumns:function(a){a=!!a;this.L!=a&&(this.L=a);return this},getResizableColumns:function(){return this.L},
setComparatorCallback:function(a){this.Q!=a&&(this.Q=a);return this},setColumnWidth:function(a,b){var c=this.Fa(b),f=this.a.get(a);if(f){var d=this.T(f);f.width=c.width;f.n=c.mode;c=this.T(f);d!=c&&this.tableWidthChanged(!0);this.trigger("setColumnWidth",f.name,d,c)}return this},getColumnWidth:function(a){return(a=this.a.get(a))?this.T(a):null},getColumnConfig:function(a){return(a=this.a.get(a))?{order:a.order,width:this.T(a),visible:a.visible}:null},getColumnsConfig:function(){for(var a={},b=0;b<
this.a.length;b++)a[this.a[b].name]=this.getColumnConfig(this.a[b]);return a},getSortedColumns:function(){for(var a=[],b=0,c;b<this.c.sortColumn.length;b++)c=this.c.sortColumn[b],a.push({column:c.column,descending:c.descending});return a},getHtmlForCell:function(a,b){if(0>a||a>this.c.length-1||!this.a.get(b))return null;var c=this.c[a];return this.pa(c[b],b,c)},getDataForRow:function(a){return 0>a||a>this.c.length-1?null:this.c[a]},getDataForFilteredRow:function(a){return 0>a||a>(this.d||this.c).length-
1?null:(this.d||this.c)[a]},I:function(a){return(parseFloat(e.css(a,"padding-left"))||0)+(parseFloat(e.css(a,"padding-right"))||0)},Xa:function(a){return(parseFloat(e.css(a,"border-left"))||0)+(parseFloat(e.css(a,"border-right"))||0)},oa:function(){var a,b,c;this.i&&(b=this.f?this.f.scrollTop:0,c=this.f?this.f.scrollLeft:0,a=this.i[0].style.display,this.i[0].style.display="none");var f=this.$el.width();this.i&&(this.i[0].style.display=a,this.f.scrollTop=b,this.f.scrollLeft=c,this.R.scrollLeft=c);
var d;b=this.g;if(this.i)c=this.u;else{d=e("<div>").addClass(this.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px"});a=e("<div>").addClass(b+"-header").appendTo(d);c=e("<div>").addClass(b+"-header-row").appendTo(a);for(a=0;a<this.b.length;a++)c.append(e("<div><div></div></div>").addClass(b+"-header-cell"));d.appendTo(document.body)}f-=this.Xa(c[0]);b=c.find(">div."+b+"-header-cell");a=0;for(var t;a<b.length;a++)e(b[a].firstChild),c=e(b[a]),t="border-box"===c.css("boxSizing"),
f-=(parseFloat(c.css("border-right-width"))||0)+(parseFloat(c.css("border-left-width"))||0)+(t?0:this.I(c[0]));d&&d.remove();return f},tableWidthChanged:function(){var a=null;return function(b,c){var f=this.oa(),d=f,t=0;c=void 0===c||c;var h=0;c&&(h=parseFloat(this.e.style.minWidth)||0);if(d!=a||b){a=f;var k,f=0,m=[],g,n,l=0;for(g=0;g<this.a.length;g++)this.a[g].s=null;for(g=0;g<this.b.length;g++)if(n=this.b[g],n.n==p.ABSOLUTE)k=n.width,k+=n.ha||0,k<this.m&&(k=this.m),d-=k,f+=k,k!==n.k&&(n.k=k,m.push(g));
else if(n.n==p.AUTO){var u=n.label,r=this.g;k=void 0;u=e("<div>").addClass(this.$el).append(e("<div>").addClass(r+"-header").append(e("<div>").addClass(r+"-header-row").append(k=e("<div>").addClass(r+"-header-cell").append(e("<div>").text(u))))).css({position:"absolute",top:"-9999px",visibility:"hidden"});u.appendTo(document.body);k=k.width();u.remove();k+=20;k+=n.ha||0;k<this.m&&(k=this.m);d-=k;f+=k;k!==n.k&&(n.k=k,this.ra||m.push(g))}else n.n==p.RELATIVE&&(l+=n.width,t++);if(this.ra)for(g=0;g<this.b.length;g++)n=
this.b[g],n.n===p.AUTO&&(n.n=p.RELATIVE,d+=n.k,n.width=n.k/f,l+=n.width,t++);if(t&&(1>l&&this.eb||1<l&&this.fb))for(g=0;g<this.b.length;g++)n=this.b[g],n.n===p.RELATIVE&&(n.width/=l);f=d;for(g=0;g<this.b.length;g++)n=this.b[g],n.n===p.RELATIVE&&(k=Math.round(f*n.width),k<this.m&&(k=this.m),d-=k,t--,0===t&&1===d&&(k++,d--),-1===d&&(k--,d++),k!==n.k&&(n.k=k,m.push(g)));this.b[this.b.length-1].s=this.b[this.b.length-1].k-(this.B||0);if(c){d=this.na();h<d&&this.w(!1);for(g=0;g<m.length;g++)this.hb(m[g]);
h>d&&this.w(!1)}}return this}}(),tableHeightChanged:function(){var a=this.$el.innerHeight()-(parseFloat(this.i.css("border-top-width"))||0)-(parseFloat(this.i.css("border-bottom-width"))||0);a!=this.v&&(this.v=a,this.l&&(this.l[0].style.height=this.v-this.ka.outerHeight()+"px"),this.j&&this.clearAndRender());return this},addRows:function(a){if(a){this.c.add(a);if(this.j){for(;this.e.firstChild;)this.trigger("rowdestroy",this.e.firstChild),this.e.removeChild(this.e.firstChild);this.d&&this.K();this.H().C().w(!1);
this.render()}else if(this.d){var b=this.d.length;this.K();this.d&&this.d.length==b||this.clearAndRender()}else this.l&&(b=this.c.length-a.length,b=this.G(b,b+a.length-1),this.e.appendChild(b),this.C().w(!0));this.trigger("addrows",a.length,!1)}return this},removeRow:function(a,b){if(0>a||a>this.c.length-1)return this;this.c.splice(a,1);b=void 0===b?!0:!!b;if(this.d)this.K(),this.t=!0,b&&this.render();else if(b){var c=this.e.childNodes;if(this.j){for(var f=0;f<c.length;f++)c[f].rowIndex>=a&&(this.trigger("rowdestroy",
c[f]),this.e.removeChild(c[f]),f--);this.H().C().render().w(!1)}else{for(f=0;f<c.length;f++)if(c[f].rowIndex===a){this.trigger("rowdestroy",c[f]);this.e.removeChild(c[f]);break}this.render().C().w(!0)}}return this},refreshRow:function(a){if(0>a||a>this.c.length-1)return this;var b=-1;if(this.d&&-1===(b=_.indexOf(this.d,this.c[a])))return this;-1===b&&(b=a);var c=this.e.childNodes;if(this.j){for(var f=!1,d=0;d<c.length;d++)if(c[d].physicalRowIndex===a){f=!0;this.trigger("rowdestroy",c[d]);this.e.removeChild(c[d]);
break}f&&(a=this.G(b,b),this.e.insertBefore(a,c[d]||null))}else this.trigger("rowdestroy",c[b]),this.e.removeChild(c[b]),a=this.G(b,b),this.e.insertBefore(a,c[b]||null);return this},setRows:function(a){this.scrollTop=this.$el.find(".table").scrollTop();this.c.reset(a);this.K();this.t=!0;this.j&&this.H();this.render().trigger("addRows",a.length,!0);return this},getUrlForElementContent:function(a){if(a=document.getElementById(a)){a=a.textContent;if("function"===typeof Blob)a=new Blob([a]);else{var b=
l.BlobBuilder||l.WebKitBlobBuilder||l.ob||l.nb;if(!b)return null;b=new b;b.append(a);a=b.getBlob()}return(l.URL||l.webkitURL).createObjectURL(a)}return null},isWorkerSupported:function(){return l.Worker instanceof Function},createWebWorker:function(a,b){if(this.isWorkerSupported()){var c=this,f=new Worker(a),d=function(a){a.data.append?c.addRows(a.data.rows):c.setRows(a.data.rows)};f.addEventListener("message",d,!1);this.o||(this.o=[]);this.o.push({Oa:f,Na:d});(b||void 0===b)&&f.postMessage(null);
return f}return null},unbindWebWorker:function(a){if(this.o)for(var b=0;b<this.o.length;b++)this.o[b].Oa==a&&(a.removeEventListener("message",this.o[b].Na,!1),this.o.splice(b,1),b--);return this},abortCellPreview:function(){this.la=!0;return this},cb:function(){this.render()},bb:function(){this.R.scrollLeft=this.f.scrollLeft},aa:function(a){var b=this.J(),c=e(a.target).closest("div."+this.g+"-header-cell,div."+this.p),f=c[0];f.__cell&&(f=f.__cell,c=e(f));for(var d=c[0].previousSibling;d&&1!=d.nodeType;)d=
d.previousSibling;var g=!d;a=(a.originalEvent.pageX||a.originalEvent.clientX)-c.offset().left;if(b){if(!g&&c.outerWidth()-a<=this.S/2)return d.columnName;if(a<=this.S/2)return f.columnName}else{if(!g&&a<=this.S/2)return d.columnName;if(c.outerWidth()-a<=this.S/2)return f.columnName}return null},$a:function(a){this.Ya=a},Ba:function(a){if(this.L){var b=this.aa(a);a=e(a.target).closest("div."+this.g+"-header-cell,div."+this.p)[0];b&&this.a.get(b).resizable?a.style.cursor="e-resize":a.style.cursor=""}},
Aa:function(a){e(a.target).closest("div."+this.g+"-header-cell,div."+this.p)[0].style.cursor=""},va:function(a){if(!this.aa(a)&&(a=e(a.target).closest("div."+this.g+"-header-cell,div."+this.p)[0],this.q)){var b=this.a.get(a.columnName);b&&b.sortable&&this.sort(a.columnName,void 0,!0)}},Da:function(a){var b=this.aa(this.Ya||a),c;if(b){c=this.a.get(b);if(!this.L||!c||!c.resizable)return!1;b=this.J();this.h&&e(this.h).remove();this.h=e("<div></div>").addClass(this.ib).css({position:"absolute",display:"block",
"z-index":-1,visibility:"hidden",width:"2px",background:"#000",opacity:0.7}).appendTo(this.$el);c=c.element;var f=this.h.parent(),d=c.offset(),h=f.offset();8===g&&(d=c.offset());h.left+=parseFloat(f.css("border-left-width"))||0;h.top+=parseFloat(f.css("border-top-width"))||0;d.left-=h.left;d.top-=h.top;d.top-=parseFloat(c.css("border-top-width"))||0;f=this.h.outerWidth();b?d.left-=Math.ceil((parseFloat(c.css("border-left-width"))||0)/2):(d.left+=c.outerWidth(),d.left+=Math.ceil((parseFloat(c.css("border-right-width"))||
0)/2));d.left-=Math.ceil(f/2);this.h.css({"z-index":"10",visibility:"visible",left:d.left,top:d.top,height:this.$el.height()})[0].columnName=c[0].columnName;try{this.h[0].style.zIndex=""}catch(m){}e(document).on("mousemove",this.Ca);e(document).on("mouseup",this.da);a.preventDefault()}else this.A?(b=e(a.target).closest("div."+this.g+"-header-cell,div."+this.p),(c=this.a.get(b[0].columnName))&&c.F?(b[0].style.opacity=0.35,this.Z=161061273*Math.random(),a.originalEvent.dataTransfer.setData("text",JSON.stringify({Ka:this.Z,
column:c.name}))):a.preventDefault()):a.preventDefault()},ab:function(a){var b=this.a.get(this.h[0].columnName),c=this.J(),b=b.element,f=this.h.parent(),d=b.offset(),e=f.offset();e.left+=parseFloat(f.css("border-left-width"))||0;d.left-=e.left;f=this.h.outerWidth();a=a.pageX-e.left;d=d.left;c?(d+=b.outerWidth(),d-=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),d-=Math.ceil(f/2),d-=this.m,d-=this.I(b[0]),a>d&&(a=d)):(d+=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),d-=Math.ceil(f/
2),d+=this.m,d+=this.I(b[0]),a<d&&(a=d));this.h.css("left",a+"px")},Za:function(a){if(this.h){e(document).off("mousemove",this.Ca);e(document).off("mouseup",this.da);var b=this.a.get(this.h[0].columnName),c=this.J(),f=b.element,d=this.h.parent(),g=f.offset(),h=d.offset();h.left+=parseFloat(d.css("border-left-width"))||0;g.left-=h.left;d=this.h.outerWidth();a=a.pageX-h.left;g=h=g.left;g=0;c?(a+=this.I(f[0]),h+=f.outerWidth(),h-=Math.ceil((parseFloat(f.css("border-right-width"))||0)/2),h-=Math.ceil(d/
2),g=h-this.m,a>g&&(a=g),g=h-a):(a-=this.I(f[0]),h+=Math.ceil((parseFloat(f.css("border-right-width"))||0)/2),h-=Math.ceil(d/2),g=h+this.m,a<g&&(a=g),g=a-h);this.h.remove();this.h=null;c=g;if(b.n===p.RELATIVE){c=this.oa();for(f=0;f<this.b.length;f++)d=this.b[f],d.n!=p.RELATIVE&&(c-=d.k);c=g/c*100;c+="%"}this.setColumnWidth(b.name,c)}else a.target.style.opacity=null},wa:function(a){if(this.A){var b=a.originalEvent.dataTransfer.getData("text"),b=b?JSON.parse(b):null;a=e(a.target).closest("div."+this.g+
"-header-cell,div."+this.p);(!b||this.Z==b.Ka&&a.columnName!==b.column)&&(b=this.a.get(a[0].columnName))&&(b.F||b!=this.b[0])&&e(a).addClass("drag-over")}},ya:function(a){a.preventDefault()},xa:function(a){var b=e(a.target).closest("div."+this.g+"-header-cell,div."+this.p);e(b[0].firstChild).has(a.originalEvent.relatedTarget).length||b.removeClass("drag-over")},za:function(a){a.preventDefault();var b=JSON.parse(a.originalEvent.dataTransfer.getData("text"));a=e(a.target).closest("div."+this.g+"-header-cell,div."+
this.p);if(this.A&&b.Ka==this.Z){var b=b.column,c=a[0].columnName,f=this.a.get(b),d=this.a.get(c);f&&d&&f.F&&(d.F||d!=this.b[0])&&this.moveColumn(b,c)}e(a).removeClass("drag-over")},qa:function(){if(this.i){var a=this.u.find(">div."+this.g+"-header-cell.sorted"),b=a.find(">div>.sort-arrow");_.forEach(b,_.bind(function(a){if(a=this.a.get(a.parentNode.parentNode.columnName))a.ha=0},this));b.remove();a.removeClass("sorted").removeClass("desc")}return this},Ga:function(a,b){var c=this.a.get(a),f=s("span");
f.className="sort-arrow";c.element.addClass(b?"sorted desc":"sorted");c.element[0].firstChild.insertBefore(f,c.element[0].firstChild.firstChild);c.n!=p.RELATIVE&&this.Y&&(c.ha=f.scrollWidth+(parseFloat(e(f).css("margin-right"))||0)+(parseFloat(e(f).css("margin-left"))||0));return this},hb:function(a){var b=this.u.find("div."+this.g+"-header-cell"),c=this.a.get(b[a].columnName);if(c){b[a].style.width=(c.s||c.k)+"px";for(var b=(c.s||c.k)+"px",c=this.l[0].childNodes,f=0,d=c.length,e;f<d;f++)e=c[f],1===
e.nodeType&&(e.childNodes[a].style.width=b)}return this},Ia:function(){this.u&&this.u.find("div."+this.g+"-header-cell").off("mousemove").off("mouseleave").off("dragstart").off("selectstart").off("click").find(">div").off("dragenter").off("dragover").off("dragleave").off("drop");return this},gb:function(){this.Ia().Ja();var a=this.ma,b=this.Ra,c=this.g,f=c+"-header-cell",d=s("div"),g=e(d),m=s("div"),k=e(m);d.className=c+"-header";m.className=c+"-header-row";var l;u&&(l=function(a){a.preventDefault();
this.lb();return!1});for(var p=0,n,v,A,B;p<this.b.length;p++)if(n=this.b[p],n.visible&&(v=s("div"),B=e(v),v.draggable=!0,v.className=f,v.style.width=n.k+"px",this.q&&n.sortable&&(v.className+=" sortable"),v.columnName=n.name,A=s("div"),A.innerHTML=this.Wa(n.label,n.name),v.appendChild(A),a&&b&&this.ba(v),m.appendChild(v),this.b[p].element=B,B.on("mousedown",_.bind(this.$a,this)).on("mousemove",_.bind(this.Ba,this)).on("mouseleave",_.bind(this.Aa,this)).on("dragstart",_.bind(this.Da,this)).on("click",
_.bind(this.va,this)),e(A).on("dragenter",_.bind(this.wa,this)).on("dragover",_.bind(this.ya,this)).on("dragleave",_.bind(this.xa,this)).on("drop",_.bind(this.za,this)),u))B.on("selectstart",_.bind(l,v));this.X&&this.X.remove();this.X=g;this.R=d;this.u=k;this.sa=m;k.appendTo(this.X);g.prependTo(this.$el);this.el.style.overflow=this.M==r.Width.SCROLL?"hidden":"";if(this.i&&this.j&&(this.i.remove(),this.l))for(a=this.l[0].childNodes,p=0,b=a.length;p<b;p++)this.trigger("rowdestroy",a[p]);h(this.$el);
!this.v&&this.j&&(this.v=this.$el.innerHeight());this.j&&!this.r&&(d=function(){var a=s("div"),b=a.appendChild(s("div")),d=b.appendChild(s("div"));a.className=c+"-row";b.className=c+"-cell";d.innerHTML="0";a.style.visibility="hidden";a.style.position="absolute";return a},a=e("<div>").addClass(this.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px",width:"1px",overflow:"hidden"}).append(e("<div>").addClass(c).append(p=e("<div>").addClass(c+"-body").css("width",99999))),a.appendTo(document.body),
b=d(),f=d(),d=d(),p.append(b,f,d),this.D=e(b).outerHeight(),this.r=e(f).outerHeight(),this.ga=e(d).outerHeight(),Math.min(Math.min(this.D,this.r),this.ga),Math.max(Math.max(this.D,this.r),this.ga),a.remove());if(this.j||!this.i)p=document.createDocumentFragment(),a=s("div"),b=e(a),a.className=this.g,this.j&&(a.className+=" virtual"),k=this.v-k.outerHeight(),"border-box"!==b.css("box-sizing")&&(k-=parseFloat(b.css("border-top-width"))||0,k-=parseFloat(b.css("border-bottom-width"))||0,k-=parseFloat(b.css("padding-top"))||
0,k-=parseFloat(b.css("padding-bottom"))||0),this.jb=k,a.style.height=this.v?k+"px":"auto",a.style.display="block",a.style.overflowY="auto",a.style.overflowX=this.M==r.Width.SCROLL?"auto":"hidden",p.appendChild(a),k=s("div"),f=e(k),k.className=this.g+"-body",this.f=a,this.e=k,this.i=b,this.l=f,this.H(),h(f),h(b),a.appendChild(k),this.el.appendChild(p);return this},C:function(a){var b=this.f.offsetWidth-this.f.clientWidth;if(b!=this.B||a){this.B=b;for(a=0;a<this.a.length;a++)this.a[a].s=null;if(0<
this.B){b=this.b.length-1;this.b[b].s=this.b[b].k-this.B;var c=this.b[b].s+"px",e=this.e.childNodes;a=0;for(var d=e.length,g;a<d;a++)g=e[a],1===g.nodeType&&(g.childNodes[b].style.width=c);this.sa.childNodes[b].style.width=c}}return this},w:function(a){var b=this.na();this.e.style.minWidth=b+"px";this.sa.style.minWidth=b+(this.B||0)+"px";this.i.off("scroll",this.Ea);if(this.M==r.Width.AUTO)this.$el.width(this.i.width(this.l.outerWidth()).outerWidth());else if(this.M==r.Width.SCROLL){if(a){a=this.f?
this.f.scrollTop:0;var b=this.f?this.f.scrollLeft:0,c=this.el,e=c.style.display;c.style.display="none";c.offsetHeight;c.style.display=e;this.f.scrollTop=a;this.f.scrollLeft=b;this.R.scrollLeft=b}this.i.on("scroll",this.Ea)}return this},J:function(){return"rtl"===this.i.css("direction")},T:function(a){return a.n===p.AUTO?"auto":a.n===p.RELATIVE?100*a.width+"%":a.width},Ua:function(a){this.la=!1;var b=a.firstChild;if(1<b.scrollWidth-b.clientWidth||1<b.scrollHeight-b.clientHeight){this.ta();var c=e(a),
f=e(b),d=s("div"),g=e(d);d.innerHTML=a.innerHTML;d.className=this.p;if(c.hasClass(this.g+"-header-cell")&&(d.className+=" header",c.hasClass("sortable")&&(d.className+=" sortable"),d.draggable=!0,e(d).on("mousemove",_.bind(this.Ba,this)).on("mouseleave",_.bind(this.Aa,this)).on("dragstart",_.bind(this.Da,this)).on("click",_.bind(this.va,this)),e(d.firstChild).on("dragenter",_.bind(this.wa,this)).on("dragover",_.bind(this.ya,this)).on("dragleave",_.bind(this.xa,this)).on("drop",_.bind(this.za,this)),
u))e(d).on("selectstart",_.bind(function(a){a.preventDefault();this.lb();return!1},d));var h=parseFloat(c.css("padding-left"))||0,k=parseFloat(c.css("padding-right"))||0,m=parseFloat(c.css("padding-top"))||0,l=parseFloat(c.css("padding-bottom"))||0,b=b.scrollWidth+a.clientWidth-b.offsetWidth;"border-box"===c.css("boxSizing")?(b-=parseFloat(e(a).css("border-left-width"))||0,b-=parseFloat(e(a).css("border-right-width"))||0,g.css("box-sizing","border-box")):(b-=h+k,g.css({"margin-top":parseFloat(e(a).css("border-top-width"))||
0}));if(!this.ea){var n=document.createElement("div");n.style.backgroundColor="transparent";this.ea=e(n).css("background-color");n.style.backgroundColor="rgba(0,0,0,0)";this.Ha=e(n).css("background-color")}n=e(a).css("background-color");if(n===this.ea||n===this.Ha)n=e(a.parentNode).css("background-color");if(n===this.ea||n===this.Ha)n="#fff";g.css({"box-sizing":"content-box",width:b+"px","min-height":c.height()+"px","padding-left":h,"padding-right":k,"padding-top":m,"padding-bottom":l,overflow:"hidden",
position:"absolute",zIndex:"-1",left:"0",top:"0","background-color":n,cursor:"default"});document.body.appendChild(d);e(d.firstChild).css({direction:f.css("direction"),"white-space":f.css("white-space")}).data("row-el",c.closest("tr"));d.rowIndex=a.parentNode.rowIndex;f=d.physicalRowIndex=a.parentNode.physicalRowIndex;d.columnName=this.b[_.indexOf(a.parentNode.childNodes,a)].name;this.trigger("cellpreview",d.firstChild,null==f?null:f,d.columnName,null==f?null:this.c[f]);this.la||(f=c.offset(),this.J()?
(h=g.outerWidth(),c=c.outerWidth(),f.left-=h-c):f.left+=parseFloat(e(a).css("border-left-width"))||0,f.top+=parseFloat(e(a).css("border-top-width"))||parseFloat(e(a).css("border-bottom-width"))||0,c=e(window).width()-g.outerWidth(),f.left=0>f.left?0:f.left>c?c:f.left,g.css({left:f.left,top:f.top,"z-index":9999}),d.__cell=a,this.P=g,a.__previewEl=d,this.ca(a),this.ca(d))}},Ta:function(){this.ta()},ta:function(){if(this.P){var a=this.P[0];this.P.remove();this.fa(a.__cell);this.fa(a);a.__cell.__previewEl=
null;a.__cell=null;this.trigger("cellpreviewdestroy",a.firstChild,a.physicalRowIndex,a.columnName);this.P=null}return this}}),p={AUTO:0,ABSOLUTE:1,RELATIVE:2};r.Width={NONE:"none",AUTO:"auto",SCROLL:"SCROLL"};l.DGTable=r})(this,jQuery);
DGTable.Pa=function(){function l(){var e=[];_.extend(e,l.prototype);e.initialize.apply(e,arguments);return e}l.prototype=[];l.prototype.initialize=function(){};l.prototype.get=function(e){for(var h=0,m=this.length;h<m;h++)if(this[h].name==e)return this[h];return null};l.prototype.indexOf=function(e){for(var h=0,m=this.length;h<m;h++)if(this[h].name==e)return h;return-1};l.prototype.W=function(e){for(var h=0,m=this.length;h<m;h++)if(this[h].order==e)return this[h];return null};l.prototype.ja=function(){var e=
[],h;for(h=0;h<this.length;h++)e.push(this[h]);e.sort(function(e,g){return e.order<g.order?-1:e.order>g.order?1:0});for(h=0;h<e.length;h++)e[h].order=h};l.prototype.O=function(){for(var e=[],h=0,m;h<this.length;h++)m=this[h],m.visible&&e.push(m);e.sort(function(e,h){return e.order<h.order?-1:e.order>h.order?1:0});return e};l.prototype.Ma=function(){for(var e=0,h=0,m;h<this.length;h++)m=this[h],m.order>e&&(e=m.order);return e};l.prototype.moveColumn=function(e,h){if(e&&h){var m=e.order,g=h.order,l;
if(m<g)for(m+=1;m<=g;m++)l=this.W(m),l.order--;else for(m-=1;m>=g;m--)l=this.W(m),l.order++;e.order=g}return this};return l}();
DGTable.Qa=function(){function l(){var e=[];_.extend(e,l.prototype);e.initialize.apply(e,arguments);return e}l.prototype=[];_.extend(l.prototype,Backbone.Events);l.prototype.initialize=function(e){e=e||{};this.V=this.N=null;this.ia=!1;this.sortColumn=null==e.sortColumn?[]:e.sortColumn};l.prototype.add=function(e,h){var m,g;if("splice"in e&&"length"in e)if(h)for(m=0,g=e.length;m<g;m++)this.splice(h++,0,e[m]);else for(m=0,g=e.length;m<g;m++)this.push(e[m]);else h?this.splice(h,0,e):this.push(e)};l.prototype.reset=
function(e){this.length=0;e&&this.add(e)};l.prototype.La=function(e,h,m){if((h=h.toString())&&null!=e){var g=new l({sortColumn:this.sortColumn});this.N=e;this.V=h;this.ia=m;e=0;for(h=this.length;e<h;e++)m=this[e],this.mb(m)&&(m.__i=e,g.push(m));return g}return this.V=this.N=null};l.prototype.mb=function(e){if(e&&this.N){e=e[this.N];if(null==e)return!1;e=e.toString();var h=this.V;this.ia||(e=e.toUpperCase(),h=h.toUpperCase());return-1!==e.indexOf(h)}return!0};(function(){function e(e,g){var h=g?1:
-1,l=g?-1:1;return function(g,p){var a=g[e],b=p[e];return a<b?h:a>b?l:0}}var h=l.prototype.sort;l.prototype.sort=function(m){if(this.sortColumn.length){var g=[],l,s;for(l=0;l<this.sortColumn.length;l++)s={},this.trigger("requiresComparatorForColumn",s,this.sortColumn[l].column,this.sortColumn[l].descending),g.push(_.bind(s.kb||e(this.sortColumn[l].column,this.sortColumn[l].descending),this));if(1===g.length)h.call(this,g[0]);else{var r=g.length,p;h.call(this,function(a,b){for(l=0;l<r&&(p=g[l](a,b),
0===p);l++);return p})}m||this.trigger("sort")}return this}})();return l}();
//# sourceMappingURL=DGTable.min.js.map