'use strict';(function(l,c){var e=navigator.userAgent,g=-1!=e.indexOf("MSIE ")?parseFloat(e.substr(e.indexOf("MSIE ")+5)):null,u=g&&10>g,p=g&&10>g,t=_.bind(document.createElement,document),w=Backbone.View.extend({className:"dgtable-wrapper",tagName:"div",VERSION:"0.2.8",initialize:function(a){function b(a){a=a||event;a=a.toElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||g.Ya.call(g,this)}function d(a){a=a||event;
a=a.fromElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||g.Za.call(g,this)}a=a||{};a.columns=a.columns||[];this.Da=_.bind(this.cb,this);this.ja=_.bind(this.bb,this);this.Fa=_.bind(this.eb,this);this.$el.on("dragend",this.ja);this.m=!0;this.S=!1;this.h=void 0===a.virtualTable?!0:!!a.virtualTable;this.r=a.rowsBufferSize||10;this.l=Math.max(a.minColumnWidth||35,0);this.T=a.resizeAreaWidth||8;this.M=void 0===a.resizableColumns?
!0:!!a.resizableColumns;this.C=void 0===a.movableColumns?!0:!!a.movableColumns;this.s=void 0===a.sortableColumns?1:parseInt(a.sortableColumns,10)||1;this.da=void 0===a.adjustColumnWidthForSortArrow?!0:!!a.adjustColumnWidthForSortArrow;this.fa=void 0===a.convertColumnWidthsToRelative?!1:!!a.convertColumnWidthsToRelative;this.Xa=void 0===a.cellClasses?"":a.cellClasses;this.kb=void 0===a.resizerClassName?"dgtable-resize":a.resizerClassName;this.ka=void 0===a.tableClassName?"dgtable":a.tableClassName;
this.ea=void 0===a.allowCellPreview?!0:a.allowCellPreview;this.Wa=void 0===a.allowHeaderCellPreview?!0:a.allowHeaderCellPreview;this.q=void 0===a.cellPreviewClassName?"dgtable-cell-preview":a.cellPreviewClassName;this.R=void 0===a.comparatorCallback?null:a.comparatorCallback;this.Z=void 0===a.width?w.Width.NONE:a.width;this.gb=void 0===a.relativeWidthGrowsToFillWidth?!0:!!a.relativeWidthGrowsToFillWidth;this.hb=void 0===a.relativeWidthShrinksToFillWidth?!1:!!a.relativeWidthShrinksToFillWidth;this.H=
a.cellFormatter||function(a){return a};this.$a=a.headerCellFormatter||function(a){return a};var h,f,c,r,e=new w.Ta;for(r=h=0;h<a.columns.length;h++)f=a.columns[h],c=this.va(f),void 0!==f.order?(f.order>r&&(r=f.order+1),c.order=f.order):c.order=r++,e.push(c);e.qa();this.b=e;this.d=e.P();if(void 0===a.sortColumn)a.sortColumn=null;else if("string"==typeof a.sortColumn)this.b.get(a.sortColumn)?a.sortColumn=[{column:a.sortColumn,descending:!1}]:a.sortColumn=null;else if(a.sortColumn instanceof Array){r=
[];h=0;f=a.sortColumn.length;for(c;h<f&&(c=a.sortColumn[h],c=void 0!==c.column?c:{column:c,descending:!1},(c=this.b.get(c.column))&&!_.contains(r,c.name)&&r.push(c.name),r.length!=this.s&&r.length!=this.d.length);h++);a.sortColumn=r}else"object"==typeof a.sortColumn?this.b.get(a.sortColumn.column)||(a.sortColumn=null):a.sortColumn=null;this.e=new w.Ua({sortColumn:a.sortColumn,columns:this.columns});this.listenTo(this.e,"sort",this.render).listenTo(this.e,"requiresComparatorForColumn",_.bind(function(a,
b,d){this.R&&(a.mb=this.R(b,d))},this));this.f=null;this.A=a.height;this.B=0;var g=this;"addEventListener"in window?(this.I=function(a){a.__hoverIn||a.addEventListener("mouseover",a.__hoverIn=_.bind(d,a));return this},this.W=function(a){a.__hoverIn&&(a.removeEventListener("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ia=function(a){a.__hoverOut||a.addEventListener("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.ma=function(a){a.__hoverOut&&(a.removeEventListener("mouseout",
a.__hoverOut),a.__hoverOut=null);return this}):(this.I=function(a){a.__hoverIn||a.attachEvent("mouseover",a.__hoverIn=_.bind(d,a));return this},this.W=function(a){a.__hoverIn&&(a.detachEvent("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ia=function(a){a.__hoverOut||a.attachEvent("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.ma=function(a){a.__hoverOut&&(a.detachEvent("mouseout",a.__hoverOut),a.__hoverOut=null);return this})},Ha:function(a){var b=parseFloat(a),d=s.AUTO;
0<b&&(a==b+"%"?(d=s.RELATIVE,b/=100):0<b&&1>b?d=s.RELATIVE:(b<this.l&&(b=this.l),d=s.ABSOLUTE));return{width:b,mode:d}},va:function(a){var b=this.Ha(a.width);return{name:a.name,label:void 0===a.label?a.name:a.label,width:b.width,n:b.mode,resizable:void 0===a.resizable?!0:a.resizable,sortable:void 0===a.sortable?!0:a.sortable,F:void 0===a.F?!0:a.F,visible:void 0===a.visible?!0:a.visible,cellClasses:void 0===a.cellClasses?this.Xa:a.cellClasses}},close:function(){this.i&&(this.i.remove(),this.i=null);
if(this.c)for(var a=this.c[0].childNodes,b=0,d=a.length;b<d;b++)this.trigger("rowDestroy",a[b]);this.remove();this.Ma().Na();this.g.unbind();this.c.unbind();this.$el.unbind();this.unbind();if(this.o){for(a=0;a<this.o.length;a++)b=this.o[a],b.Sa.removeEventListener("message",b.Ra,!1);this.o.length=0}this.e.length=this.b.length=0;for(var h in this)this.hasOwnProperty(h)&&(this[h]=null)},Na:function(){if(this.p)for(var a=0,b=this.p[0].childNodes,d=b.length,h;a<d;a++){h=b[a];var f=0;h=h.childNodes;for(var c=
h.length;f<c;f++)this.W(h[f])}if(this.c)for(a=0,b=this.c[0].childNodes,d=b.length;a<d;a++)for(h=b[a],f=0,h=h.childNodes,c=h.length;f<c;f++)this.W(h[f]);return this},lb:function(a){var b=0;a=a.childNodes;for(var d=a.length;b<d;b++)this.W(a[b]);return this},render:function(){if(!0===this.m){this.m=!1;this.c&&(this.B=this.c[0].scrollTop);this.Z==w.Width.AUTO&&this.ta();this.tableWidthChanged(!0,!1).ib();var a=this.c[0].scrollHeight-this.c.height();this.B>a&&(this.B=a);this.c[0].scrollTop=this.B;this.h&&
(this.c.on("scroll",_.bind(this.Ga,this)),this.Ga(null,!0));this.Y(!0);for(a=0;a<this.e.sortColumn.length;a++)this.Ka(this.e.sortColumn[a].column,this.e.sortColumn[a].descending);this.da&&this.e.sortColumn.length&&this.tableWidthChanged(!0);this.S=!1;this.trigger("renderSkeleton")}else this.h&&this.Ja(this.B,this.c[0].scrollTop);this.trigger("render");return this},addColumn:function(a,b){if(a&&!this.b.get(a.name)){var d=null;void 0!==b&&(d=this.b.get(b)||this.b.ba(b));var h=this.va(a);h.order=d?d.order:
this.b.Qa()+1;for(var d=this.b.Qa(),f=h.order,c;d>=f;d--)(c=this.b.ba(d))&&c.order++;this.b.push(h);this.b.qa();this.m=!0;this.d=this.b.P();this.render();this.trigger("addColumn",h.name)}return this},removeColumn:function(a){var b=this.b.indexOf(a);-1<b&&(this.b.splice(b,1),this.b.qa(),this.m=!0,this.d=this.b.P(),this.render(),this.trigger("removeColumn",a));return this},filter:function(a,b,d){if(this.b.get(a)){var h=!!this.f;this.f&&(this.f=null);this.f=this.e.Pa(a,b,d);if(h||this.f)this.m=!0,this.render(),
this.trigger("filter",a,b,d)}return this},L:function(){this.f&&(this.f=null,this.f=this.e.Pa(this.e.O,this.e.aa,this.e.pa));return this},setColumnLabel:function(a,b){var d=this.b.get(a);if(d&&(d.label=void 0===b?d.name:b,d.element))for(var h=0;h<d.element[0].firstChild.childNodes.length;h++){var f=d.element[0].firstChild.childNodes[h];if(3===f.nodeType){f.textContent=d.label;break}}return this},moveColumn:function(a,b){var d,h;"string"===typeof a?d=this.b.get(a):"number"===typeof a&&(d=this.d[a]);
"string"===typeof b?h=this.b.get(b):"number"===typeof b&&(h=this.d[b]);if(d&&h&&a!==b){var f=d.order,c=h.order;this.d=this.b.moveColumn(d,h).P();if(this.h)this.m=!0,this.render();else{var r=this.p.find(">tr>th");h=f<c?c+1:c;r[0].parentNode.insertBefore(r[f],r[h]);for(var r=this.d[f],r=(r.u||r.j)+"px",e=this.d[c],e=(e.u||e.j)+"px",g=this.c[0].childNodes,k=0,m=g.length,n;k<m;k++)n=g[k],1===n.nodeType&&(n.insertBefore(n.childNodes[f],n.childNodes[h]),n.childNodes[c].firstChild.style.width=e,n.childNodes[f].firstChild.style.width=
r)}this.trigger("moveColumn",d.name,f,c)}return this},sort:function(a,b,d){var h=this.b.get(a);if(h){var f=this.e.sortColumn;f.length&&f[f.length-1].column==a&&(b=void 0===b?!f[f.length-1].descending:b);if(d){for(a=0;a<f.length;a++)if(f[a].column==h.name){a<f.length-1?f.length=0:f.splice(f.length-1,1);break}if(0<this.s&&f.length>=this.s||f.length>=this.d.length)f.length=0}else f.length=0;f.push({column:h.name,descending:!(void 0===b||!b)});this.e.sortColumn=f;this.ta();for(a=0;a<f.length;a++)this.Ka(f[a].column,
f[a].descending);this.da&&this.tableWidthChanged(!0);this.h||(this.m=!0);this.e.sort(!!this.f);this.L();this.f&&this.render();b=[];for(a=0;a<f.length;a++)b.push({column:f[a].column,descending:f[a].descending});this.trigger("sort",b)}return this},setColumnVisible:function(a,b){var d=this.b.get(a);d&&!!d.visible!=!!b&&(d.visible=!!b,this.m=!0,this.d=this.b.P(),this.render(),this.trigger(b?"showColumn":"hideColumn",a));return this},isColumnVisible:function(a){return(a=this.b.get(a))?a.visible:!1},setMinColumnWidth:function(a){a=
Math.max(a,0);this.l!=a&&(this.l=a,this.tableWidthChanged(!0));return this},getMinColumnWidth:function(){return this.l},setSortableColumns:function(a){if(this.s!=a&&(this.s=a,this.g)){a=this.g.find("thead>tr>th");for(var b=0;b<a.length;b++)c(a[0])[0<this.s&&this.d[b].sortable?"addClass":"removeClass"]("sortable")}return this},getSortableColumns:function(){return this.s},setMovableColumns:function(a){a=!!a;this.C!=a&&(this.C=a);return this},getMovableColumns:function(){return this.C},setResizableColumns:function(a){a=
!!a;this.M!=a&&(this.M=a);return this},getResizableColumns:function(){return this.M},setComparatorCallback:function(a){this.R!=a&&(this.R=a);return this},setColumnWidth:function(a,b){var d=this.Ha(b),h=this.b.get(a);if(h){var f=this.V(h);h.width=d.width;h.n=d.mode;d=this.V(h);f!=d&&this.tableWidthChanged(!0);this.trigger("setColumnWidth",h.name,f,d)}return this},getColumnWidth:function(a){return(a=this.b.get(a))?this.V(a):null},getColumnConfig:function(a){return(a=this.b.get(a))?{order:a.order,width:this.V(a),
visible:a.visible}:null},getColumnsConfig:function(){for(var a={},b=0;b<this.b.length;b++)a[this.b[b].name]=this.getColumnConfig(this.b[b]);return a},getSortedColumns:function(){for(var a=[],b=0,d;b<this.e.sortColumn.length;b++)d=this.e.sortColumn[b],a.push({column:d.column,descending:d.descending});return a},getHtmlForCell:function(a,b){return 0>a||a>this.e.length-1||!this.b.get(b)?null:this.H(this.e[a][b],b)},getDataForRow:function(a){return 0>a||a>this.e.length-1?null:this.e[a]},getDataForFilteredRow:function(a){return 0>
a||a>(this.f||this.e).length-1?null:(this.f||this.e)[a]},J:function(a){return(parseFloat(c.css(a,"padding-left"))||0)+(parseFloat(c.css(a,"padding-right"))||0)},ab:function(a){return(parseFloat(c.css(a,"border-left"))||0)+(parseFloat(c.css(a,"border-right"))||0)},sa:function(){function a(a){var b=e(a,"width");return"auto"===b?(parseFloat(c(a).css("width"))||0)+1:parseFloat(b)||0}var b;this.g&&(b=this.g[0].style.display,this.g[0].style.display="none");var d=this.$el.width();this.g&&(this.g[0].style.display=
b);var h,f,y;if(this.g)f=this.g,y=this.p;else{h=c("<div></div>").addClass(this.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px"});f=c("<table></table>").css({position:"absolute",top:"-9999px",visibility:"hidden"}).addClass(this.ka);y=c("<thead></thead>");var r=c("<tr></tr>");for(b=0;b<this.d.length;b++)r.append(c("<th><div></div></th>"));f.append(y.append(r)).appendTo(h.appendTo(document.body))}var r="rtl"==f.css("direction"),e=window.getComputedStyle?function(a,b){var d=window.getComputedStyle(a,
null);return d?d.getPropertyValue(b):null}:function(a,b){var d=a.currentStyle;return d?d[b]:null},d=d-this.ab(f[0]);f=y.find(">tr>th");b=0;for(var g,k,m;b<f.length;b++)k=c(f[b].firstChild),g=c(f[b]),y=r?Math.max(parseFloat(g.css("border-right-width"))||0,0<b?parseFloat(c(f[b-1]).css("border-left-width"))||0:0):Math.max(parseFloat(g.css("border-left-width"))||0,0<b?parseFloat(c(f[b-1]).css("border-right-width"))||0:0),m="border-box"===g.css("boxSizing"),d-=y+(k.outerWidth()-k.width())+(a(g[0])+(m?
0:this.J(g[0]))-k.outerWidth());d=r?d-(parseFloat(c(f[f.length-1]).css("border-left-width"))||0):d-(parseFloat(c(f[f.length-1]).css("border-right-width"))||0);h&&h.remove();return d},tableWidthChanged:function(){function a(a){a=c("<table><thead><tr><th>"+a+"</th></tr></thead></table>").css({position:"absolute",top:"-9999px",visibility:"hidden"}).addClass(this.ka);var b=a.find(">thead>tr>th");b.css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden"});a.appendTo(document.body);
b=b.width();a.remove();return b}var b=null;return function(d,h){var f=this.sa(),c=f,r=0;if(c!=b||d){b=f;var e,f=0,g=[],k,m,n=0;for(k=0;k<this.b.length;k++)this.b[k].u=null;for(k=0;k<this.d.length;k++)m=this.d[k],m.n==s.ABSOLUTE?(e=m.width,e+=m.oa||0,e<this.l&&(e=this.l),c-=e,f+=e,e!==m.j&&(m.j=e,this.fa||g.push(k))):m.n==s.AUTO?(e=_.bind(a,this)(m.label)+20,e+=m.oa||0,e<this.l&&(e=this.l),c-=e,f+=e,e!==m.j&&(m.j=e,this.fa||g.push(k))):m.n==s.RELATIVE&&(n+=m.width,r++);if(this.fa)for(k=0;k<this.d.length;k++)m=
this.d[k],m.n!=s.RELATIVE&&(m.n=s.RELATIVE,c+=m.j,m.width=m.j/f,n+=m.width,r++);if(r&&(1>n&&this.gb||1<n&&this.hb))for(k=0;k<this.d.length;k++)m=this.d[k],m.n==s.RELATIVE&&(m.width/=n);f=c;for(k=0;k<this.d.length;k++)m=this.d[k],m.n==s.RELATIVE&&(e=Math.round(f*m.width),e<this.l&&(e=this.l),c-=e,r--,0===r&&1===c&&(e++,c--),-1===c&&(e--,c++),e!==m.j&&(m.j=e,g.push(k)));this.d[this.d.length-1].u=this.d[this.d.length-1].j-(this.U||0);if(h||void 0===h)for(k=0;k<g.length;k++)this.jb(g[k])}return this}}(),
tableHeightChanged:function(){var a=this.$el.innerHeight()-(parseFloat(this.g.css("border-top-width"))||0)-(parseFloat(this.g.css("border-bottom-width"))||0);a!=this.A&&(this.A=a,this.c&&(this.c[0].style.height=this.A-this.p.outerHeight()+"px"),this.h&&(this.m=!0,this.render()));return this},addRows:function(a){if(a){this.scrollTop=this.$el.find(".table").scrollTop();var b=this.e.length;this.S=!0;this.e.add(a);if(this.h)this.L(),0===b&&(this.f||this.e).length&&(this.m=!0),this.render();else if(this.f)b=
this.f.length,this.L(),this.f&&this.f.length==b||(this.m=!0,this.render());else if(this.c){var d,c,f,e,g=this.ea,l=this.d,u=this.H;e=document.createDocumentFragment();for(var k=this.c[0].childNodes.length,m=0,n,q,p,s=this.d.length,w=a.length;m<w;m++){n=a[m];d=t("tr");d._rowIndex=m;for(q=0;q<s;q++)p=l[q],c=t("div"),c.style.width=(p.u||p.j)+"px",c.innerHTML=u(n[p.name],p.name),f=t("td"),p.cellClasses&&(f.className=p.cellClasses),g&&this.I(f),f.appendChild(c),d.appendChild(f);this.trigger("rowCreate",
k+m,b+m,d,n);e.appendChild(d)}this.c[0].appendChild(e);this.X()}this.trigger("addRows",a.length,!1)}return this},removeRow:function(a,b){if(0>a||a>this.e.length-1)return null;this.e.splice(a,1);b=void 0===b?!0:!!b;this.f&&(this.f=this.L(),this.m=!0,b&&this.render());b&&(this.h?this.render():(this.c&&(this.c[0].childNodes.removeChild(this.c[0].childNodes[a]),this.X(),this.Y(!0)),this.trigger("render")));return this},setRows:function(a){this.scrollTop=this.$el.find(".table").scrollTop();this.e.reset(a);
this.L();this.m=!0;this.render().trigger("addRows",a.length,!0);return this},getUrlForElementContent:function(a){if(a=document.getElementById(a)){a=a.textContent;if("function"===typeof Blob)a=new Blob([a]);else{var b=l.BlobBuilder||l.WebKitBlobBuilder||l.qb||l.pb;if(!b)return null;b=new b;b.append(a);a=b.getBlob()}return(l.URL||l.webkitURL).createObjectURL(a)}return null},isWorkerSupported:function(){return l.Worker instanceof Function},createWebWorker:function(a,b){if(this.isWorkerSupported()){var d=
this,c=new Worker(a),f=function(a){a.data.append?d.addRows(a.data.rows):d.setRows(a.data.rows)};c.addEventListener("message",f,!1);this.o||(this.o=[]);this.o.push({Sa:c,Ra:f});(b||void 0===b)&&c.postMessage(null);return c}return null},unbindWebWorker:function(a){if(this.o)for(var b=0;b<this.o.length;b++)this.o[b].Sa==a&&(a.removeEventListener("message",this.o[b].Ra,!1),this.o.splice(b,1),b--);return this},abortCellPreview:function(){this.ra=!0;return this},Ga:function(a,b){if(!0===b||this.B!==this.c[0].scrollTop){var d=
parseInt(this.c[0].scrollTop/this.D,10),c=d-this.r;0>c&&(c=0);this.a.v=this.a.first;this.a.w=this.a.last;this.a.first=c;this.a.last=d+this.t+this.r;d=this.f||this.e;this.a.last>d.length&&(this.a.last=d.length,this.a.first=Math.max(0,this.a.last-this.t-2*this.r));this.Ja(this.B,this.c[0].scrollTop)}},eb:function(){this.p[0].scrollLeft=this.c[0].scrollLeft},ha:function(a){var b=this.K(),d=c(a.target).closest("th,div."+this.q),h=d[0];h.__cell&&(h=h.__cell,d=c(h));for(var f=d[0].previousSibling;f&&1!=
f.nodeType;)f=f.previousSibling;var e=!f;a=(a.originalEvent.pageX||a.originalEvent.clientX)-d.offset().left;if(b){if(!e&&d.outerWidth()-a<=this.T/2)return f.k;if(a<=this.T/2)return h.k}else{if(!e&&a<=this.T/2)return f.k;if(d.outerWidth()-a<=this.T/2)return h.k}return null},Ca:function(a){if(this.M){var b=this.ha(a);a=c(a.target).closest("th,div."+this.q)[0];b&&this.b.get(b).resizable?a.style.cursor="e-resize":a.style.cursor=""}},Ba:function(a){c(a.target).closest("th,div."+this.q)[0].style.cursor=
""},wa:function(a){if(!this.ha(a)&&(a=c(a.target).closest("th,div."+this.q)[0],this.s)){var b=this.b.get(a.k);b&&b.sortable&&this.sort(a.k,void 0,!0)}},Ea:function(a){var b=this.ha(a),d;if(b){d=this.b.get(b);if(!this.M||!d||!d.resizable)return!1;b=this.K();this.i&&c(this.i).remove();this.i=c("<div></div>").addClass(this.kb).css({position:"absolute",display:"block","z-index":-1,visibility:"hidden",width:"2px",background:"#000",opacity:0.7}).appendTo(this.$el);d=d.element;var h=this.i.parent(),f=d.offset(),
e=h.offset();8==g&&(f=d.offset());e.left+=parseFloat(h.css("border-left-width"))||0;e.top+=parseFloat(h.css("border-top-width"))||0;f.left-=e.left;f.top-=e.top;f.top-=parseFloat(d.css("border-top-width"))||0;h=this.i.outerWidth();b?f.left-=Math.ceil((parseFloat(d.css("border-left-width"))||0)/2):(f.left+=d.outerWidth(),f.left+=Math.ceil((parseFloat(d.css("border-right-width"))||0)/2));f.left-=Math.ceil(h/2);b=this.g.height()-(this.g.offset().top-d.offset().top);this.i.css({"z-index":"10",visibility:"visible",
left:f.left,top:f.top,height:b})[0].k=d[0].k;try{this.i[0].style.zIndex=""}catch(r){}c(document).on("mousemove",this.Da);c(document).on("mouseup",this.ja);a.preventDefault()}else this.C?(b=c(a.target).closest("th,div."+this.q),(d=this.b.get(b[0].k))&&d.F?(b[0].style.opacity=0.35,this.ga=161061273*Math.random(),a.originalEvent.dataTransfer.setData("text",JSON.stringify({Oa:this.ga,column:d.name}))):a.preventDefault()):a.preventDefault()},cb:function(a){var b=this.b.get(this.i[0].k),d=this.K(),b=b.element,
c=this.i.parent(),f=b.offset(),e=c.offset();e.left+=parseFloat(c.css("border-left-width"))||0;f.left-=e.left;c=this.i.outerWidth();a=a.pageX-e.left;f=f.left;d?(f+=b.outerWidth(),f-=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),f-=Math.ceil(c/2),f-=this.l,f-=this.J(b[0]),a>f&&(a=f)):(f+=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),f-=Math.ceil(c/2),f+=this.l,f+=this.J(b[0]),a<f&&(a=f));this.i.css("left",a+"px")},bb:function(a){if(this.i){c(document).off("mousemove",this.Da);
c(document).off("mouseup",this.ja);var b=this.b.get(this.i[0].k),d=this.K(),h=b.element,f=this.i.parent(),e=h.offset(),g=f.offset();g.left+=parseFloat(f.css("border-left-width"))||0;e.left-=g.left;f=this.i.outerWidth();a=a.pageX-g.left;e=g=e.left;e=0;d?(a+=this.J(h[0]),g+=h.outerWidth(),g-=Math.ceil((parseFloat(h.css("border-right-width"))||0)/2),g-=Math.ceil(f/2),e=g-this.l,a>e&&(a=e),e=g-a):(a-=this.J(h[0]),g+=Math.ceil((parseFloat(h.css("border-right-width"))||0)/2),g-=Math.ceil(f/2),e=g+this.l,
a<e&&(a=e),e=a-g);this.i.remove();this.i=null;d=e;if(b.n==s.RELATIVE){d=this.sa();for(h=0;h<this.d.length;h++)f=this.d[h],f.n!=s.RELATIVE&&(d-=f.j);d=e/d*100;d+="%"}this.setColumnWidth(b.name,d)}else a.target.style.opacity=null},xa:function(a){if(this.C){var b=a.originalEvent.dataTransfer.getData("text"),b=b?JSON.parse(b):null;a=c(a.target).closest("th,div."+this.q);(!b||this.ga==b.Oa&&a.k!==b.column)&&(b=this.b.get(a[0].k))&&(b.F||b!=this.d[0])&&c(a).addClass("drag-over")}},za:function(a){a.preventDefault()},
ya:function(a){var b=c(a.target).closest("th,div."+this.q);c(b[0].firstChild).has(a.originalEvent.relatedTarget).length||b.removeClass("drag-over")},Aa:function(a){a.preventDefault();var b=JSON.parse(a.originalEvent.dataTransfer.getData("text"));a=c(a.target).closest("th,div."+this.q);if(this.C&&b.Oa==this.ga){var b=b.column,d=a[0].k,h=this.b.get(b),f=this.b.get(d);h&&f&&h.F&&(f.F||f!=this.d[0])&&this.moveColumn(b,d)}c(a).removeClass("drag-over")},ta:function(){if(this.g){var a=this.g.find(">thead>tr>th.sorted"),
b=a.find(">div>.sort-arrow");_.forEach(b,_.bind(function(a){if(a=this.b.get(a.parentNode.parentNode.k))a.oa=0},this));b.remove();a.removeClass("sorted").removeClass("desc")}return this},Ka:function(a,b){var d=this.b.get(a),h=t("span");h.className="sort-arrow";d.element.addClass(b?"sorted desc":"sorted");d.element[0].firstChild.insertBefore(h,d.element[0].firstChild.firstChild);d.n!=s.RELATIVE&&this.da&&(d.oa=h.scrollWidth+(parseFloat(c(h).css("margin-right"))||0)+(parseFloat(c(h).css("margin-left"))||
0));return this},jb:function(a){var b=this.g.find(">thead>tr>th"),d=this.b.get(b[a].k);if(d){b[a].firstChild.style.width=d.j+"px";for(var b=(d.u||d.j)+"px",d=this.c[0].childNodes,c=this.h?1:0,f=d.length-(this.h?1:0),e;c<f;c++)e=d[c],1===e.nodeType&&(e.childNodes[a].firstChild.style.width=b);this.Y(!0)}return this},Ma:function(){this.g&&this.g.find(">thead>tr>th").off("mousemove").off("mouseleave").off("dragstart").off("selectstart").off("click").find(">div").off("dragenter").off("dragover").off("dragleave").off("drop");
return this},ib:function(){var a=0;this.N&&(a=parseFloat(this.N.style.height));this.Ma().Na();var b,d,h,f,e,g,l,v,k,m,n=this.ea,q=this.Wa,s=t("tr"),x;p&&(x=function(a){a.preventDefault();this.nb();return!1});for(b=0;b<this.d.length;b++)if(e=this.d[b],e.visible&&(v=t("div"),v.style.width=e.j+"px",v.innerHTML=this.$a(e.label,e.name),d=t("th"),d.draggable=!0,this.s&&e.sortable&&(d.className="sortable"),d.k=e.name,n&&q&&this.I(d),d.appendChild(v),s.appendChild(d),this.d[b].element=c(d),c(d).on("mousemove",
_.bind(this.Ca,this)).on("mouseleave",_.bind(this.Ba,this)).on("dragstart",_.bind(this.Ea,this)).on("click",_.bind(this.wa,this)),c(v).on("dragenter",_.bind(this.xa,this)).on("dragover",_.bind(this.za,this)).on("dragleave",_.bind(this.ya,this)).on("drop",_.bind(this.Aa,this)),p))c(d).on("selectstart",_.bind(x,d));if(this.g&&this.h&&(this.c.off("scroll"),this.g.remove(),this.c))for(q=this.c[0].childNodes,b=0,d=q.length;b<d;b++)this.trigger("rowDestroy",q[b]);"static"==this.$el.css("position")&&this.$el.css("position",
"relative");this.h||!this.g?(e=document.createDocumentFragment(),b=t("table"),b.className=this.ka,e.appendChild(b),d=t("thead"),d.style.display="block",u&&c(d).css({"float":"rtl"==this.$el.css("direction")?"right":"left",clear:"both"}),b.appendChild(d),this.A||(this.A=this.$el.innerHeight()-(parseFloat(c(b).css("border-top-width"))||0)-(parseFloat(c(b).css("border-bottom-width"))||0)),q=t("tbody"),q.style.height=this.A-c(d).outerHeight()+"px",q.style.display="block",q.style.overflowY="auto",q.style.overflowX=
"hidden",u&&c(q).css({"float":"rtl"==this.$el.css("direction")?"right":"left",clear:"both"}),this.Z==w.Width.SCROLL&&(d.style.overflowX="hidden",q.style.overflowX="auto"),b.appendChild(q),this.el.appendChild(e),this.g=c(b),this.c=c(q),this.p=c(d)):(b=this.g[0],q=this.c[0],d=this.p[0]);this.h&&!this.D&&(v=function(){var a=t("tr");a.appendChild(t("td")).appendChild(t("div")).innerHTML="0";a.style.visibility="hidden";a.style.position="absolute";return a},b=q.appendChild(v()),e=q.appendChild(v()),v=q.appendChild(v()),
this.D=c(e).outerHeight(),q.removeChild(b),q.removeChild(e),q.removeChild(v),this.t=parseInt((this.A-c(d).outerHeight())/this.D,10));x=this.f||this.e;var C=!!this.f;this.h&&(this.a&&this.a.last-this.a.first>=this.t?(this.a.v=this.a.v!=this.a.first?this.a.v:this.a.first,this.a.w=this.a.w!=this.a.last?this.a.w:this.a.last,this.a.last>x.length&&(this.a.last=x.length,this.a.first=Math.max(0,this.a.last-this.t-2*this.r))):(b=this.t+this.r,b>x.length&&(b=x.length),this.a={first:0,last:b,v:0,w:b}));var z=
document.createDocumentFragment();this.h&&(k=this.N=document.createElement("tr"),k.style.height=a+"px",z.appendChild(k));var A;this.h?(b=this.a.first,A=this.a.last):(b=0,A=x.length);var B=this.d,D=this.H;g=B.length;for(l=x.length;b<l&&b<A;b++){h=x[b];k=document.createElement("tr");k._rowIndex=b;for(f=0;f<g;f++)e=B[f],v=document.createElement("div"),v.style.width=e.j+"px",v.innerHTML=D(h[e.name],e.name),m=document.createElement("td"),e.cellClasses&&(m.className=e.cellClasses),n&&this.I(m),m.appendChild(v),
k.appendChild(m);z.appendChild(k);this.trigger("rowCreate",b,C?h.__i:b,k,h)}this.h&&(k=this.na=document.createElement("tr"),k.style.height=this.D*Math.max(0,x.length-this.t-this.r)-a+"px",z.appendChild(k));try{d.innerHTML=""}catch(E){d.textContent=""}d.appendChild(s);this.h&&(q.style.height=this.A-c(d).outerHeight()+"px");try{q.innerHTML=""}catch(F){q.textContent=""}q.appendChild(z);this.X(!0);this.h&&this.G();return this},X:function(a){var b=this.c[0].offsetWidth-this.c[0].clientWidth;if(b!=this.U||
a){this.U=b;for(a=0;a<this.b.length;a++)this.b[a].u=null;if(0<this.U){b=this.d.length-1;this.d[b].u=this.d[b].j-this.U;var d=this.d[b].u+"px",c=this.c[0].childNodes;a=this.h?1:0;for(var f=c.length-(this.h?1:0),e;a<f;a++)e=c[a],1===e.nodeType&&(e.childNodes[b].firstChild.style.width=d)}}return this},Ja:function(a,b){var d,c,f,e=this.a.last-this.a.first-(this.a.w-this.a.v),g=this.t+this.r;if(b<a)d=this.a.first,c=this.a.v,this.a.last<=this.a.v&&(d=this.a.first,c=this.a.last),this.a.v=this.a.first,this.a.w=
this.a.last,f=this.Ia(c-d-e,!1),d=this.ca(d,c,!0),this.G();else if(b>a)d=this.a.w,c=this.a.last,this.a.first>=this.a.w&&(d=this.a.first,c=this.a.last),this.a.v=this.a.first,this.a.w=this.a.last,f=this.Ia(c-d-e,!0),d=this.ca(d,c,!1),this.G();else if(this.S)this.S=!1,c=this.f||this.e,this.a.last<c.length&&this.a.last<g&&(d=this.a.last,c=c.length,c>g&&(c=g),d=this.ca(d,c,!1),this.a.last=c),this.G();else{this.G();this.fb(this.a.first);return}d-f&&(this.X(),this.Y(!1));this.B=this.c[0].scrollTop},G:function(){var a=
((this.f||this.e).length-(this.c[0].childNodes.length-2))*this.D;if(0>a)this.N.style.height=0,this.na.style.height=0;else{var b=this.a.first*this.D;this.N.style.height=b+"px";this.na.style.height=a-b+"px"}},ca:function(a,b,d){var c=0;if(d)for(d=this.N.nextSibling;d&&1!=d.nodeType;)d=d.nextSibling;else d=this.na;for(;a<b;a++)this.Va(a,d),c++;return c},Va:function(a,b){var d=document.createElement("tr");d._rowIndex=a;for(var c=(this.f||this.e)[a],f=!!this.f,e=this.ea,g=this.d,l=this.H,p=0,k,m,n,q=g.length;p<
q;p++)k=g[p],m=document.createElement("div"),m.style.width=(k.u||k.j)+"px",m.innerHTML=l(c[k.name],k.name),n=document.createElement("td"),k.cellClasses&&(n.className=k.cellClasses),e&&this.I(n),n.appendChild(m),d.appendChild(n);this.c[0].insertBefore(d,b);this.trigger("rowCreate",a,f?c.__i:a,d,c)},Ia:function(a,b){var d,c,f=0;a>this.t+2*this.r&&(a=this.t+2*this.r);var e=this.c[0],g=e.childNodes;c=this.c[0].childNodes.length-2;b?(d=1,c=Math.min(a+1,c+1)):(d=c+1-a,c+=1);for(var p=d;p<c;c--)this.lb(g[d]),
this.trigger("rowDestroy",g[d]),e.removeChild(g[d]),f++;return f},fb:function(a){for(var b=this.c[0].getElementsByTagName("tr"),d=this.f||this.e,e=!!this.f,f,g=this.d,p=this.H,l=1,u,k,m,n,q,s=b.length-1;l<s;l++){u=b[l];this.trigger("rowDestroy",u);u._rowIndex=f=a+l-1;f=d[f];k=c("td>div",u);for(m=0;m<k.length;m++)n=k[m],q=g[m],q=q.name,n.innerHTML=p(f[q],q);this.trigger("rowCreate",l,e?f.__i:l,u,f)}},Y:function(a){if(this.Z==w.Width.AUTO){a=this.g.find(">thead>tr>th");for(var b=0,d=0;d<a.length;d++)b+=
c(a[d])[0].offsetWidth;this.g.width(b);this.$el.width(b)}else if(this.Z==w.Width.SCROLL)if(a&&(a=this.el.style.display,this.el.style.display="none",this.el.offsetHeight,this.el.style.display=a),a=this.$el.innerWidth(),b=this.g.width(),d=this.p[0].scrollWidth,this.c.off("scroll",this.Fa),d>b||d>a)this.p.width(a),this.c.width(a),this.c.on("scroll",this.Fa);else{try{this.p[0].style.width=""}catch(e){}try{this.c[0].style.width=""}catch(f){}}return this},K:function(){return"rtl"==this.g.css("direction")},
V:function(a){return a.n==s.AUTO?"auto":a.n==s.RELATIVE?100*a.width+"%":a.width},Za:function(a){this.ra=!1;if(a.firstChild.scrollWidth>a.firstChild.clientWidth){this.ua();var b=c(a),d=c(a.firstChild),e=t("div"),f=c(e);e.innerHTML=a.innerHTML;e.className=this.q;if("TH"==a.tagName&&(e.className+=" header",b.hasClass("sortable")&&(e.className+=" sortable"),e.draggable=!0,e.k=a.k,c(e).on("mousemove",_.bind(this.Ca,this)).on("mouseleave",_.bind(this.Ba,this)).on("dragstart",_.bind(this.Ea,this)).on("click",
_.bind(this.wa,this)),c(e.firstChild).on("dragenter",_.bind(this.xa,this)).on("dragover",_.bind(this.za,this)).on("dragleave",_.bind(this.ya,this)).on("drop",_.bind(this.Aa,this)),p))c(e).on("selectstart",_.bind(function(a){a.preventDefault();this.nb();return!1},e));var g=parseFloat(b.css("padding-left"))||0,l=parseFloat(b.css("padding-right"))||0,u=parseFloat(b.css("padding-top"))||0,s=parseFloat(b.css("padding-bottom"))||0,k=a.firstChild.scrollWidth+a.clientWidth-a.firstChild.offsetWidth,m=a.firstChild.scrollHeight+
a.clientHeight-a.firstChild.offsetHeight;"border-box"===b.css("boxSizing")?(k-=parseFloat(c(a).css("border-left-width"))||0,k-=parseFloat(c(a).css("border-right-width"))||0,m-=parseFloat(c(a).css("border-top-width"))||0,m-=parseFloat(c(a).css("border-bottom-width"))||0,f.css("box-sizing","border-box")):(k-=g+l,m-=u+s,f.css({"margin-top":parseFloat(c(a).css("border-top-width"))||0}));if(!this.la){var n=document.createElement("div");n.style.backgroundColor="transparent";this.la=c(n).css("background-color");
n.style.backgroundColor="rgba(0,0,0,0)";this.La=c(n).css("background-color")}n=c(a).css("background-color");if(n==this.la||n==this.La)n=c(a.parentNode).css("background-color");if(n==this.la||n==this.La)n="#fff";f.css({"box-sizing":"content-box",width:k+"px",height:m+"px","padding-left":g,"padding-right":l,"padding-top":u,"padding-bottom":s,overflow:"hidden",position:"absolute",zIndex:"-1",left:"0",top:"0","background-color":n,cursor:"default"});document.body.appendChild(e);c(e.firstChild).css({width:e.clientWidth-
a.clientWidth+parseFloat(a.firstChild.style.width)+"px",direction:d.css("direction"),"white-space":d.css("white-space"),height:m,display:"table-cell","vertical-align":c(a).css("vertical-align")});d=e.__row=a.parentNode._rowIndex;e.__column=this.d[_.indexOf(a.parentNode.childNodes,a)].name;this.trigger("cellPreview",e.firstChild,null==d?null:d,e.__column,null==d?null:(this.f||this.e)[d]);this.ra||(d=b.offset(),this.K()?(g=f.outerWidth(),b=b.outerWidth(),d.left-=g-b):d.left+=parseFloat(c(a).css("border-left-width"))||
0,d.top+=parseFloat(c(a).css("border-top-width"))||parseFloat(c(a).css("border-bottom-width"))||0,b=c(window).width()-f.outerWidth(),d.left=0>d.left?0:d.left>b?b:d.left,f.css({left:d.left,top:d.top,"z-index":9999}),e.__cell=a,this.Q=f,a.__previewEl=e,this.ia(a),this.ia(e))}},Ya:function(){this.ua()},ua:function(){if(this.Q){var a=this.Q[0];this.Q.remove().off("mousemove").off("mouseleave").off("dragstart").off("selectstart").off("click").find(">div").off("dragenter").off("dragover").off("dragleave").off("drop");
this.ma(a.__cell);this.ma(a);a.__cell.__previewEl=null;a.__cell=null;this.trigger("cellPreviewDestroy",a.firstChild,a.__row,a.__column);this.Q=null}return this}}),s={AUTO:0,ABSOLUTE:1,RELATIVE:2};w.Width={NONE:"none",AUTO:"auto",SCROLL:"SCROLL"};l.DGTable=w})(this,jQuery);
DGTable.Ta=function(){function l(){var c=[];_.extend(c,l.prototype);c.initialize.apply(c,arguments);return c}l.prototype=[];l.prototype.initialize=function(){};l.prototype.get=function(c){for(var e=0,g=this.length;e<g;e++)if(this[e].name==c)return this[e];return null};l.prototype.indexOf=function(c){for(var e=0,g=this.length;e<g;e++)if(this[e].name==c)return e;return-1};l.prototype.ba=function(c){for(var e=0,g=this.length;e<g;e++)if(this[e].order==c)return this[e];return null};l.prototype.qa=function(){var c=
[],e;for(e=0;e<this.length;e++)c.push(this[e]);c.sort(function(c,e){return c.order<e.order?-1:c.order>e.order?1:0});for(e=0;e<c.length;e++)c[e].order=e};l.prototype.P=function(){for(var c=[],e=0,g;e<this.length;e++)g=this[e],g.visible&&c.push(g);c.sort(function(c,e){return c.order<e.order?-1:c.order>e.order?1:0});return c};l.prototype.Qa=function(){for(var c=0,e=0,g;e<this.length;e++)g=this[e],g.order>c&&(c=g.order);return c};l.prototype.moveColumn=function(c,e){if(c&&e){var g=c.order,l=e.order,p;
if(g<l)for(g+=1;g<=l;g++)p=this.ba(g),p.order--;else for(g-=1;g>=l;g--)p=this.ba(g),p.order++;c.order=l}return this};return l}();
DGTable.Ua=function(){function l(){var c=[];_.extend(c,l.prototype);c.initialize.apply(c,arguments);return c}l.prototype=[];_.extend(l.prototype,Backbone.Events);l.prototype.initialize=function(c){c=c||{};this.aa=this.O=null;this.pa=!1;this.sortColumn=null==c.sortColumn?[]:c.sortColumn};l.prototype.add=function(c,e){var g,l;if("splice"in c&&"length"in c)if(e)for(g=0,l=c.length;g<l;g++)this.splice(e++,0,c[g]);else for(g=0,l=c.length;g<l;g++)this.push(c[g]);else e?this.splice(e,0,c):this.push(c)};l.prototype.reset=
function(c){this.length=0;c&&this.add(c)};l.prototype.Pa=function(c,e,g){if((e=e.toString())&&null!=c){var u=new l({sortColumn:this.sortColumn});this.O=c;this.aa=e;this.pa=g;e=c=0;g=this.length;for(var p;e<g;e++)p=this[e],this.ob(p)&&(p.__i=c++,u.push(p));return u}return this.aa=this.O=null};l.prototype.ob=function(c){if(c&&this.O){c=c[this.O];if(null==c)return!1;c=c.toString();var e=this.aa;this.pa||(c=c.toUpperCase(),e=e.toUpperCase());return-1!==c.indexOf(e)}return!0};(function(){function c(c,
e){var l=e?1:-1,t=e?-1:1;return function(e,s){var a=e[c],b=s[c];return a<b?l:a>b?t:0}}var e=l.prototype.sort;l.prototype.sort=function(g){if(this.sortColumn.length){var l=[],p,t;for(p=0;p<this.sortColumn.length;p++)t={},this.trigger("requiresComparatorForColumn",t,this.sortColumn[p].column,this.sortColumn[p].descending),l.push(_.bind(t.mb||c(this.sortColumn[p].column,this.sortColumn[p].descending),this));if(1===l.length)e.call(this,l[0]);else{var w=l.length,s;e.call(this,function(a,b){for(p=0;p<w&&
(s=l[p](a,b),0===s);p++);return s})}g||this.trigger("sort")}return this}})();return l}();
//# sourceMappingURL=DGTable.min.js.map