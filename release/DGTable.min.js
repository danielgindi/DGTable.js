'use strict';(function(h,d){var f=navigator.userAgent,k=-1!=f.indexOf("MSIE ")?parseFloat(f.substr(f.indexOf("MSIE ")+5)):null,t=k&&10>k,q=k&&10>k,u=_.bind(document.createElement,document),w=Backbone.View.extend({className:"dgtable-wrapper",tagName:"div",VERSION:"0.2.6",initialize:function(a){function b(a){a=a||event;a=a.toElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||f.Na.call(f,this)}function c(a){a=a||event;
a=a.fromElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||f.Oa.call(f,this)}a=a||{};a.columns=a.columns||[];this.ua=_.bind(this.$a,this);this.fa=_.bind(this.Xa,this);this.va=_.bind(this.bb,this);this.$el.on("dragend",this.fa);this.m=!0;this.Q=!1;this.i=void 0===a.virtualTable?!0:!!a.virtualTable;this.q=a.rowsBufferSize||10;this.l=Math.max(a.minColumnWidth||35,0);this.S=a.resizeAreaWidth||8;this.J=void 0===a.resizableColumns?
!0:!!a.resizableColumns;this.A=void 0===a.movableColumns?!0:!!a.movableColumns;this.r=void 0===a.sortableColumns?1:parseInt(a.sortableColumns,10)||1;this.aa=void 0===a.adjustColumnWidthForSortArrow?!0:!!a.adjustColumnWidthForSortArrow;this.Ma=void 0===a.cellClasses?"":a.cellClasses;this.ib=void 0===a.resizerClassName?"dgtable-resize":a.resizerClassName;this.ga=void 0===a.tableClassName?"dgtable":a.tableClassName;this.ba=void 0===a.allowCellPreview?!0:a.allowCellPreview;this.Pa=void 0===a.cellPreviewClassName?
"dgtable-cell-preview":a.cellPreviewClassName;this.P=void 0===a.comparatorCallback?null:a.comparatorCallback;this.W=void 0===a.width?w.Width.NONE:a.width;this.eb=void 0===a.relativeWidthGrowsToFillWidth?!0:!!a.relativeWidthGrowsToFillWidth;this.fb=void 0===a.relativeWidthShrinksToFillWidth?!1:!!a.relativeWidthShrinksToFillWidth;this.F=a.cellFormatter||function(a){return a};this.Qa=a.headerCellFormatter||function(a){return a};var g,e,p,d,m=new w.Ja;for(d=g=0;g<a.columns.length;g++)e=a.columns[g],p=
this.ta(e),void 0!==e.order?(e.order>d&&(d=e.order+1),p.order=e.order):p.order=d++,m.push(p);m.na();this.b=m;this.c=m.M();if(void 0===a.sortColumn)a.sortColumn=null;else if("string"==typeof a.sortColumn)this.b.get(a.sortColumn)?a.sortColumn=[{column:a.sortColumn,descending:!1}]:a.sortColumn=null;else if(a.sortColumn instanceof Array){d=[];g=0;e=a.sortColumn.length;for(p;g<e&&(p=a.sortColumn[g],p=void 0!==p.column?p:{column:p,descending:!1},(p=this.b.get(p.column))&&!_.contains(d,p.name)&&d.push(p.name),
d.length!=this.r&&d.length!=this.c.length);g++);a.sortColumn=d}else"object"==typeof a.sortColumn?this.b.get(a.sortColumn.column)||(a.sortColumn=null):a.sortColumn=null;this.e=new w.Ka({sortColumn:a.sortColumn,columns:this.columns});this.listenTo(this.e,"sort",this.render).listenTo(this.e,"requiresComparatorForColumn",_.bind(function(a,b,c){this.P&&(a.lb=this.P(b,c))},this));this.f=null;this.ra=a.height;this.w=0;var f=this;"addEventListener"in window?(this.G=function(a){a.__hoverIn||a.addEventListener("mouseover",
a.__hoverIn=_.bind(c,a));return this},this.V=function(a){a.__hoverIn&&(a.removeEventListener("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ea=function(a){a.__hoverOut||a.addEventListener("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.ha=function(a){a.__hoverOut&&(a.removeEventListener("mouseout",a.__hoverOut),a.__hoverOut=null);return this}):(this.G=function(a){a.__hoverIn||a.attachEvent("mouseover",a.__hoverIn=_.bind(c,a));return this},this.V=function(a){a.__hoverIn&&
(a.detachEvent("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ea=function(a){a.__hoverOut||a.attachEvent("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.ha=function(a){a.__hoverOut&&(a.detachEvent("mouseout",a.__hoverOut),a.__hoverOut=null);return this})},xa:function(a){var b=parseFloat(a),c=s.AUTO;0<b&&(a==b+"%"?(c=s.RELATIVE,b/=100):0<b&&1>b?c=s.RELATIVE:(b<this.l&&(b=this.l),c=s.ABSOLUTE));return{width:b,mode:c}},ta:function(a){var b=this.xa(a.width);return{name:a.name,
label:void 0===a.label?a.name:a.label,width:b.width,n:b.mode,resizable:void 0===a.resizable?!0:a.resizable,sortable:void 0===a.sortable?!0:a.sortable,C:void 0===a.C?!0:a.C,visible:void 0===a.visible?!0:a.visible,cellClasses:void 0===a.cellClasses?this.Ma:a.cellClasses}},close:function(){this.h&&(this.h.remove(),this.h=null);if(this.d)for(var a=this.d[0].childNodes,b=0,c=a.length;b<c;b++)this.trigger("rowDestroy",a[b]);this.remove();this.Ca().Da();this.g.unbind();this.d.unbind();this.$el.unbind();
this.unbind();if(this.o){for(a=0;a<this.o.length;a++)b=this.o[a],b.Ia.removeEventListener("message",b.Ha,!1);this.o.length=0}this.e.length=this.b.length=0;for(var g in this)this.hasOwnProperty(g)&&(this[g]=null)},Da:function(){if(this.p)for(var a=0,b=this.p[0].childNodes,c=b.length,g;a<c;a++){g=b[a];var e=0;g=g.childNodes;for(var d=g.length;e<d;e++)this.V(g[e])}if(this.d)for(a=0,b=this.d[0].childNodes,c=b.length;a<c;a++)for(g=b[a],e=0,g=g.childNodes,d=g.length;e<d;e++)this.V(g[e]);return this},kb:function(a){var b=
0;a=a.childNodes;for(var c=a.length;b<c;b++)this.V(a[b]);return this},render:function(){if(!0===this.m){this.m=!1;this.d&&(this.w=this.d[0].scrollTop);this.W==w.Width.AUTO&&this.qa();this.N(!0,!1).gb();var a=this.d[0].scrollHeight-this.d.height();this.w>a&&(this.w=a);this.d[0].scrollTop=this.w;this.i&&(this.d.on("scroll",_.bind(this.wa,this)),this.wa(null,!0));this.ja();for(a=0;a<this.e.sortColumn.length;a++)this.Aa(this.e.sortColumn[a].column,this.e.sortColumn[a].descending);this.aa&&this.N(!0);
this.Q=!1;this.trigger("renderSkeleton")}else this.i&&this.za(this.w,this.d[0].scrollTop);this.trigger("render");return this},addColumn:function(a,b){if(a&&!this.b.get(a.name)){var c=null;void 0!==b&&(c=this.b.get(b)||this.b.Y(b));var g=this.ta(a);g.order=c?c.order:this.b.Ga()+1;for(var c=this.b.Ga(),e=g.order,d;c>=e;c--)(d=this.b.Y(c))&&d.order++;this.b.push(g);this.b.na();this.m=!0;this.c=this.b.M();this.render();this.trigger("addColumn",g.name)}return this},removeColumn:function(a){var b=this.b.indexOf(a);
-1<b&&(this.b.splice(b,1),this.b.na(),this.m=!0,this.c=this.b.M(),this.render(),this.trigger("removeColumn",a));return this},filter:function(a,b,c){if(this.b.get(a)){var g=!!this.f;this.f&&(this.f=null);this.f=this.e.Fa(a,b,c);if(g||this.f)this.m=!0,this.render(),this.trigger("filter",a,b,c)}return this},R:function(){this.f&&(this.f=null,this.f=this.e.Fa(this.e.L,this.e.X,this.e.ma));return this},setColumnLabel:function(a,b){var c=this.b.get(a);if(c&&(c.label=void 0===b?c.name:b,c.element))for(var g=
0;g<c.element[0].firstChild.childNodes.length;g++){var e=c.element[0].firstChild.childNodes[g];if(3===e.nodeType){e.textContent=c.label;break}}return this},moveColumn:function(a,b){var c,g;"string"===typeof a?c=this.b.get(a):"number"===typeof a&&(c=this.c[a]);"string"===typeof b?g=this.b.get(b):"number"===typeof b&&(g=this.c[b]);if(c&&g&&a!==b){var e=c.order,d=g.order;this.c=this.b.moveColumn(c,g).M();if(this.i)this.m=!0,this.render();else{var f=this.p.find(">tr>th");g=e<d?d+1:d;f[0].parentNode.insertBefore(f[e],
f[g]);for(var f=this.c[e],f=(f.t||f.j)+"px",m=this.c[d],m=(m.t||m.j)+"px",k=this.d[0].childNodes,l=0,n=k.length,v;l<n;l++)v=k[l],1===v.nodeType&&(v.insertBefore(v.childNodes[e],v.childNodes[g]),v.childNodes[d].firstChild.style.width=m,v.childNodes[e].firstChild.style.width=f)}this.trigger("moveColumn",c.name,e,d)}return this},sort:function(a,b,c){var g=this.b.get(a);if(g){var e=this.e.sortColumn;e.length&&e[e.length-1].column==a&&(b=void 0===b?!e[e.length-1].descending:b);if(c){for(a=0;a<e.length;a++)if(e[a].column==
g.name){a<e.length-1?e.length=0:e.splice(e.length-1,1);break}if(0<this.r&&e.length>=this.r||e.length>=this.c.length)e.length=0}else e.length=0;e.push({column:g.name,descending:!(void 0===b||!b)});this.e.sortColumn=e;this.qa();for(a=0;a<e.length;a++)this.Aa(e[a].column,e[a].descending);this.aa&&this.N(!0);this.i||(this.m=!0);this.e.sort(!!this.f);this.R();this.f&&this.render();b=[];for(a=0;a<e.length;a++)b.push({column:e[a].column,descending:e[a].descending});this.trigger("sort",b)}return this},setColumnVisible:function(a,
b){var c=this.b.get(a);c&&!!c.visible!=!!b&&(c.visible=!!b,this.m=!0,this.c=this.b.M(),this.render(),this.trigger(b?"showColumn":"hideColumn",a));return this},isColumnVisible:function(a){return(a=this.b.get(a))?a.visible:!1},setMinColumnWidth:function(a){a=Math.max(a,0);this.l!=a&&(this.l=a,this.N(!0));return this},getMinColumnWidth:function(){return this.l},setSortableColumns:function(a){if(this.r!=a&&(this.r=a,this.g)){a=this.g.find("thead>tr>th");for(var b=0;b<a.length;b++)d(a[0])[0<this.r&&this.c[b].sortable?
"addClass":"removeClass"]("sortable")}return this},getSortableColumns:function(){return this.r},setMovableColumns:function(a){a=!!a;this.A!=a&&(this.A=a);return this},getMovableColumns:function(){return this.A},setResizableColumns:function(a){a=!!a;this.J!=a&&(this.J=a);return this},getResizableColumns:function(){return this.J},setComparatorCallback:function(a){this.P!=a&&(this.P=a);return this},setColumnWidth:function(a,b){var c=this.xa(b),g=this.b.get(a);if(g){var e=this.U(g);g.width=c.width;g.n=
c.mode;c=this.U(g);e!=c&&this.N(!0);this.trigger("setColumnWidth",g.name,e,c)}return this},getColumnWidth:function(a){return(a=this.b.get(a))?this.U(a):null},getColumnConfig:function(a){return(a=this.b.get(a))?{order:a.order,width:this.U(a),visible:a.visible}:null},getColumnsConfig:function(){for(var a={},b=0;b<this.b.length;b++)a[this.b[b].name]=this.getColumnConfig(this.b[b]);return a},getSortedColumns:function(){for(var a=[],b=0,c;b<this.e.sortColumn.length;b++)c=this.e.sortColumn[b],a.push({column:c.column,
descending:c.descending});return a},getHtmlForCell:function(a,b){return 0>a||a>this.e.length-1||!this.b.get(b)?null:this.F(this.e[a][b],b)},H:function(a){return(parseFloat(d.css(a,"padding-left"))||0)+(parseFloat(d.css(a,"padding-right"))||0)},Ra:function(a){return(parseFloat(d.css(a,"border-left"))||0)+(parseFloat(d.css(a,"border-right"))||0)},pa:function(){function a(a){var b=k(a,"width");return"auto"===b?(parseFloat(d(a).css("width"))||0)+1:parseFloat(b)||0}var b=this.$el.width(),c,g,e,p;if(this.g)c=
this.g,g=this.p;else{c=e=d("<table></table>").css({position:"absolute",top:"-9999px",visibility:"hidden"}).addClass(this.ga);g=p=d("<thead></thead>");for(var f=d("<tr></tr>"),m=0;m<this.c.length;m++)f.append(d("<th><div></div></th>"));e.append(p.append(f))}var k=window.getComputedStyle?function(a,b){var c=window.getComputedStyle(a,null);return c?c.getPropertyValue(b):null}:function(a,b){var c=a.currentStyle;return c?c[b]:null},b=b-this.Ra(c[0]);c=g.find(">tr>th");for(var m=0,l;m<c.length;m++)f=d(c[m].firstChild),
p=d(c[m]),g=Math.max(parseFloat(p.css("border-left-width"))||0,0<m?parseFloat(d(c[m-1]).css("border-right-width"))||0:0),l="border-box"===p.css("boxSizing"),b-=g+(f.outerWidth()-f.width())+(a(p[0])+(l?0:this.H(p[0]))-f.outerWidth());b-=parseFloat(d(c[c.length-1]).css("border-right-width"))||0;e&&e.remove();c=g=e=p=null;return b},N:function(){function a(a){a=d("<table><thead><tr><th>"+a+"</th></tr></thead></table>").css({position:"absolute",top:"-9999px",visibility:"hidden"}).addClass(this.ga);var b=
a.find(">thead>tr>th");b.css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden"});a.appendTo(document.body);b=b.width();a.remove();return b}var b=null;return function(c,g){var e=this.pa(),d=e,f=0;if(d!=b||c){b=e;var m,k=[],l,n;for(l=e=0;l<this.b.length;l++)this.b[l].t=null;for(l=0;l<this.c.length;l++)n=this.c[l],n.n==s.ABSOLUTE?(m=n.width,m+=n.la||0,m<this.l&&(m=this.l),d-=m,m!==n.j&&(n.j=m,k.push(l))):n.n==s.AUTO?(m=_.bind(a,this)(n.label)+20,m+=n.la||0,m<this.l&&(m=this.l),
d-=m,m!==n.j&&(n.j=m,k.push(l))):n.n==s.RELATIVE&&(e+=n.width,f++);if(f&&(1>e&&this.eb||1<e&&this.fb))for(l=0;l<this.c.length;l++)n=this.c[l],n.n==s.RELATIVE&&(n.width/=e);e=d;for(l=0;l<this.c.length;l++)n=this.c[l],n.n==s.RELATIVE&&(m=Math.round(e*n.width),m<this.l&&(m=this.l),d-=m,f--,0===f&&1===d&&(m++,d--),-1===d&&(m--,d++),m!==n.j&&(n.j=m,k.push(l)));this.c[this.c.length-1].t=this.c[this.c.length-1].j-(this.T||0);if(g||void 0===g)for(l=0;l<k.length;l++)this.hb(k[l])}return this}}(),addRows:function(a){if(a){this.scrollTop=
this.$el.find(".table").scrollTop();var b=this.e.length;this.Q=!0;this.e.add(a);if(this.i)this.R(),0===b&&(this.f||this.e).length&&(this.m=!0),this.render();else if(this.f)b=this.f.length,this.R(),this.f&&this.f.length==b||(this.m=!0,this.render());else if(this.d){var c,g,e,d,f=this.ba,k=this.c,h=this.F;d=document.createDocumentFragment();for(var l=this.d[0].childNodes.length,n=0,v,t,r,q=this.c.length,s=a.length;n<s;n++){v=a[n];c=u("tr");c.rowIndex=n;for(t=0;t<q;t++)r=k[t],g=u("div"),g.style.width=
(r.t||r.j)+"px",g.innerHTML=h(v[r.name],r.name),e=u("td"),r.cellClasses&&(e.className=r.cellClasses),f&&this.G(e),e.appendChild(g),c.appendChild(e);this.trigger("rowCreate",l+n,b+n,c);d.appendChild(c)}this.d[0].appendChild(d);this.ia()}this.trigger("addRows",a.length,!1)}return this},setRows:function(a){this.scrollTop=this.$el.find(".table").scrollTop();this.e.reset(a);this.R();this.m=!0;this.render().trigger("addRows",a.length,!0);return this},getUrlForElementContent:function(a){if(a=document.getElementById(a)){a=
a.textContent;if("function"===typeof Blob)a=new Blob([a]);else{var b=h.BlobBuilder||h.WebKitBlobBuilder||h.ob||h.nb;if(!b)return null;b=new b;b.append(a);a=b.getBlob()}return(h.URL||h.webkitURL).createObjectURL(a)}return null},isWorkerSupported:function(){return h.Worker instanceof Function},createWebWorker:function(a,b){if(this.isWorkerSupported()){var c=this,g=new Worker(a),e=function(a){a.data.append?c.addRows(a.data.rows):c.setRows(a.data.rows)};g.addEventListener("message",e,!1);this.o||(this.o=
[]);this.o.push({Ia:g,Ha:e});(b||void 0===b)&&g.postMessage(null);return g}return null},unbindWebWorker:function(a){if(this.o)for(var b=0;b<this.o.length;b++)this.o[b].Ia==a&&(a.removeEventListener("message",this.o[b].Ha,!1),this.o.splice(b,1),b--);return this},abortCellPreview:function(){this.oa=!0;return this},wa:function(a,b){if(!0===b||this.w!==this.d[0].scrollTop){var c=parseInt(this.d[0].scrollTop/this.B,10),g=c-this.q;0>g&&(g=0);this.a.u=this.a.first;this.a.v=this.a.last;this.a.first=g;this.a.last=
c+this.s+this.q;c=this.f||this.e;this.a.last>c.length&&(this.a.last=c.length,this.a.first=Math.max(0,this.a.last-this.s-2*this.q));this.za(this.w,this.d[0].scrollTop)}},bb:function(){this.p[0].scrollLeft=this.d[0].scrollLeft},da:function(a){for(var b=this.I(),c=d(a.target).closest("th"),g=c[0],e=c[0].previousSibling;e&&1!=e.nodeType;)e=e.previousSibling;var p=!e;a=(a.originalEvent.pageX||a.originalEvent.clientX)-c.offset().left;if(b){if(!p&&c.outerWidth()-a<=this.S/2)return e.k;if(a<=this.S/2)return g.k}else{if(!p&&
a<=this.S/2)return e.k;if(c.outerWidth()-a<=this.S/2)return g.k}return null},Za:function(a){if(this.J){var b=this.da(a);a=d(a.target).closest("th")[0];b&&this.b.get(b).resizable?a.style.cursor="e-resize":a.style.cursor=""}},Ya:function(a){d(a.target).closest("th")[0].style.cursor=""},Sa:function(a){if(!this.da(a)&&(a=d(a.target).closest("th")[0],this.r)){var b=this.b.get(a.k);b&&b.sortable&&this.sort(a.k,void 0,!0)}},ab:function(a){var b=this.da(a),c;if(b){c=this.b.get(b);if(!this.J||!c||!c.resizable)return!1;
b=this.I();this.h&&d(this.h).remove();this.h=d("<div></div>").addClass(this.ib).css({position:"absolute",display:"block","z-index":-1,visibility:"hidden",width:"2px",background:"#000",opacity:0.7}).appendTo(this.$el);c=c.element;var g=this.h.parent(),e=c.offset(),p=g.offset();8==k&&(e=c.offset());p.left+=parseFloat(g.css("border-left-width"))||0;p.top+=parseFloat(g.css("border-top-width"))||0;e.left-=p.left;e.top-=p.top;e.top-=parseFloat(c.css("border-top-width"))||0;g=this.h.outerWidth();b?e.left-=
Math.ceil((parseFloat(c.css("border-left-width"))||0)/2):(e.left+=c.outerWidth(),e.left+=Math.ceil((parseFloat(c.css("border-right-width"))||0)/2));e.left-=Math.ceil(g/2);b=this.g.height()-(this.g.offset().top-c.offset().top);this.h.css({"z-index":"10",visibility:"visible",left:e.left,top:e.top,height:b})[0].k=c[0].k;try{this.h[0].style.zIndex=""}catch(f){}d(document).on("mousemove",this.ua);d(document).on("mouseup",this.fa);a.preventDefault()}else this.A?(b=d(a.target).closest("th"),(c=this.b.get(b[0].k))&&
c.C?(b[0].style.opacity=0.35,this.ca=161061273*Math.random(),a.originalEvent.dataTransfer.setData("text",JSON.stringify({Ea:this.ca,column:c.name}))):a.preventDefault()):a.preventDefault()},$a:function(a){var b=this.b.get(this.h[0].k),c=this.I(),b=b.element,g=this.h.parent(),e=b.offset(),d=g.offset();d.left+=parseFloat(g.css("border-left-width"))||0;e.left-=d.left;g=this.h.outerWidth();a=a.pageX-d.left;e=e.left;c?(e+=b.outerWidth(),e-=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),e-=Math.ceil(g/
2),e-=this.l,e-=this.H(b[0]),a>e&&(a=e)):(e+=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),e-=Math.ceil(g/2),e+=this.l,e+=this.H(b[0]),a<e&&(a=e));this.h.css("left",a+"px")},Xa:function(a){if(this.h){d(document).off("mousemove",this.ua);d(document).off("mouseup",this.fa);var b=this.b.get(this.h[0].k),c=this.I(),g=b.element,e=this.h.parent(),p=g.offset(),f=e.offset();f.left+=parseFloat(e.css("border-left-width"))||0;p.left-=f.left;e=this.h.outerWidth();a=a.pageX-f.left;p=f=p.left;p=0;c?
(a+=this.H(g[0]),f+=g.outerWidth(),f-=Math.ceil((parseFloat(g.css("border-right-width"))||0)/2),f-=Math.ceil(e/2),p=f-this.l,a>p&&(a=p),p=f-a):(a-=this.H(g[0]),f+=Math.ceil((parseFloat(g.css("border-right-width"))||0)/2),f-=Math.ceil(e/2),p=f+this.l,a<p&&(a=p),p=a-f);this.h.remove();this.h=null;c=p;if(b.n==s.RELATIVE){c=this.pa();for(g=0;g<this.c.length;g++)e=this.c[g],e.n!=s.RELATIVE&&(c-=e.j);c=p/c*100;c+="%"}this.setColumnWidth(b.name,c)}else a.target.style.opacity=null},Ta:function(a){if(this.A){var b=
a.originalEvent.dataTransfer.getData("text"),b=b?JSON.parse(b):null;a=d(a.target).closest("th");(!b||this.ca==b.Ea&&a.k!==b.column)&&(b=this.b.get(a[0].k))&&(b.C||b!=this.c[0])&&d(a).addClass("drag-over")}},Va:function(a){a.preventDefault()},Ua:function(a){var b=d(a.target).closest("th");d(b[0].firstChild).has(a.originalEvent.relatedTarget).length||b.removeClass("drag-over")},Wa:function(a){a.preventDefault();var b=JSON.parse(a.originalEvent.dataTransfer.getData("text"));a=d(a.target).closest("th");
if(this.A&&b.Ea==this.ca){var b=b.column,c=a[0].k,g=this.b.get(b),e=this.b.get(c);g&&e&&g.C&&(e.C||e!=this.c[0])&&this.moveColumn(b,c)}d(a).removeClass("drag-over")},qa:function(){if(this.g){var a=this.g.find(">thead>tr>th.sorted"),b=a.find(">div>.sort-arrow");_.forEach(b,_.bind(function(a){if(a=this.b.get(a.parentNode.parentNode.k))a.la=0},this));b.remove();a.removeClass("sorted").removeClass("desc")}return this},Aa:function(a,b){var c=this.b.get(a),g=u("span");g.className="sort-arrow";c.element.addClass(b?
"sorted desc":"sorted");c.element[0].firstChild.insertBefore(g,c.element[0].firstChild.firstChild);c.n!=s.RELATIVE&&this.aa&&(c.la=g.scrollWidth+(parseFloat(d(g).css("margin-right"))||0)+(parseFloat(d(g).css("margin-left"))||0));return this},hb:function(a){var b=this.g.find(">thead>tr>th"),c=this.b.get(b[a].k);if(c){b[a].firstChild.style.width=c.j+"px";for(var b=(c.t||c.j)+"px",c=this.d[0].childNodes,d=this.i?1:0,e=c.length-(this.i?1:0),f;d<e;d++)f=c[d],1===f.nodeType&&(f.childNodes[a].firstChild.style.width=
b);this.ja()}return this},Ca:function(){this.g&&this.g.find(">thead>tr>th").off("mousemove").off("mouseleave").off("dragstart").off("selectstart").off("click").find(">div").off("dragenter").off("dragover").off("dragleave").off("drop");return this},gb:function(){var a=0;this.K&&(a=parseFloat(this.K.style.height));this.Ca().Da();var b,c,g,e,f,k,m,h,l,n,v=this.ba,s=u("tr"),r;q&&(r=function(a){a.preventDefault();this.pb();return!1});for(b=0;b<this.c.length;b++)if(f=this.c[b],f.visible&&(h=u("div"),h.style.width=
f.j+"px",h.innerHTML=this.Qa(f.label,f.name),c=u("th"),c.draggable=!0,this.r&&f.sortable&&(c.className="sortable"),c.k=f.name,v&&this.G(c),c.appendChild(h),s.appendChild(c),this.c[b].element=d(c),d(c).on("mousemove",_.bind(this.Za,this)).on("mouseleave",_.bind(this.Ya,this)).on("dragstart",_.bind(this.ab,this)).on("click",_.bind(this.Sa,this)),d(h).on("dragenter",_.bind(this.Ta,this)).on("dragover",_.bind(this.Va,this)).on("dragleave",_.bind(this.Ua,this)).on("drop",_.bind(this.Wa,this)),q))d(c).on("selectstart",
_.bind(r,c));if(this.g&&this.i&&(this.d.off("scroll"),this.g.remove(),this.d))for(r=this.d[0].childNodes,b=0,c=r.length;b<c;b++)this.trigger("rowDestroy",r[b]);"static"==this.$el.css("position")&&this.$el.css("position","relative");this.i||!this.g?(f=document.createDocumentFragment(),b=u("table"),b.className=this.ga,f.appendChild(b),c=u("thead"),c.style.display="block",t&&d(c).css({"float":"rtl"==this.$el.css("direction")?"right":"left",clear:"both"}),b.appendChild(c),r=u("tbody"),r.style.maxHeight=
this.ra+"px",r.style.display="block",r.style.overflowY="auto",r.style.overflowX="hidden",t&&d(r).css({"float":"rtl"==this.$el.css("direction")?"right":"left",clear:"both"}),this.W==w.Width.SCROLL&&(c.style.overflowX="hidden",r.style.overflowX="auto"),b.appendChild(r),this.el.appendChild(f),this.g=d(b),this.d=d(r),this.p=d(c)):(b=this.g[0],r=this.d[0],c=this.p[0]);this.i&&!this.B&&(h=function(){var a=u("tr");a.appendChild(u("td")).appendChild(u("div")).innerHTML="0";a.style.visibility="hidden";a.style.position=
"absolute";return a},b=r.appendChild(h()),f=r.appendChild(h()),h=r.appendChild(h()),this.B=d(f).outerHeight(),r.removeChild(b),r.removeChild(f),r.removeChild(h),this.s=parseInt(this.ra/this.B,10));var x=this.f||this.e,B=!!this.f;this.i&&(this.a&&this.a.last-this.a.first>=this.s?(this.a.u=this.a.u!=this.a.first?this.a.u:this.a.first,this.a.v=this.a.v!=this.a.last?this.a.v:this.a.last,this.a.last>x.length&&(this.a.last=x.length,this.a.first=Math.max(0,this.a.last-this.s-2*this.q))):(b=this.s+this.q,
b>x.length&&(b=x.length),this.a={first:0,last:b,u:0,v:b}));var y=document.createDocumentFragment();this.i&&(l=this.K=document.createElement("tr"),l.style.height=a+"px",y.appendChild(l));var z;this.i?(b=this.a.first,z=this.a.last):(b=0,z=x.length);var A=this.c,C=this.F;k=A.length;for(m=x.length;b<m&&b<z;b++){g=x[b];l=document.createElement("tr");l.rowIndex=b;for(e=0;e<k;e++)f=A[e],h=document.createElement("div"),h.style.width=f.j+"px",h.innerHTML=C(g[f.name],f.name),n=document.createElement("td"),
f.cellClasses&&(n.className=f.cellClasses),v&&this.G(n),n.appendChild(h),l.appendChild(n);y.appendChild(l);this.trigger("rowCreate",b,B?g.__i:b,l)}this.i&&(l=this.ka=document.createElement("tr"),l.style.height=this.B*Math.max(0,x.length-this.s-this.q)-a+"px",y.appendChild(l));try{c.innerHTML=""}catch(D){c.textContent=""}c.appendChild(s);try{r.innerHTML=""}catch(E){r.textContent=""}r.appendChild(y);this.ia(!0);this.i&&this.D();return this},ia:function(a){var b=this.d[0].offsetWidth-this.d[0].clientWidth;
if(b!=this.T||a){this.T=b;for(a=0;a<this.b.length;a++)this.b[a].t=null;if(0<this.T){b=this.c.length-1;this.c[b].t=this.c[b].j-this.T;var c=this.c[b].t+"px",d=this.d[0].childNodes;a=this.i?1:0;for(var e=d.length-(this.i?1:0),f;a<e;a++)f=d[a],1===f.nodeType&&(f.childNodes[b].firstChild.style.width=c)}}return this},za:function(a,b){var c,d,e=this.a.last-this.a.first-(this.a.v-this.a.u),f=this.s+this.q;if(b<a)c=this.a.first,d=this.a.u,this.a.last<=this.a.u&&(c=this.a.first,d=this.a.last),this.a.u=this.a.first,
this.a.v=this.a.last,this.ya(d-c-e,!1),this.Z(c,d,!0),this.D();else if(b>a)c=this.a.v,d=this.a.last,this.a.first>=this.a.v&&(c=this.a.first,d=this.a.last),this.a.u=this.a.first,this.a.v=this.a.last,this.ya(d-c-e,!0),this.Z(c,d,!1),this.D();else if(this.Q)this.Q=!1,d=this.f||this.e,this.a.last<d.length&&this.a.last<f&&(c=this.a.last,d=d.length,d>f&&(d=f),this.Z(c,d,!1),this.a.last=d),this.D();else{this.D();this.cb(this.a.first);return}this.ia();this.ja();this.w=this.d[0].scrollTop},D:function(){var a=
((this.f||this.e).length-(this.d[0].childNodes.length-2))*this.B;if(0>a)this.K.style.height=0,this.ka.style.height=0;else{var b=this.a.first*this.B;this.K.style.height=b+"px";this.ka.style.height=a-b+"px"}},Z:function(a,b,c){if(c)for(c=this.K.nextSibling;c&&1!=c.nodeType;)c=c.nextSibling;else c=this.ka;for(;a<b;a++)this.La(a,c)},La:function(a,b){var c=document.createElement("tr");c.rowIndex=a;for(var d=(this.f||this.e)[a],e=!!this.f,f=this.ba,k=this.c,m=this.F,h=0,l,n,t,q=k.length;h<q;h++)l=k[h],
n=document.createElement("div"),n.style.width=(l.t||l.j)+"px",n.innerHTML=m(d[l.name],l.name),t=document.createElement("td"),l.cellClasses&&(t.className=l.cellClasses),f&&this.G(t),t.appendChild(n),c.appendChild(t);this.d[0].insertBefore(c,b);this.trigger("rowCreate",a,e?d.__i:a,c)},ya:function(a,b){var c,d;a>this.s+2*this.q&&(a=this.s+2*this.q);var e=this.d[0],f=e.childNodes;d=this.d[0].childNodes.length-2;b?(c=1,d=Math.min(a+1,d+1)):(c=d+1-a,d+=1);for(var k=c;k<d;d--)this.kb(f[c]),this.trigger("rowDestroy",
f[c]),e.removeChild(f[c])},cb:function(a){for(var b=this.d[0].getElementsByTagName("tr"),c=this.f||this.e,f=!!this.f,e,k=this.c,h=this.F,m=1,t,l,n,q,s,r=b.length-1;m<r;m++){t=b[m];this.trigger("rowDestroy",t);t.rowIndex=e=a+m-1;e=c[e];l=d("td>div",t);for(n=0;n<l.length;n++)q=l[n],s=k[n],s=s.name,q.innerHTML=h(e[s],s);this.trigger("rowCreate",m,f?e.__i:m,t)}},ja:function(){if(this.W==w.Width.AUTO){for(var a=this.g.find(">thead>tr>th"),b=0,c=0;c<a.length;c++)b+=d(a[c])[0].offsetWidth;this.g.width(b);
this.$el.width(b)}else if(this.W==w.Width.SCROLL)if(a=this.$el.innerWidth(),b=this.g.width(),c=this.p[0].scrollWidth,this.d.off("scroll",this.va),c>b||c>a)this.p.width(a),this.d.width(a),this.d.on("scroll",this.va);else{try{this.p[0].style.width=""}catch(f){}try{this.d[0].style.width=""}catch(e){}}return this},I:function(){return"rtl"==this.g.css("direction")},U:function(a){return a.n==s.AUTO?"auto":a.n==s.RELATIVE?100*a.width+"%":a.width},Oa:function(a){this.oa=!1;if(a.firstChild.scrollWidth>a.firstChild.clientWidth){this.sa();
var b=d(a),c=d(a.firstChild),f=u("div"),e=d(f);f.className=this.Pa;var k=parseFloat(b.css("padding-left"))||0,h=parseFloat(b.css("padding-right"))||0,m=parseFloat(b.css("padding-top"))||0,t=parseFloat(b.css("padding-bottom"))||0,l=a.firstChild.scrollWidth+a.clientWidth-a.firstChild.offsetWidth,n=a.firstChild.scrollHeight+a.clientHeight-a.firstChild.offsetHeight;"border-box"===b.css("boxSizing")?(l-=parseFloat(d(a).css("border-left-width"))||0,l-=parseFloat(d(a).css("border-right-width"))||0,n-=parseFloat(d(a).css("border-top-width"))||
0,n-=parseFloat(d(a).css("border-bottom-width"))||0,e.css("box-sizing","border-box")):(l-=k+h,n-=m+t,e.css({"margin-top":parseFloat(d(a).css("border-top-width"))||0}));if(!this.Ba){var q=document.createElement("div");q.style.backgroundColor="transparent";this.Ba=d(q).css("background-color");q.style.backgroundColor="rgba(0,0,0,0)";this.jb=d(q).css("background-color")}q=d(a).css("background-color");if(q==this.Ba||q==this.jb)q="#fff";e.css({width:l+"px",height:n+"px","padding-left":k,"padding-right":h,
"padding-top":m,"padding-bottom":t,overflow:"hidden",position:"absolute",zIndex:"-1",left:"0",top:"0","background-color":q,cursor:"default"});f.innerHTML=a.innerHTML;document.body.appendChild(f);f.firstChild.style.width=f.clientWidth-a.clientWidth+parseFloat(a.firstChild.style.width)+"px";f.firstChild.style.direction=c.css("direction");f.firstChild.style.whiteSpace=c.css("white-space");f.__row=a.parentNode.getAttribute("data-row");f.__column=this.c[_.indexOf(a.parentNode.childNodes,a)].name;this.trigger("cellPreview",
f.firstChild,f.__row,f.__column);this.oa||(c=b.offset(),this.I()?(k=e.outerWidth(),b=b.outerWidth(),c.left-=k-b):c.left+=parseFloat(d(a).css("border-left-width"))||0,c.top+=parseFloat(d(a).css("border-top-width"))||parseFloat(d(a).css("border-bottom-width"))||0,e.css({left:c.left,top:c.top,"z-index":9999,zIndex:9999}),f.__cell=a,this.O=e,a.__previewEl=f,this.ea(a),this.ea(f))}},Na:function(){this.sa()},sa:function(){if(this.O){var a=this.O[0];this.O.remove();this.ha(a.__cell);this.ha(a);a.__cell.__previewEl=
null;a.__cell=null;this.trigger("cellPreviewDestroy",a.firstChild,a.__row,a.__column);this.O=null}return this}}),s={AUTO:0,ABSOLUTE:1,RELATIVE:2};w.Width={NONE:"none",AUTO:"auto",SCROLL:"SCROLL"};h.DGTable=w})(this,jQuery);
DGTable.Ja=function(){function h(){var d=[];_.extend(d,h.prototype);d.initialize.apply(d,arguments);return d}h.prototype=[];h.prototype.initialize=function(){};h.prototype.get=function(d){for(var f=0,k=this.length;f<k;f++)if(this[f].name==d)return this[f];return null};h.prototype.indexOf=function(d){for(var f=0,k=this.length;f<k;f++)if(this[f].name==d)return f;return-1};h.prototype.Y=function(d){for(var f=0,k=this.length;f<k;f++)if(this[f].order==d)return this[f];return null};h.prototype.na=function(){var d=
[],f;for(f=0;f<this.length;f++)d.push(this[f]);d.sort(function(d,f){return d.order<f.order?-1:d.order>f.order?1:0});for(f=0;f<d.length;f++)d[f].order=f};h.prototype.M=function(){for(var d=[],f=0,k;f<this.length;f++)k=this[f],k.visible&&d.push(k);d.sort(function(d,f){return d.order<f.order?-1:d.order>f.order?1:0});return d};h.prototype.Ga=function(){for(var d=0,f=0,k;f<this.length;f++)k=this[f],k.order>d&&(d=k.order);return d};h.prototype.moveColumn=function(d,f){if(d&&f){var k=d.order,h=f.order,q;
if(k<h)for(k+=1;k<=h;k++)q=this.Y(k),q.order--;else for(k-=1;k>=h;k--)q=this.Y(k),q.order++;d.order=h}return this};return h}();
DGTable.Ka=function(){function h(){var d=[];_.extend(d,h.prototype);d.initialize.apply(d,arguments);return d}h.prototype=[];_.extend(h.prototype,Backbone.Events);h.prototype.initialize=function(d){d=d||{};this.X=this.L=null;this.ma=!1;this.sortColumn=null==d.sortColumn?[]:d.sortColumn};h.prototype.add=function(d,f){var k,h;if("splice"in d&&"length"in d)if(f)for(k=0,h=d.length;k<h;k++)this.splice(f++,0,d[k]);else for(k=0,h=d.length;k<h;k++)this.push(d[k]);else f?this.splice(f,0,d):this.push(d)};h.prototype.reset=
function(d){this.length=0;d&&this.add(d)};h.prototype.Fa=function(d,f,k){if((f=f.toString())&&null!=d){var t=new h({sortColumn:this.sortColumn});this.L=d;this.X=f;this.ma=k;f=d=0;k=this.length;for(var q;f<k;f++)q=this[f],this.mb(q)&&(q.__i=d++,t.push(q));return t}return this.X=this.L=null};h.prototype.mb=function(d){if(d&&this.L){d=d[this.L];if(null==d)return!1;d=d.toString();var f=this.X;this.ma||(d=d.toUpperCase(),f=f.toUpperCase());return-1!==d.indexOf(f)}return!0};(function(){function d(d,f){var h=
f?1:-1,u=f?-1:1;return function(f,t){var a=f[d],b=t[d];return a<b?h:a>b?u:0}}var f=h.prototype.sort;h.prototype.sort=function(k){if(this.sortColumn.length){var h=[],q,u;for(q=0;q<this.sortColumn.length;q++)u={},this.trigger("requiresComparatorForColumn",u,this.sortColumn[q].column,this.sortColumn[q].descending),h.push(_.bind(u.lb||d(this.sortColumn[q].column,this.sortColumn[q].descending),this));if(1===h.length)f.call(this,h[0]);else{var w=h.length,s;f.call(this,function(a,b){for(q=0;q<w&&(s=h[q](a,
b),0===s);q++);return s})}k||this.trigger("sort")}return this}})();return h}();
//# sourceMappingURL=DGTable.min.js.map