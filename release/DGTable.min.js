'use strict';(function(h,c){var e=navigator.userAgent,k=-1!=e.indexOf("MSIE ")?parseFloat(e.substr(e.indexOf("MSIE ")+5)):null,u=k&&10>k,s=k&&10>k,v=_.bind(document.createElement,document),w=Backbone.View.extend({className:"dgtable-wrapper",tagName:"div",VERSION:"0.2.7",initialize:function(a){function b(a){a=a||event;a=a.toElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||e.Oa.call(e,this)}function d(a){a=a||event;
a=a.fromElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||e.Pa.call(e,this)}a=a||{};a.columns=a.columns||[];this.va=_.bind(this.ab,this);this.ia=_.bind(this.Ya,this);this.wa=_.bind(this.cb,this);this.$el.on("dragend",this.ia);this.m=!0;this.R=!1;this.h=void 0===a.virtualTable?!0:!!a.virtualTable;this.q=a.rowsBufferSize||10;this.l=Math.max(a.minColumnWidth||35,0);this.S=a.resizeAreaWidth||8;this.L=void 0===a.resizableColumns?
!0:!!a.resizableColumns;this.B=void 0===a.movableColumns?!0:!!a.movableColumns;this.r=void 0===a.sortableColumns?1:parseInt(a.sortableColumns,10)||1;this.ca=void 0===a.adjustColumnWidthForSortArrow?!0:!!a.adjustColumnWidthForSortArrow;this.ea=void 0===a.convertColumnWidthsToRelative?!1:!!a.convertColumnWidthsToRelative;this.Na=void 0===a.cellClasses?"":a.cellClasses;this.jb=void 0===a.resizerClassName?"dgtable-resize":a.resizerClassName;this.ja=void 0===a.tableClassName?"dgtable":a.tableClassName;
this.da=void 0===a.allowCellPreview?!0:a.allowCellPreview;this.Qa=void 0===a.cellPreviewClassName?"dgtable-cell-preview":a.cellPreviewClassName;this.Q=void 0===a.comparatorCallback?null:a.comparatorCallback;this.Y=void 0===a.width?w.Width.NONE:a.width;this.fb=void 0===a.relativeWidthGrowsToFillWidth?!0:!!a.relativeWidthGrowsToFillWidth;this.gb=void 0===a.relativeWidthShrinksToFillWidth?!1:!!a.relativeWidthShrinksToFillWidth;this.G=a.cellFormatter||function(a){return a};this.Ra=a.headerCellFormatter||
function(a){return a};var g,f,p,c,n=new w.Ka;for(c=g=0;g<a.columns.length;g++)f=a.columns[g],p=this.ua(f),void 0!==f.order?(f.order>c&&(c=f.order+1),p.order=f.order):p.order=c++,n.push(p);n.pa();this.b=n;this.d=n.O();if(void 0===a.sortColumn)a.sortColumn=null;else if("string"==typeof a.sortColumn)this.b.get(a.sortColumn)?a.sortColumn=[{column:a.sortColumn,descending:!1}]:a.sortColumn=null;else if(a.sortColumn instanceof Array){c=[];g=0;f=a.sortColumn.length;for(p;g<f&&(p=a.sortColumn[g],p=void 0!==
p.column?p:{column:p,descending:!1},(p=this.b.get(p.column))&&!_.contains(c,p.name)&&c.push(p.name),c.length!=this.r&&c.length!=this.d.length);g++);a.sortColumn=c}else"object"==typeof a.sortColumn?this.b.get(a.sortColumn.column)||(a.sortColumn=null):a.sortColumn=null;this.e=new w.La({sortColumn:a.sortColumn,columns:this.columns});this.listenTo(this.e,"sort",this.render).listenTo(this.e,"requiresComparatorForColumn",_.bind(function(a,b,d){this.Q&&(a.lb=this.Q(b,d))},this));this.f=null;this.w=a.height;
this.A=0;var e=this;"addEventListener"in window?(this.H=function(a){a.__hoverIn||a.addEventListener("mouseover",a.__hoverIn=_.bind(d,a));return this},this.V=function(a){a.__hoverIn&&(a.removeEventListener("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ha=function(a){a.__hoverOut||a.addEventListener("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.la=function(a){a.__hoverOut&&(a.removeEventListener("mouseout",a.__hoverOut),a.__hoverOut=null);return this}):(this.H=function(a){a.__hoverIn||
a.attachEvent("mouseover",a.__hoverIn=_.bind(d,a));return this},this.V=function(a){a.__hoverIn&&(a.detachEvent("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ha=function(a){a.__hoverOut||a.attachEvent("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.la=function(a){a.__hoverOut&&(a.detachEvent("mouseout",a.__hoverOut),a.__hoverOut=null);return this})},ya:function(a){var b=parseFloat(a),d=t.AUTO;0<b&&(a==b+"%"?(d=t.RELATIVE,b/=100):0<b&&1>b?d=t.RELATIVE:(b<this.l&&(b=this.l),
d=t.ABSOLUTE));return{width:b,mode:d}},ua:function(a){var b=this.ya(a.width);return{name:a.name,label:void 0===a.label?a.name:a.label,width:b.width,n:b.mode,resizable:void 0===a.resizable?!0:a.resizable,sortable:void 0===a.sortable?!0:a.sortable,D:void 0===a.D?!0:a.D,visible:void 0===a.visible?!0:a.visible,cellClasses:void 0===a.cellClasses?this.Na:a.cellClasses}},close:function(){this.i&&(this.i.remove(),this.i=null);if(this.c)for(var a=this.c[0].childNodes,b=0,d=a.length;b<d;b++)this.trigger("rowDestroy",
a[b]);this.remove();this.Da().Ea();this.g.unbind();this.c.unbind();this.$el.unbind();this.unbind();if(this.o){for(a=0;a<this.o.length;a++)b=this.o[a],b.Ja.removeEventListener("message",b.Ia,!1);this.o.length=0}this.e.length=this.b.length=0;for(var g in this)this.hasOwnProperty(g)&&(this[g]=null)},Ea:function(){if(this.p)for(var a=0,b=this.p[0].childNodes,d=b.length,g;a<d;a++){g=b[a];var f=0;g=g.childNodes;for(var c=g.length;f<c;f++)this.V(g[f])}if(this.c)for(a=0,b=this.c[0].childNodes,d=b.length;a<
d;a++)for(g=b[a],f=0,g=g.childNodes,c=g.length;f<c;f++)this.V(g[f]);return this},kb:function(a){var b=0;a=a.childNodes;for(var d=a.length;b<d;b++)this.V(a[b]);return this},render:function(){if(!0===this.m){this.m=!1;this.c&&(this.A=this.c[0].scrollTop);this.Y==w.Width.AUTO&&this.sa();this.tableWidthChanged(!0,!1).hb();var a=this.c[0].scrollHeight-this.c.height();this.A>a&&(this.A=a);this.c[0].scrollTop=this.A;this.h&&(this.c.on("scroll",_.bind(this.xa,this)),this.xa(null,!0));this.X();for(a=0;a<this.e.sortColumn.length;a++)this.Ba(this.e.sortColumn[a].column,
this.e.sortColumn[a].descending);this.ca&&this.tableWidthChanged(!0);this.R=!1;this.trigger("renderSkeleton")}else this.h&&this.Aa(this.A,this.c[0].scrollTop);this.trigger("render");return this},addColumn:function(a,b){if(a&&!this.b.get(a.name)){var d=null;void 0!==b&&(d=this.b.get(b)||this.b.aa(b));var g=this.ua(a);g.order=d?d.order:this.b.Ha()+1;for(var d=this.b.Ha(),f=g.order,c;d>=f;d--)(c=this.b.aa(d))&&c.order++;this.b.push(g);this.b.pa();this.m=!0;this.d=this.b.O();this.render();this.trigger("addColumn",
g.name)}return this},removeColumn:function(a){var b=this.b.indexOf(a);-1<b&&(this.b.splice(b,1),this.b.pa(),this.m=!0,this.d=this.b.O(),this.render(),this.trigger("removeColumn",a));return this},filter:function(a,b,d){if(this.b.get(a)){var g=!!this.f;this.f&&(this.f=null);this.f=this.e.Ga(a,b,d);if(g||this.f)this.m=!0,this.render(),this.trigger("filter",a,b,d)}return this},K:function(){this.f&&(this.f=null,this.f=this.e.Ga(this.e.N,this.e.Z,this.e.oa));return this},setColumnLabel:function(a,b){var d=
this.b.get(a);if(d&&(d.label=void 0===b?d.name:b,d.element))for(var g=0;g<d.element[0].firstChild.childNodes.length;g++){var f=d.element[0].firstChild.childNodes[g];if(3===f.nodeType){f.textContent=d.label;break}}return this},moveColumn:function(a,b){var d,g;"string"===typeof a?d=this.b.get(a):"number"===typeof a&&(d=this.d[a]);"string"===typeof b?g=this.b.get(b):"number"===typeof b&&(g=this.d[b]);if(d&&g&&a!==b){var f=d.order,c=g.order;this.d=this.b.moveColumn(d,g).O();if(this.h)this.m=!0,this.render();
else{var e=this.p.find(">tr>th");g=f<c?c+1:c;e[0].parentNode.insertBefore(e[f],e[g]);for(var e=this.d[f],e=(e.t||e.j)+"px",n=this.d[c],n=(n.t||n.j)+"px",k=this.c[0].childNodes,l=0,m=k.length,q;l<m;l++)q=k[l],1===q.nodeType&&(q.insertBefore(q.childNodes[f],q.childNodes[g]),q.childNodes[c].firstChild.style.width=n,q.childNodes[f].firstChild.style.width=e)}this.trigger("moveColumn",d.name,f,c)}return this},sort:function(a,b,d){var g=this.b.get(a);if(g){var f=this.e.sortColumn;f.length&&f[f.length-1].column==
a&&(b=void 0===b?!f[f.length-1].descending:b);if(d){for(a=0;a<f.length;a++)if(f[a].column==g.name){a<f.length-1?f.length=0:f.splice(f.length-1,1);break}if(0<this.r&&f.length>=this.r||f.length>=this.d.length)f.length=0}else f.length=0;f.push({column:g.name,descending:!(void 0===b||!b)});this.e.sortColumn=f;this.sa();for(a=0;a<f.length;a++)this.Ba(f[a].column,f[a].descending);this.ca&&this.tableWidthChanged(!0);this.h||(this.m=!0);this.e.sort(!!this.f);this.K();this.f&&this.render();b=[];for(a=0;a<
f.length;a++)b.push({column:f[a].column,descending:f[a].descending});this.trigger("sort",b)}return this},setColumnVisible:function(a,b){var d=this.b.get(a);d&&!!d.visible!=!!b&&(d.visible=!!b,this.m=!0,this.d=this.b.O(),this.render(),this.trigger(b?"showColumn":"hideColumn",a));return this},isColumnVisible:function(a){return(a=this.b.get(a))?a.visible:!1},setMinColumnWidth:function(a){a=Math.max(a,0);this.l!=a&&(this.l=a,this.tableWidthChanged(!0));return this},getMinColumnWidth:function(){return this.l},
setSortableColumns:function(a){if(this.r!=a&&(this.r=a,this.g)){a=this.g.find("thead>tr>th");for(var b=0;b<a.length;b++)c(a[0])[0<this.r&&this.d[b].sortable?"addClass":"removeClass"]("sortable")}return this},getSortableColumns:function(){return this.r},setMovableColumns:function(a){a=!!a;this.B!=a&&(this.B=a);return this},getMovableColumns:function(){return this.B},setResizableColumns:function(a){a=!!a;this.L!=a&&(this.L=a);return this},getResizableColumns:function(){return this.L},setComparatorCallback:function(a){this.Q!=
a&&(this.Q=a);return this},setColumnWidth:function(a,b){var d=this.ya(b),g=this.b.get(a);if(g){var f=this.U(g);g.width=d.width;g.n=d.mode;d=this.U(g);f!=d&&this.tableWidthChanged(!0);this.trigger("setColumnWidth",g.name,f,d)}return this},getColumnWidth:function(a){return(a=this.b.get(a))?this.U(a):null},getColumnConfig:function(a){return(a=this.b.get(a))?{order:a.order,width:this.U(a),visible:a.visible}:null},getColumnsConfig:function(){for(var a={},b=0;b<this.b.length;b++)a[this.b[b].name]=this.getColumnConfig(this.b[b]);
return a},getSortedColumns:function(){for(var a=[],b=0,d;b<this.e.sortColumn.length;b++)d=this.e.sortColumn[b],a.push({column:d.column,descending:d.descending});return a},getHtmlForCell:function(a,b){return 0>a||a>this.e.length-1||!this.b.get(b)?null:this.G(this.e[a][b],b)},getDataForRow:function(a){return 0>a||a>this.e.length-1?null:this.e[a]},getDataForFilteredRow:function(a){return 0>a||a>(this.f||this.e).length-1?null:(this.f||this.e)[a]},I:function(a){return(parseFloat(c.css(a,"padding-left"))||
0)+(parseFloat(c.css(a,"padding-right"))||0)},Sa:function(a){return(parseFloat(c.css(a,"border-left"))||0)+(parseFloat(c.css(a,"border-right"))||0)},ra:function(){function a(a){var b=k(a,"width");return"auto"===b?(parseFloat(c(a).css("width"))||0)+1:parseFloat(b)||0}var b=this.$el.width(),d,g,f,p;if(this.g)d=this.g,g=this.p;else{d=f=c("<table></table>").css({position:"absolute",top:"-9999px",visibility:"hidden"}).addClass(this.ja);g=p=c("<thead></thead>");for(var e=c("<tr></tr>"),n=0;n<this.d.length;n++)e.append(c("<th><div></div></th>"));
f.append(p.append(e))}var k=window.getComputedStyle?function(a,b){var d=window.getComputedStyle(a,null);return d?d.getPropertyValue(b):null}:function(a,b){var d=a.currentStyle;return d?d[b]:null},b=b-this.Sa(d[0]);d=g.find(">tr>th");for(var n=0,l;n<d.length;n++)e=c(d[n].firstChild),p=c(d[n]),g=Math.max(parseFloat(p.css("border-left-width"))||0,0<n?parseFloat(c(d[n-1]).css("border-right-width"))||0:0),l="border-box"===p.css("boxSizing"),b-=g+(e.outerWidth()-e.width())+(a(p[0])+(l?0:this.I(p[0]))-e.outerWidth());
b-=parseFloat(c(d[d.length-1]).css("border-right-width"))||0;f&&f.remove();d=g=f=p=null;return b},tableWidthChanged:function(){function a(a){a=c("<table><thead><tr><th>"+a+"</th></tr></thead></table>").css({position:"absolute",top:"-9999px",visibility:"hidden"}).addClass(this.ja);var b=a.find(">thead>tr>th");b.css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden"});a.appendTo(document.body);b=b.width();a.remove();return b}var b=null;return function(d,g){var f=this.ra(),
c=f,e=0;if(c!=b||d){b=f;var n,f=0,k=[],l,m,q=0;for(l=0;l<this.b.length;l++)this.b[l].t=null;for(l=0;l<this.d.length;l++)m=this.d[l],m.n==t.ABSOLUTE?(n=m.width,n+=m.na||0,n<this.l&&(n=this.l),c-=n,f+=n,n!==m.j&&(m.j=n,this.ea||k.push(l))):m.n==t.AUTO?(n=_.bind(a,this)(m.label)+20,n+=m.na||0,n<this.l&&(n=this.l),c-=n,f+=n,n!==m.j&&(m.j=n,this.ea||k.push(l))):m.n==t.RELATIVE&&(q+=m.width,e++);if(this.ea)for(l=0;l<this.d.length;l++)m=this.d[l],m.n!=t.RELATIVE&&(m.n=t.RELATIVE,c+=m.j,m.width=m.j/f,q+=
m.width,e++);if(e&&(1>q&&this.fb||1<q&&this.gb))for(l=0;l<this.d.length;l++)m=this.d[l],m.n==t.RELATIVE&&(m.width/=q);f=c;for(l=0;l<this.d.length;l++)m=this.d[l],m.n==t.RELATIVE&&(n=Math.round(f*m.width),n<this.l&&(n=this.l),c-=n,e--,0===e&&1===c&&(n++,c--),-1===c&&(n--,c++),n!==m.j&&(m.j=n,k.push(l)));this.d[this.d.length-1].t=this.d[this.d.length-1].j-(this.T||0);if(g||void 0===g)for(l=0;l<k.length;l++)this.ib(k[l])}return this}}(),tableHeightChanged:function(){var a=this.$el.innerHeight()-(parseFloat(this.g.css("border-top-width"))||
0)-(parseFloat(this.g.css("border-bottom-width"))||0);a!=this.w&&(this.w=a,this.c&&(this.c[0].style.height=this.w-this.p.outerHeight()+"px"),this.h&&(this.m=!0,this.render()));return this},addRows:function(a){if(a){this.scrollTop=this.$el.find(".table").scrollTop();var b=this.e.length;this.R=!0;this.e.add(a);if(this.h)this.K(),0===b&&(this.f||this.e).length&&(this.m=!0),this.render();else if(this.f)b=this.f.length,this.K(),this.f&&this.f.length==b||(this.m=!0,this.render());else if(this.c){var d,
g,f,c,e=this.da,k=this.d,h=this.G;c=document.createDocumentFragment();for(var l=this.c[0].childNodes.length,m=0,q,u,r,s=this.d.length,t=a.length;m<t;m++){q=a[m];d=v("tr");d._rowIndex=m;for(u=0;u<s;u++)r=k[u],g=v("div"),g.style.width=(r.t||r.j)+"px",g.innerHTML=h(q[r.name],r.name),f=v("td"),r.cellClasses&&(f.className=r.cellClasses),e&&this.H(f),f.appendChild(g),d.appendChild(f);this.trigger("rowCreate",l+m,b+m,d,q);c.appendChild(d)}this.c[0].appendChild(c);this.W()}this.trigger("addRows",a.length,
!1)}return this},removeRow:function(a,b){if(0>a||a>this.e.length-1)return null;this.e.splice(a,1);b=void 0===b?!0:!!b;this.f&&(this.f=this.K(),this.m=!0,b&&this.render());b&&(this.h?this.render():(this.c&&(this.c[0].childNodes.removeChild(this.c[0].childNodes[a]),this.W(),this.X()),this.trigger("render")));return this},setRows:function(a){this.scrollTop=this.$el.find(".table").scrollTop();this.e.reset(a);this.K();this.m=!0;this.render().trigger("addRows",a.length,!0);return this},getUrlForElementContent:function(a){if(a=
document.getElementById(a)){a=a.textContent;if("function"===typeof Blob)a=new Blob([a]);else{var b=h.BlobBuilder||h.WebKitBlobBuilder||h.ob||h.nb;if(!b)return null;b=new b;b.append(a);a=b.getBlob()}return(h.URL||h.webkitURL).createObjectURL(a)}return null},isWorkerSupported:function(){return h.Worker instanceof Function},createWebWorker:function(a,b){if(this.isWorkerSupported()){var d=this,c=new Worker(a),f=function(a){a.data.append?d.addRows(a.data.rows):d.setRows(a.data.rows)};c.addEventListener("message",
f,!1);this.o||(this.o=[]);this.o.push({Ja:c,Ia:f});(b||void 0===b)&&c.postMessage(null);return c}return null},unbindWebWorker:function(a){if(this.o)for(var b=0;b<this.o.length;b++)this.o[b].Ja==a&&(a.removeEventListener("message",this.o[b].Ia,!1),this.o.splice(b,1),b--);return this},abortCellPreview:function(){this.qa=!0;return this},xa:function(a,b){if(!0===b||this.A!==this.c[0].scrollTop){var d=parseInt(this.c[0].scrollTop/this.C,10),c=d-this.q;0>c&&(c=0);this.a.u=this.a.first;this.a.v=this.a.last;
this.a.first=c;this.a.last=d+this.s+this.q;d=this.f||this.e;this.a.last>d.length&&(this.a.last=d.length,this.a.first=Math.max(0,this.a.last-this.s-2*this.q));this.Aa(this.A,this.c[0].scrollTop)}},cb:function(){this.p[0].scrollLeft=this.c[0].scrollLeft},ga:function(a){for(var b=this.J(),d=c(a.target).closest("th"),g=d[0],f=d[0].previousSibling;f&&1!=f.nodeType;)f=f.previousSibling;var p=!f;a=(a.originalEvent.pageX||a.originalEvent.clientX)-d.offset().left;if(b){if(!p&&d.outerWidth()-a<=this.S/2)return f.k;
if(a<=this.S/2)return g.k}else{if(!p&&a<=this.S/2)return f.k;if(d.outerWidth()-a<=this.S/2)return g.k}return null},$a:function(a){if(this.L){var b=this.ga(a);a=c(a.target).closest("th")[0];b&&this.b.get(b).resizable?a.style.cursor="e-resize":a.style.cursor=""}},Za:function(a){c(a.target).closest("th")[0].style.cursor=""},Ta:function(a){if(!this.ga(a)&&(a=c(a.target).closest("th")[0],this.r)){var b=this.b.get(a.k);b&&b.sortable&&this.sort(a.k,void 0,!0)}},bb:function(a){var b=this.ga(a),d;if(b){d=
this.b.get(b);if(!this.L||!d||!d.resizable)return!1;b=this.J();this.i&&c(this.i).remove();this.i=c("<div></div>").addClass(this.jb).css({position:"absolute",display:"block","z-index":-1,visibility:"hidden",width:"2px",background:"#000",opacity:0.7}).appendTo(this.$el);d=d.element;var g=this.i.parent(),f=d.offset(),p=g.offset();8==k&&(f=d.offset());p.left+=parseFloat(g.css("border-left-width"))||0;p.top+=parseFloat(g.css("border-top-width"))||0;f.left-=p.left;f.top-=p.top;f.top-=parseFloat(d.css("border-top-width"))||
0;g=this.i.outerWidth();b?f.left-=Math.ceil((parseFloat(d.css("border-left-width"))||0)/2):(f.left+=d.outerWidth(),f.left+=Math.ceil((parseFloat(d.css("border-right-width"))||0)/2));f.left-=Math.ceil(g/2);b=this.g.height()-(this.g.offset().top-d.offset().top);this.i.css({"z-index":"10",visibility:"visible",left:f.left,top:f.top,height:b})[0].k=d[0].k;try{this.i[0].style.zIndex=""}catch(e){}c(document).on("mousemove",this.va);c(document).on("mouseup",this.ia);a.preventDefault()}else this.B?(b=c(a.target).closest("th"),
(d=this.b.get(b[0].k))&&d.D?(b[0].style.opacity=0.35,this.fa=161061273*Math.random(),a.originalEvent.dataTransfer.setData("text",JSON.stringify({Fa:this.fa,column:d.name}))):a.preventDefault()):a.preventDefault()},ab:function(a){var b=this.b.get(this.i[0].k),d=this.J(),b=b.element,c=this.i.parent(),f=b.offset(),p=c.offset();p.left+=parseFloat(c.css("border-left-width"))||0;f.left-=p.left;c=this.i.outerWidth();a=a.pageX-p.left;f=f.left;d?(f+=b.outerWidth(),f-=Math.ceil((parseFloat(b.css("border-right-width"))||
0)/2),f-=Math.ceil(c/2),f-=this.l,f-=this.I(b[0]),a>f&&(a=f)):(f+=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),f-=Math.ceil(c/2),f+=this.l,f+=this.I(b[0]),a<f&&(a=f));this.i.css("left",a+"px")},Ya:function(a){if(this.i){c(document).off("mousemove",this.va);c(document).off("mouseup",this.ia);var b=this.b.get(this.i[0].k),d=this.J(),g=b.element,f=this.i.parent(),p=g.offset(),e=f.offset();e.left+=parseFloat(f.css("border-left-width"))||0;p.left-=e.left;f=this.i.outerWidth();a=a.pageX-e.left;
p=e=p.left;p=0;d?(a+=this.I(g[0]),e+=g.outerWidth(),e-=Math.ceil((parseFloat(g.css("border-right-width"))||0)/2),e-=Math.ceil(f/2),p=e-this.l,a>p&&(a=p),p=e-a):(a-=this.I(g[0]),e+=Math.ceil((parseFloat(g.css("border-right-width"))||0)/2),e-=Math.ceil(f/2),p=e+this.l,a<p&&(a=p),p=a-e);this.i.remove();this.i=null;d=p;if(b.n==t.RELATIVE){d=this.ra();for(g=0;g<this.d.length;g++)f=this.d[g],f.n!=t.RELATIVE&&(d-=f.j);d=p/d*100;d+="%"}this.setColumnWidth(b.name,d)}else a.target.style.opacity=null},Ua:function(a){if(this.B){var b=
a.originalEvent.dataTransfer.getData("text"),b=b?JSON.parse(b):null;a=c(a.target).closest("th");(!b||this.fa==b.Fa&&a.k!==b.column)&&(b=this.b.get(a[0].k))&&(b.D||b!=this.d[0])&&c(a).addClass("drag-over")}},Wa:function(a){a.preventDefault()},Va:function(a){var b=c(a.target).closest("th");c(b[0].firstChild).has(a.originalEvent.relatedTarget).length||b.removeClass("drag-over")},Xa:function(a){a.preventDefault();var b=JSON.parse(a.originalEvent.dataTransfer.getData("text"));a=c(a.target).closest("th");
if(this.B&&b.Fa==this.fa){var b=b.column,d=a[0].k,g=this.b.get(b),f=this.b.get(d);g&&f&&g.D&&(f.D||f!=this.d[0])&&this.moveColumn(b,d)}c(a).removeClass("drag-over")},sa:function(){if(this.g){var a=this.g.find(">thead>tr>th.sorted"),b=a.find(">div>.sort-arrow");_.forEach(b,_.bind(function(a){if(a=this.b.get(a.parentNode.parentNode.k))a.na=0},this));b.remove();a.removeClass("sorted").removeClass("desc")}return this},Ba:function(a,b){var d=this.b.get(a),g=v("span");g.className="sort-arrow";d.element.addClass(b?
"sorted desc":"sorted");d.element[0].firstChild.insertBefore(g,d.element[0].firstChild.firstChild);d.n!=t.RELATIVE&&this.ca&&(d.na=g.scrollWidth+(parseFloat(c(g).css("margin-right"))||0)+(parseFloat(c(g).css("margin-left"))||0));return this},ib:function(a){var b=this.g.find(">thead>tr>th"),d=this.b.get(b[a].k);if(d){b[a].firstChild.style.width=d.j+"px";for(var b=(d.t||d.j)+"px",d=this.c[0].childNodes,c=this.h?1:0,f=d.length-(this.h?1:0),e;c<f;c++)e=d[c],1===e.nodeType&&(e.childNodes[a].firstChild.style.width=
b);this.X()}return this},Da:function(){this.g&&this.g.find(">thead>tr>th").off("mousemove").off("mouseleave").off("dragstart").off("selectstart").off("click").find(">div").off("dragenter").off("dragover").off("dragleave").off("drop");return this},hb:function(){var a=0;this.M&&(a=parseFloat(this.M.style.height));this.Da().Ea();var b,d,g,f,e,k,n,h,l,m,q=this.da,t=v("tr"),r;s&&(r=function(a){a.preventDefault();this.pb();return!1});for(b=0;b<this.d.length;b++)if(e=this.d[b],e.visible&&(h=v("div"),h.style.width=
e.j+"px",h.innerHTML=this.Ra(e.label,e.name),d=v("th"),d.draggable=!0,this.r&&e.sortable&&(d.className="sortable"),d.k=e.name,q&&this.H(d),d.appendChild(h),t.appendChild(d),this.d[b].element=c(d),c(d).on("mousemove",_.bind(this.$a,this)).on("mouseleave",_.bind(this.Za,this)).on("dragstart",_.bind(this.bb,this)).on("click",_.bind(this.Ta,this)),c(h).on("dragenter",_.bind(this.Ua,this)).on("dragover",_.bind(this.Wa,this)).on("dragleave",_.bind(this.Va,this)).on("drop",_.bind(this.Xa,this)),s))c(d).on("selectstart",
_.bind(r,d));if(this.g&&this.h&&(this.c.off("scroll"),this.g.remove(),this.c))for(r=this.c[0].childNodes,b=0,d=r.length;b<d;b++)this.trigger("rowDestroy",r[b]);"static"==this.$el.css("position")&&this.$el.css("position","relative");this.h||!this.g?(e=document.createDocumentFragment(),b=v("table"),b.className=this.ja,e.appendChild(b),d=v("thead"),d.style.display="block",u&&c(d).css({"float":"rtl"==this.$el.css("direction")?"right":"left",clear:"both"}),b.appendChild(d),this.w||(this.w=this.$el.innerHeight()-
(parseFloat(c(b).css("border-top-width"))||0)-(parseFloat(c(b).css("border-bottom-width"))||0)),r=v("tbody"),r.style.height=this.w-c(d).outerHeight()+"px",r.style.display="block",r.style.overflowY="auto",r.style.overflowX="hidden",u&&c(r).css({"float":"rtl"==this.$el.css("direction")?"right":"left",clear:"both"}),this.Y==w.Width.SCROLL&&(d.style.overflowX="hidden",r.style.overflowX="auto"),b.appendChild(r),this.el.appendChild(e),this.g=c(b),this.c=c(r),this.p=c(d)):(b=this.g[0],r=this.c[0],d=this.p[0]);
this.h&&!this.C&&(h=function(){var a=v("tr");a.appendChild(v("td")).appendChild(v("div")).innerHTML="0";a.style.visibility="hidden";a.style.position="absolute";return a},b=r.appendChild(h()),e=r.appendChild(h()),h=r.appendChild(h()),this.C=c(e).outerHeight(),r.removeChild(b),r.removeChild(e),r.removeChild(h),this.s=parseInt(this.w-c(d).outerHeight()/this.C,10));var x=this.f||this.e,B=!!this.f;this.h&&(this.a&&this.a.last-this.a.first>=this.s?(this.a.u=this.a.u!=this.a.first?this.a.u:this.a.first,
this.a.v=this.a.v!=this.a.last?this.a.v:this.a.last,this.a.last>x.length&&(this.a.last=x.length,this.a.first=Math.max(0,this.a.last-this.s-2*this.q))):(b=this.s+this.q,b>x.length&&(b=x.length),this.a={first:0,last:b,u:0,v:b}));var y=document.createDocumentFragment();this.h&&(l=this.M=document.createElement("tr"),l.style.height=a+"px",y.appendChild(l));var z;this.h?(b=this.a.first,z=this.a.last):(b=0,z=x.length);var A=this.d,C=this.G;k=A.length;for(n=x.length;b<n&&b<z;b++){g=x[b];l=document.createElement("tr");
l._rowIndex=b;for(f=0;f<k;f++)e=A[f],h=document.createElement("div"),h.style.width=e.j+"px",h.innerHTML=C(g[e.name],e.name),m=document.createElement("td"),e.cellClasses&&(m.className=e.cellClasses),q&&this.H(m),m.appendChild(h),l.appendChild(m);y.appendChild(l);this.trigger("rowCreate",b,B?g.__i:b,l,g)}this.h&&(l=this.ma=document.createElement("tr"),l.style.height=this.C*Math.max(0,x.length-this.s-this.q)-a+"px",y.appendChild(l));try{d.innerHTML=""}catch(D){d.textContent=""}d.appendChild(t);this.h&&
(r.style.height=this.w-c(d).outerHeight()+"px");try{r.innerHTML=""}catch(E){r.textContent=""}r.appendChild(y);this.W(!0);this.h&&this.F();return this},W:function(a){var b=this.c[0].offsetWidth-this.c[0].clientWidth;if(b!=this.T||a){this.T=b;for(a=0;a<this.b.length;a++)this.b[a].t=null;if(0<this.T){b=this.d.length-1;this.d[b].t=this.d[b].j-this.T;var d=this.d[b].t+"px",c=this.c[0].childNodes;a=this.h?1:0;for(var f=c.length-(this.h?1:0),e;a<f;a++)e=c[a],1===e.nodeType&&(e.childNodes[b].firstChild.style.width=
d)}}return this},Aa:function(a,b){var d,c,f=this.a.last-this.a.first-(this.a.v-this.a.u),e=this.s+this.q;if(b<a)d=this.a.first,c=this.a.u,this.a.last<=this.a.u&&(d=this.a.first,c=this.a.last),this.a.u=this.a.first,this.a.v=this.a.last,this.za(c-d-f,!1),this.ba(d,c,!0),this.F();else if(b>a)d=this.a.v,c=this.a.last,this.a.first>=this.a.v&&(d=this.a.first,c=this.a.last),this.a.u=this.a.first,this.a.v=this.a.last,this.za(c-d-f,!0),this.ba(d,c,!1),this.F();else if(this.R)this.R=!1,c=this.f||this.e,this.a.last<
c.length&&this.a.last<e&&(d=this.a.last,c=c.length,c>e&&(c=e),this.ba(d,c,!1),this.a.last=c),this.F();else{this.F();this.eb(this.a.first);return}this.W();this.X();this.A=this.c[0].scrollTop},F:function(){var a=((this.f||this.e).length-(this.c[0].childNodes.length-2))*this.C;if(0>a)this.M.style.height=0,this.ma.style.height=0;else{var b=this.a.first*this.C;this.M.style.height=b+"px";this.ma.style.height=a-b+"px"}},ba:function(a,b,d){if(d)for(d=this.M.nextSibling;d&&1!=d.nodeType;)d=d.nextSibling;else d=
this.ma;for(;a<b;a++)this.Ma(a,d)},Ma:function(a,b){var d=document.createElement("tr");d._rowIndex=a;for(var c=(this.f||this.e)[a],f=!!this.f,e=this.da,k=this.d,n=this.G,h=0,l,m,q,u=k.length;h<u;h++)l=k[h],m=document.createElement("div"),m.style.width=(l.t||l.j)+"px",m.innerHTML=n(c[l.name],l.name),q=document.createElement("td"),l.cellClasses&&(q.className=l.cellClasses),e&&this.H(q),q.appendChild(m),d.appendChild(q);this.c[0].insertBefore(d,b);this.trigger("rowCreate",a,f?c.__i:a,d,c)},za:function(a,
b){var d,c;a>this.s+2*this.q&&(a=this.s+2*this.q);var f=this.c[0],e=f.childNodes;c=this.c[0].childNodes.length-2;b?(d=1,c=Math.min(a+1,c+1)):(d=c+1-a,c+=1);for(var k=d;k<c;c--)this.kb(e[d]),this.trigger("rowDestroy",e[d]),f.removeChild(e[d])},eb:function(a){for(var b=this.c[0].getElementsByTagName("tr"),d=this.f||this.e,e=!!this.f,f,k=this.d,h=this.G,n=1,u,l,m,q,s,r=b.length-1;n<r;n++){u=b[n];this.trigger("rowDestroy",u);u._rowIndex=f=a+n-1;f=d[f];l=c("td>div",u);for(m=0;m<l.length;m++)q=l[m],s=k[m],
s=s.name,q.innerHTML=h(f[s],s);this.trigger("rowCreate",n,e?f.__i:n,u,f)}},X:function(){if(this.Y==w.Width.AUTO){for(var a=this.g.find(">thead>tr>th"),b=0,d=0;d<a.length;d++)b+=c(a[d])[0].offsetWidth;this.g.width(b);this.$el.width(b)}else if(this.Y==w.Width.SCROLL)if(a=this.$el.innerWidth(),b=this.g.width(),d=this.p[0].scrollWidth,this.c.off("scroll",this.wa),d>b||d>a)this.p.width(a),this.c.width(a),this.c.on("scroll",this.wa);else{try{this.p[0].style.width=""}catch(e){}try{this.c[0].style.width=
""}catch(f){}}return this},J:function(){return"rtl"==this.g.css("direction")},U:function(a){return a.n==t.AUTO?"auto":a.n==t.RELATIVE?100*a.width+"%":a.width},Pa:function(a){this.qa=!1;if(a.firstChild.scrollWidth>a.firstChild.clientWidth){this.ta();var b=c(a),d=c(a.firstChild),e=v("div"),f=c(e);e.className=this.Qa;"TH"==a.tagName&&(e.className+=" header");var k=parseFloat(b.css("padding-left"))||0,h=parseFloat(b.css("padding-right"))||0,n=parseFloat(b.css("padding-top"))||0,u=parseFloat(b.css("padding-bottom"))||
0,l=a.firstChild.scrollWidth+a.clientWidth-a.firstChild.offsetWidth,m=a.firstChild.scrollHeight+a.clientHeight-a.firstChild.offsetHeight;"border-box"===b.css("boxSizing")?(l-=parseFloat(c(a).css("border-left-width"))||0,l-=parseFloat(c(a).css("border-right-width"))||0,m-=parseFloat(c(a).css("border-top-width"))||0,m-=parseFloat(c(a).css("border-bottom-width"))||0,f.css("box-sizing","border-box")):(l-=k+h,m-=n+u,f.css({"margin-top":parseFloat(c(a).css("border-top-width"))||0}));if(!this.ka){var q=
document.createElement("div");q.style.backgroundColor="transparent";this.ka=c(q).css("background-color");q.style.backgroundColor="rgba(0,0,0,0)";this.Ca=c(q).css("background-color")}q=c(a).css("background-color");if(q==this.ka||q==this.Ca)q=c(a.parentNode).css("background-color");if(q==this.ka||q==this.Ca)q="#fff";f.css({width:l+"px",height:m+"px","padding-left":k,"padding-right":h,"padding-top":n,"padding-bottom":u,overflow:"hidden",position:"absolute",zIndex:"-1",left:"0",top:"0","background-color":q,
cursor:"default"});e.innerHTML=a.innerHTML;document.body.appendChild(e);e.firstChild.style.width=e.clientWidth-a.clientWidth+parseFloat(a.firstChild.style.width)+"px";e.firstChild.style.direction=d.css("direction");e.firstChild.style.whiteSpace=d.css("white-space");d=e.__row=a.parentNode._rowIndex;e.__column=this.d[_.indexOf(a.parentNode.childNodes,a)].name;this.trigger("cellPreview",e.firstChild,null==d?null:d,e.__column,null==d?null:(this.f||this.e)[d]);this.qa||(d=b.offset(),this.J()?(k=f.outerWidth(),
b=b.outerWidth(),d.left-=k-b):d.left+=parseFloat(c(a).css("border-left-width"))||0,d.top+=parseFloat(c(a).css("border-top-width"))||parseFloat(c(a).css("border-bottom-width"))||0,f.css({left:d.left,top:d.top,"z-index":9999,zIndex:9999}),e.__cell=a,this.P=f,a.__previewEl=e,this.ha(a),this.ha(e))}},Oa:function(){this.ta()},ta:function(){if(this.P){var a=this.P[0];this.P.remove();this.la(a.__cell);this.la(a);a.__cell.__previewEl=null;a.__cell=null;this.trigger("cellPreviewDestroy",a.firstChild,a.__row,
a.__column);this.P=null}return this}}),t={AUTO:0,ABSOLUTE:1,RELATIVE:2};w.Width={NONE:"none",AUTO:"auto",SCROLL:"SCROLL"};h.DGTable=w})(this,jQuery);
DGTable.Ka=function(){function h(){var c=[];_.extend(c,h.prototype);c.initialize.apply(c,arguments);return c}h.prototype=[];h.prototype.initialize=function(){};h.prototype.get=function(c){for(var e=0,k=this.length;e<k;e++)if(this[e].name==c)return this[e];return null};h.prototype.indexOf=function(c){for(var e=0,k=this.length;e<k;e++)if(this[e].name==c)return e;return-1};h.prototype.aa=function(c){for(var e=0,k=this.length;e<k;e++)if(this[e].order==c)return this[e];return null};h.prototype.pa=function(){var c=
[],e;for(e=0;e<this.length;e++)c.push(this[e]);c.sort(function(c,e){return c.order<e.order?-1:c.order>e.order?1:0});for(e=0;e<c.length;e++)c[e].order=e};h.prototype.O=function(){for(var c=[],e=0,k;e<this.length;e++)k=this[e],k.visible&&c.push(k);c.sort(function(c,e){return c.order<e.order?-1:c.order>e.order?1:0});return c};h.prototype.Ha=function(){for(var c=0,e=0,k;e<this.length;e++)k=this[e],k.order>c&&(c=k.order);return c};h.prototype.moveColumn=function(c,e){if(c&&e){var k=c.order,h=e.order,s;
if(k<h)for(k+=1;k<=h;k++)s=this.aa(k),s.order--;else for(k-=1;k>=h;k--)s=this.aa(k),s.order++;c.order=h}return this};return h}();
DGTable.La=function(){function h(){var c=[];_.extend(c,h.prototype);c.initialize.apply(c,arguments);return c}h.prototype=[];_.extend(h.prototype,Backbone.Events);h.prototype.initialize=function(c){c=c||{};this.Z=this.N=null;this.oa=!1;this.sortColumn=null==c.sortColumn?[]:c.sortColumn};h.prototype.add=function(c,e){var k,h;if("splice"in c&&"length"in c)if(e)for(k=0,h=c.length;k<h;k++)this.splice(e++,0,c[k]);else for(k=0,h=c.length;k<h;k++)this.push(c[k]);else e?this.splice(e,0,c):this.push(c)};h.prototype.reset=
function(c){this.length=0;c&&this.add(c)};h.prototype.Ga=function(c,e,k){if((e=e.toString())&&null!=c){var u=new h({sortColumn:this.sortColumn});this.N=c;this.Z=e;this.oa=k;e=c=0;k=this.length;for(var s;e<k;e++)s=this[e],this.mb(s)&&(s.__i=c++,u.push(s));return u}return this.Z=this.N=null};h.prototype.mb=function(c){if(c&&this.N){c=c[this.N];if(null==c)return!1;c=c.toString();var e=this.Z;this.oa||(c=c.toUpperCase(),e=e.toUpperCase());return-1!==c.indexOf(e)}return!0};(function(){function c(c,e){var h=
e?1:-1,v=e?-1:1;return function(e,u){var a=e[c],b=u[c];return a<b?h:a>b?v:0}}var e=h.prototype.sort;h.prototype.sort=function(k){if(this.sortColumn.length){var h=[],s,v;for(s=0;s<this.sortColumn.length;s++)v={},this.trigger("requiresComparatorForColumn",v,this.sortColumn[s].column,this.sortColumn[s].descending),h.push(_.bind(v.lb||c(this.sortColumn[s].column,this.sortColumn[s].descending),this));if(1===h.length)e.call(this,h[0]);else{var w=h.length,t;e.call(this,function(a,b){for(s=0;s<w&&(t=h[s](a,
b),0===t);s++);return t})}k||this.trigger("sort")}return this}})();return h}();
//# sourceMappingURL=DGTable.min.js.map