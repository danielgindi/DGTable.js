'use strict';(function(l,e){function g(a){_.contains(["relative","absolute","fixed"],a.css("position"))||a.css("position","relative")}var h=navigator.userAgent,m=-1!=h.indexOf("MSIE ")?parseFloat(h.substr(h.indexOf("MSIE ")+5)):null,t=m&&10>m,r=_.bind(document.createElement,document),u=Backbone.View.extend({className:"dgtable-wrapper",tagName:"div",VERSION:"0.3.0",initialize:function(a){function b(a){a=a||event;a=a.toElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==
this.__previewEl||jQuery.contains(this.__previewEl,a))||g.Ta.call(g,this)}function c(a){a=a||event;a=a.fromElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||g.Ua.call(g,this)}a=a||{};a.columns=a.columns||[];this.Ca=_.bind(this.ab,this);this.da=_.bind(this.Za,this);this.Ea=_.bind(this.bb,this);this.$el.on("dragend",this.da);this.o=!0;this.j=void 0===a.virtualTable?!0:!!a.virtualTable;this.m=Math.max(a.minColumnWidth||
35,0);this.R=a.resizeAreaWidth||8;this.K=void 0===a.resizableColumns?!0:!!a.resizableColumns;this.A=void 0===a.movableColumns?!0:!!a.movableColumns;this.r=void 0===a.sortableColumns?1:parseInt(a.sortableColumns,10)||1;this.Y=void 0===a.adjustColumnWidthForSortArrow?!0:!!a.adjustColumnWidthForSortArrow;this.ra=void 0===a.convertColumnWidthsToRelative?!1:!!a.convertColumnWidthsToRelative;this.Sa=void 0===a.cellClasses?"":a.cellClasses;this.ib=void 0===a.resizerClassName?"dgtable-resize":a.resizerClassName;
this.f=void 0===a.tableClassName?"dgtable":a.tableClassName;this.ma=void 0===a.allowCellPreview?!0:a.allowCellPreview;this.Ra=void 0===a.allowHeaderCellPreview?!0:a.allowHeaderCellPreview;this.q=void 0===a.cellPreviewClassName?"dgtable-cell-preview":a.cellPreviewClassName;this.P=void 0===a.comparatorCallback?null:a.comparatorCallback;this.L=void 0===a.width?u.Width.NONE:a.width;this.eb=void 0===a.relativeWidthGrowsToFillWidth?!0:!!a.relativeWidthGrowsToFillWidth;this.fb=void 0===a.relativeWidthShrinksToFillWidth?
!1:!!a.relativeWidthShrinksToFillWidth;this.pa=a.cellFormatter||function(a){return a};this.Wa=a.headerCellFormatter||function(a){return a};var f,d,e,s,k=new u.Pa;for(s=f=0;f<a.columns.length;f++)d=a.columns[f],e=this.ua(d),void 0!==d.order?(d.order>s&&(s=d.order+1),e.order=d.order):e.order=s++,k.push(e);k.ja();this.a=k;this.b=k.N();if(void 0===a.sortColumn)a.sortColumn=null;else if("string"==typeof a.sortColumn)this.a.get(a.sortColumn)?a.sortColumn=[{column:a.sortColumn,descending:!1}]:a.sortColumn=
null;else if(a.sortColumn instanceof Array){s=[];f=0;d=a.sortColumn.length;for(e;f<d&&(e=a.sortColumn[f],e=void 0!==e.column?e:{column:e,descending:!1},(e=this.a.get(e.column))&&!_.contains(s,e.name)&&s.push(e.name),s.length!=this.r&&s.length!=this.b.length);f++);a.sortColumn=s}else"object"==typeof a.sortColumn?this.a.get(a.sortColumn.column)||(a.sortColumn=null):a.sortColumn=null;this.c=new u.Qa({sortColumn:a.sortColumn,columns:this.columns});this.listenTo(this.c,"sort",this.render).listenTo(this.c,
"requiresComparatorForColumn",_.bind(function(a,b,c){this.P&&(a.kb=this.P(b,c))},this));this.d=null;this.v=a.height;var g=this;"addEventListener"in window?(this.ba=function(a){a.__hoverIn||a.addEventListener("mouseover",a.__hoverIn=_.bind(c,a));return this},this.T=function(a){a.__hoverIn&&(a.removeEventListener("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ca=function(a){a.__hoverOut||a.addEventListener("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.fa=function(a){a.__hoverOut&&
(a.removeEventListener("mouseout",a.__hoverOut),a.__hoverOut=null);return this}):(this.ba=function(a){a.__hoverIn||a.attachEvent("mouseover",a.__hoverIn=_.bind(c,a));return this},this.T=function(a){a.__hoverIn&&(a.detachEvent("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.ca=function(a){a.__hoverOut||a.attachEvent("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.fa=function(a){a.__hoverOut&&(a.detachEvent("mouseout",a.__hoverOut),a.__hoverOut=null);return this})},Fa:function(a){var b=
parseFloat(a),c=p.AUTO;0<b&&(a==b+"%"?(c=p.RELATIVE,b/=100):0<b&&1>b?c=p.RELATIVE:(b<this.m&&(b=this.m),c=p.ABSOLUTE));return{width:b,mode:c}},ua:function(a){var b=this.Fa(a.width);return{name:a.name,label:void 0===a.label?a.name:a.label,width:b.width,n:b.mode,resizable:void 0===a.resizable?!0:a.resizable,sortable:void 0===a.sortable?!0:a.sortable,F:void 0===a.F?!0:a.F,visible:void 0===a.visible?!0:a.visible,cellClasses:void 0===a.cellClasses?this.Sa:a.cellClasses}},close:function(){this.g&&(this.g.remove(),
this.g=null);if(this.l)for(var a=this.l[0].childNodes,b=0,c=a.length;b<c;b++)this.trigger("rowdestroy",a[b]);this.remove();this.Ia().Ja();this.h.unbind();this.l.unbind();this.$el.unbind();this.unbind();if(this.p){for(a=0;a<this.p.length;a++)b=this.p[a],b.Oa.removeEventListener("message",b.Na,!1);this.p.length=0}this.c.length=this.a.length=0;for(var f in this)this.hasOwnProperty(f)&&(this[f]=null)},Ja:function(){if(this.ka)for(var a=0,b=this.ka[0].childNodes,c=b.length,f;a<c;a++){f=b[a];var d=0;f=
f.childNodes;for(var e=f.length;d<e;d++)this.T(f[d])}if(this.l)for(a=0,b=this.l[0].childNodes,c=b.length;a<c;a++)for(f=b[a],d=0,f=f.childNodes,e=f.length;d<e;d++)this.T(f[d]);return this},pb:function(a){var b=0;a=a.childNodes;for(var c=a.length;b<c;b++)this.T(a[b]);return this},render:function(){if(!0===this.o){this.o=!1;this.L==u.Width.AUTO&&this.qa();var a=this.e?this.e.scrollTop:0,b=this.e?this.e.scrollLeft:0;this.tableWidthChanged(!0,!1).gb();if(!this.j){var c=(this.d||this.c).length,f=this.W(0,
c-1);this.l.html("").append(f);this.C(!0)}this.e.scrollTop=a;this.e.scrollLeft=b;this.Q.scrollLeft=b;this.w(!0);for(f=0;f<this.c.sortColumn.length;f++)this.Ga(this.c.sortColumn[f].column,this.c.sortColumn[f].descending);this.Y&&this.c.sortColumn.length&&this.tableWidthChanged(!0);this.trigger("renderskeleton");this.j&&(this.h.on("scroll",_.bind(this.cb,this)),this.render())}else if(this.j){c=(this.d||this.c).length;b=this.e.scrollTop;a=Math.floor((b-this.D)/this.s)+1;b=Math.ceil((b-this.D+this.jb)/
this.s);0>a&&(a=0);b>=c&&(b=c-1);var d=-1,c=-1,e=this.i.childNodes;e.length&&(d=e[0].rowIndex,c=e[e.length-1].rowIndex);if(-1!==d&&d<a){for(var s=Math.min(c+1,a)-d,f=0;f<s;f++)this.trigger("rowdestroy",e[0]),this.i.removeChild(e[0]);d+=s;d>c&&(d=c=-1)}else if(-1!==c&&c>b){s=c-Math.max(d-1,b);for(f=0;f<s;f++)this.trigger("rowdestroy",e[e.length-1]),this.i.removeChild(e[e.length-1]);c<d&&(d=c=-1)}a<d&&(f=this.W(a,Math.min(b,d-1)),this.l.prepend(f));if(b>c||-1===c)f=this.W(-1===c?a:c+1,b),this.l.append(f)}this.trigger("render");
return this},W:function(a,b){var c=this.f,f=c+"-row",c=c+"-cell",d=this.d||this.c,e=!!this.d,s=this.ma,k=this.b,g=this.pa,h=this.j,n=this.D,l=this.s,m,t=k.length;m=0;for(var p;m<t;m++)p=k[m],p.Va=p.t||p.k;for(var u=document.createDocumentFragment(),D="rtl"===this.$el.css("direction")?"right":"left",v=a,E=d.length,z,w,x,C;v<E&&v<=b;v++){z=d[v];w=r("div");w.className=f;w.rowIndex=v;for(m=0;m<t;m++)p=k[m],x=r("div"),x.columnName=p.name,x.className=c,x.style.width=p.Va+"px",p.cellClasses&&(x.className+=
" "+p.cellClasses),s&&this.ba(x),C=x.appendChild(r("div")),C.innerHTML=g(z[p.name],p.name,z),w.appendChild(x);h&&(m=0<v?n+(v-1)*l:0,w.style.position="absolute",w.style[D]=0,w.style.top=m+"px");u.appendChild(w);this.trigger("rowcreate",v,e?z.__i:v,w,z)}return u},G:function(){if(this.i){var a=(this.d||this.c).length,b=this.s*a;a&&(b+=this.D-this.s,b+=this.ga-this.s);this.i.style.height=b+"px"}return this},na:function(){var a=this.f,b=a+"-row",c=a+"-cell",f=this.b,d=f.length,y,g,k,b=e("<div>").addClass(b).css("float",
"left");for(g=0;g<d;g++)k=f[g],y=r("div"),y.className=c,y.style.width=k.k+"px",k.cellClasses&&(y.className+=" "+k.cellClasses),y.appendChild(r("div")),b.append(y);a=e("<div>").addClass(this.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px","float":"left",width:"1px",overflow:"hidden"}).append(e("<div>").addClass(a).append(e("<div>").addClass(a+"-body").css("width",99999).append(b)));a.appendTo(document.body);c=b.outerWidth();c-=this.B||0;a.remove();return c},addColumn:function(a,
b){if(a&&!this.a.get(a.name)){var c=null;void 0!==b&&(c=this.a.get(b)||this.a.V(b));var f=this.ua(a);f.order=c?c.order:this.a.Ma()+1;for(var c=this.a.Ma(),d=f.order,e;c>=d;c--)(e=this.a.V(c))&&e.order++;this.a.push(f);this.a.ja();this.o=!0;this.b=this.a.N();this.render();this.trigger("addColumn",f.name)}return this},removeColumn:function(a){var b=this.a.indexOf(a);-1<b&&(this.a.splice(b,1),this.a.ja(),this.o=!0,this.b=this.a.N(),this.render(),this.trigger("removeColumn",a));return this},filter:function(a,
b,c){if(this.a.get(a)){var f=!!this.d;this.d&&(this.d=null);this.d=this.c.La(a,b,c);if(f||this.d)this.o=!0,this.j&&this.G(),this.render(),this.trigger("filter",a,b,c)}return this},J:function(){this.d&&(this.d=null,this.d=this.c.La(this.c.M,this.c.U,this.c.ia));return this},setColumnLabel:function(a,b){var c=this.a.get(a);if(c&&(c.label=void 0===b?c.name:b,c.element))for(var f=0;f<c.element[0].firstChild.childNodes.length;f++){var d=c.element[0].firstChild.childNodes[f];if(3===d.nodeType){d.textContent=
c.label;break}}return this},moveColumn:function(a,b){var c,f;"string"===typeof a?c=this.a.get(a):"number"===typeof a&&(c=this.b[a]);"string"===typeof b?f=this.a.get(b):"number"===typeof b&&(f=this.b[b]);if(c&&f&&a!==b){var d=c.order,e=f.order;this.b=this.a.moveColumn(c,f).N();if(this.j)this.o=!0,this.render().C(!0);else{var g=this.u.find(">div."+this.f+"-header-cell");f=d<e?e+1:e;g[0].parentNode.insertBefore(g[d],g[f]);for(var g=this.b[d],g=(g.t||g.k)+"px",k=this.b[e],k=(k.t||k.k)+"px",h=this.l[0].childNodes,
q=0,n=h.length,m;q<n;q++)m=h[q],1===m.nodeType&&(m.insertBefore(m.childNodes[d],m.childNodes[f]),m.childNodes[e].firstChild.style.width=k,m.childNodes[d].firstChild.style.width=g)}this.trigger("moveColumn",c.name,d,e)}return this},sort:function(a,b,c){var f=this.a.get(a);if(f){var d=this.c.sortColumn;d.length&&d[d.length-1].column==a&&(b=void 0===b?!d[d.length-1].descending:b);if(c){for(a=0;a<d.length;a++)if(d[a].column==f.name){a<d.length-1?d.length=0:d.splice(d.length-1,1);break}if(0<this.r&&d.length>=
this.r||d.length>=this.b.length)d.length=0}else d.length=0;d.push({column:f.name,descending:!(void 0===b||!b)});this.c.sortColumn=d;this.qa();for(a=0;a<d.length;a++)this.Ga(d[a].column,d[a].descending);this.Y&&this.tableWidthChanged(!0);if(this.j)for(;this.i.firstChild;)this.trigger("rowdestroy",this.i.firstChild),this.i.removeChild(this.i.firstChild);else this.o=!0;this.c.sort(!!this.d);this.J();this.d&&this.render();b=[];for(a=0;a<d.length;a++)b.push({column:d[a].column,descending:d[a].descending});
this.trigger("sort",b)}return this},setColumnVisible:function(a,b){var c=this.a.get(a);c&&!!c.visible!=!!b&&(c.visible=!!b,this.o=!0,this.b=this.a.N(),this.render(),this.trigger(b?"showColumn":"hideColumn",a));return this},isColumnVisible:function(a){return(a=this.a.get(a))?a.visible:!1},setMinColumnWidth:function(a){a=Math.max(a,0);this.m!=a&&(this.m=a,this.tableWidthChanged(!0));return this},getMinColumnWidth:function(){return this.m},setSortableColumns:function(a){if(this.r!=a&&(this.r=a,this.h)){a=
this.u.find(">div."+this.f+"-header-cell");for(var b=0;b<a.length;b++)e(a[0])[0<this.r&&this.b[b].sortable?"addClass":"removeClass"]("sortable")}return this},getSortableColumns:function(){return this.r},setMovableColumns:function(a){a=!!a;this.A!=a&&(this.A=a);return this},getMovableColumns:function(){return this.A},setResizableColumns:function(a){a=!!a;this.K!=a&&(this.K=a);return this},getResizableColumns:function(){return this.K},setComparatorCallback:function(a){this.P!=a&&(this.P=a);return this},
setColumnWidth:function(a,b){var c=this.Fa(b),f=this.a.get(a);if(f){var d=this.S(f);f.width=c.width;f.n=c.mode;c=this.S(f);d!=c&&this.tableWidthChanged(!0);this.trigger("setColumnWidth",f.name,d,c)}return this},getColumnWidth:function(a){return(a=this.a.get(a))?this.S(a):null},getColumnConfig:function(a){return(a=this.a.get(a))?{order:a.order,width:this.S(a),visible:a.visible}:null},getColumnsConfig:function(){for(var a={},b=0;b<this.a.length;b++)a[this.a[b].name]=this.getColumnConfig(this.a[b]);
return a},getSortedColumns:function(){for(var a=[],b=0,c;b<this.c.sortColumn.length;b++)c=this.c.sortColumn[b],a.push({column:c.column,descending:c.descending});return a},getHtmlForCell:function(a,b){if(0>a||a>this.c.length-1||!this.a.get(b))return null;var c=this.c[a];return this.pa(c[b],b,c)},getDataForRow:function(a){return 0>a||a>this.c.length-1?null:this.c[a]},getDataForFilteredRow:function(a){return 0>a||a>(this.d||this.c).length-1?null:(this.d||this.c)[a]},H:function(a){return(parseFloat(e.css(a,
"padding-left"))||0)+(parseFloat(e.css(a,"padding-right"))||0)},Xa:function(a){return(parseFloat(e.css(a,"border-left"))||0)+(parseFloat(e.css(a,"border-right"))||0)},oa:function(){var a,b,c;this.h&&(b=this.e?this.e.scrollTop:0,c=this.e?this.e.scrollLeft:0,a=this.h[0].style.display,this.h[0].style.display="none");var f=this.$el.width();this.h&&(this.h[0].style.display=a,this.e.scrollTop=b,this.e.scrollLeft=c,this.Q.scrollLeft=c);var d;b=this.f;if(this.h)c=this.u;else{d=e("<div>").addClass(this.className).css({"z-index":-1,
position:"absolute",left:"0",top:"-9999px"});a=e("<div>").addClass(b+"-header").appendTo(d);c=e("<div>").addClass(b+"-header-row").appendTo(a);for(a=0;a<this.b.length;a++)c.append(e("<div><div></div></div>").addClass(b+"-header-cell"));d.appendTo(document.body)}f-=this.Xa(c[0]);b=c.find(">div."+b+"-header-cell");a=0;for(var g;a<b.length;a++)e(b[a].firstChild),c=e(b[a]),g="border-box"===c.css("boxSizing"),f-=(parseFloat(c.css("border-right-width"))||0)+(parseFloat(c.css("border-left-width"))||0)+(g?
0:this.H(c[0]));d&&d.remove();return f},tableWidthChanged:function(){var a=null;return function(b,c){var f=this.oa(),d=f,g=0;c=void 0===c||c;var h=0;c&&(h=parseFloat(this.i.style.minWidth)||0);if(d!=a||b){a=f;var k,f=0,m=[],q,n,l=0;for(q=0;q<this.a.length;q++)this.a[q].t=null;for(q=0;q<this.b.length;q++)if(n=this.b[q],n.n==p.ABSOLUTE)k=n.width,k+=n.ha||0,k<this.m&&(k=this.m),d-=k,f+=k,k!==n.k&&(n.k=k,m.push(q));else if(n.n==p.AUTO){var t=n.label,r=this.f;k=void 0;t=e("<div>").addClass(this.$el).append(e("<div>").addClass(r+
"-header").append(e("<div>").addClass(r+"-header-row").append(k=e("<div>").addClass(r+"-header-cell").append(e("<div>").text(t))))).css({position:"absolute",top:"-9999px",visibility:"hidden"});t.appendTo(document.body);k=k.width();t.remove();k+=20;k+=n.ha||0;k<this.m&&(k=this.m);d-=k;f+=k;k!==n.k&&(n.k=k,this.ra||m.push(q))}else n.n==p.RELATIVE&&(l+=n.width,g++);if(this.ra)for(q=0;q<this.b.length;q++)n=this.b[q],n.n===p.AUTO&&(n.n=p.RELATIVE,d+=n.k,n.width=n.k/f,l+=n.width,g++);if(g&&(1>l&&this.eb||
1<l&&this.fb))for(q=0;q<this.b.length;q++)n=this.b[q],n.n===p.RELATIVE&&(n.width/=l);f=d;for(q=0;q<this.b.length;q++)n=this.b[q],n.n===p.RELATIVE&&(k=Math.round(f*n.width),k<this.m&&(k=this.m),d-=k,g--,0===g&&1===d&&(k++,d--),-1===d&&(k--,d++),k!==n.k&&(n.k=k,m.push(q)));this.b[this.b.length-1].t=this.b[this.b.length-1].k-(this.B||0);if(c){d=this.na();h<d&&this.w(!1);for(q=0;q<m.length;q++)this.hb(m[q]);h>d&&this.w(!1)}}return this}}(),tableHeightChanged:function(){var a=this.$el.innerHeight()-(parseFloat(this.h.css("border-top-width"))||
0)-(parseFloat(this.h.css("border-bottom-width"))||0);a!=this.v&&(this.v=a,this.l&&(this.l[0].style.height=this.v-this.ka.outerHeight()+"px"),this.j&&(this.o=!0,this.render()));return this},addRows:function(a){if(a){this.c.add(a);if(this.j){for(;this.i.firstChild;)this.trigger("rowdestroy",this.i.firstChild),this.i.removeChild(this.i.firstChild);this.d&&this.J();this.G().C().w(!1);this.render()}else if(this.d){var b=this.d.length;this.J();this.d&&this.d.length==b||(this.o=!0,this.render())}else this.l&&
(b=this.c.length-a.length,b=this.W(b,b+a.length-1),this.i.appendChild(b),this.C().w(!0));this.trigger("addrows",a.length,!1)}return this},removeRow:function(a,b){if(0>a||a>this.c.length-1)return null;this.c.splice(a,1);b=void 0===b?!0:!!b;if(this.d)this.d=this.J(),this.o=!0,b&&this.render();else if(b){for(var c=this.i.childNodes,f=0;f<c.length&&(c[f].rowIndex!==a||(this.trigger("rowdestroy",c[f]),this.i.removeChild(c[f]),this.j));f++)f--;this.j?this.G().C().render().w(!1):this.render().C().w(!0)}return this},
setRows:function(a){this.scrollTop=this.$el.find(".table").scrollTop();this.c.reset(a);this.J();this.o=!0;this.j&&this.G();this.render().trigger("addRows",a.length,!0);return this},getUrlForElementContent:function(a){if(a=document.getElementById(a)){a=a.textContent;if("function"===typeof Blob)a=new Blob([a]);else{var b=l.BlobBuilder||l.WebKitBlobBuilder||l.ob||l.nb;if(!b)return null;b=new b;b.append(a);a=b.getBlob()}return(l.URL||l.webkitURL).createObjectURL(a)}return null},isWorkerSupported:function(){return l.Worker instanceof
Function},createWebWorker:function(a,b){if(this.isWorkerSupported()){var c=this,f=new Worker(a),d=function(a){a.data.append?c.addRows(a.data.rows):c.setRows(a.data.rows)};f.addEventListener("message",d,!1);this.p||(this.p=[]);this.p.push({Oa:f,Na:d});(b||void 0===b)&&f.postMessage(null);return f}return null},unbindWebWorker:function(a){if(this.p)for(var b=0;b<this.p.length;b++)this.p[b].Oa==a&&(a.removeEventListener("message",this.p[b].Na,!1),this.p.splice(b,1),b--);return this},abortCellPreview:function(){this.la=
!0;return this},cb:function(){this.render()},bb:function(){this.Q.scrollLeft=this.e.scrollLeft},aa:function(a){var b=this.I(),c=e(a.target).closest("div."+this.f+"-header-cell,div."+this.q),f=c[0];f.__cell&&(f=f.__cell,c=e(f));for(var d=c[0].previousSibling;d&&1!=d.nodeType;)d=d.previousSibling;var g=!d;a=(a.originalEvent.pageX||a.originalEvent.clientX)-c.offset().left;if(b){if(!g&&c.outerWidth()-a<=this.R/2)return d.columnName;if(a<=this.R/2)return f.columnName}else{if(!g&&a<=this.R/2)return d.columnName;
if(c.outerWidth()-a<=this.R/2)return f.columnName}return null},$a:function(a){this.Ya=a},Ba:function(a){if(this.K){var b=this.aa(a);a=e(a.target).closest("div."+this.f+"-header-cell,div."+this.q)[0];b&&this.a.get(b).resizable?a.style.cursor="e-resize":a.style.cursor=""}},Aa:function(a){e(a.target).closest("div."+this.f+"-header-cell,div."+this.q)[0].style.cursor=""},va:function(a){if(!this.aa(a)&&(a=e(a.target).closest("div."+this.f+"-header-cell,div."+this.q)[0],this.r)){var b=this.a.get(a.columnName);
b&&b.sortable&&this.sort(a.columnName,void 0,!0)}},Da:function(a){var b=this.aa(this.Ya||a),c;if(b){c=this.a.get(b);if(!this.K||!c||!c.resizable)return!1;b=this.I();this.g&&e(this.g).remove();this.g=e("<div></div>").addClass(this.ib).css({position:"absolute",display:"block","z-index":-1,visibility:"hidden",width:"2px",background:"#000",opacity:0.7}).appendTo(this.$el);c=c.element;var f=this.g.parent(),d=c.offset(),g=f.offset();8===m&&(d=c.offset());g.left+=parseFloat(f.css("border-left-width"))||
0;g.top+=parseFloat(f.css("border-top-width"))||0;d.left-=g.left;d.top-=g.top;d.top-=parseFloat(c.css("border-top-width"))||0;f=this.g.outerWidth();b?d.left-=Math.ceil((parseFloat(c.css("border-left-width"))||0)/2):(d.left+=c.outerWidth(),d.left+=Math.ceil((parseFloat(c.css("border-right-width"))||0)/2));d.left-=Math.ceil(f/2);this.g.css({"z-index":"10",visibility:"visible",left:d.left,top:d.top,height:this.$el.height()})[0].columnName=c[0].columnName;try{this.g[0].style.zIndex=""}catch(h){}e(document).on("mousemove",
this.Ca);e(document).on("mouseup",this.da);a.preventDefault()}else this.A?(b=e(a.target).closest("div."+this.f+"-header-cell,div."+this.q),(c=this.a.get(b[0].columnName))&&c.F?(b[0].style.opacity=0.35,this.Z=161061273*Math.random(),a.originalEvent.dataTransfer.setData("text",JSON.stringify({Ka:this.Z,column:c.name}))):a.preventDefault()):a.preventDefault()},ab:function(a){var b=this.a.get(this.g[0].columnName),c=this.I(),b=b.element,f=this.g.parent(),d=b.offset(),e=f.offset();e.left+=parseFloat(f.css("border-left-width"))||
0;d.left-=e.left;f=this.g.outerWidth();a=a.pageX-e.left;d=d.left;c?(d+=b.outerWidth(),d-=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),d-=Math.ceil(f/2),d-=this.m,d-=this.H(b[0]),a>d&&(a=d)):(d+=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),d-=Math.ceil(f/2),d+=this.m,d+=this.H(b[0]),a<d&&(a=d));this.g.css("left",a+"px")},Za:function(a){if(this.g){e(document).off("mousemove",this.Ca);e(document).off("mouseup",this.da);var b=this.a.get(this.g[0].columnName),c=this.I(),f=b.element,
d=this.g.parent(),g=f.offset(),h=d.offset();h.left+=parseFloat(d.css("border-left-width"))||0;g.left-=h.left;d=this.g.outerWidth();a=a.pageX-h.left;g=h=g.left;g=0;c?(a+=this.H(f[0]),h+=f.outerWidth(),h-=Math.ceil((parseFloat(f.css("border-right-width"))||0)/2),h-=Math.ceil(d/2),g=h-this.m,a>g&&(a=g),g=h-a):(a-=this.H(f[0]),h+=Math.ceil((parseFloat(f.css("border-right-width"))||0)/2),h-=Math.ceil(d/2),g=h+this.m,a<g&&(a=g),g=a-h);this.g.remove();this.g=null;c=g;if(b.n===p.RELATIVE){c=this.oa();for(f=
0;f<this.b.length;f++)d=this.b[f],d.n!=p.RELATIVE&&(c-=d.k);c=g/c*100;c+="%"}this.setColumnWidth(b.name,c)}else a.target.style.opacity=null},wa:function(a){if(this.A){var b=a.originalEvent.dataTransfer.getData("text"),b=b?JSON.parse(b):null;a=e(a.target).closest("div."+this.f+"-header-cell,div."+this.q);(!b||this.Z==b.Ka&&a.columnName!==b.column)&&(b=this.a.get(a[0].columnName))&&(b.F||b!=this.b[0])&&e(a).addClass("drag-over")}},ya:function(a){a.preventDefault()},xa:function(a){var b=e(a.target).closest("div."+
this.f+"-header-cell,div."+this.q);e(b[0].firstChild).has(a.originalEvent.relatedTarget).length||b.removeClass("drag-over")},za:function(a){a.preventDefault();var b=JSON.parse(a.originalEvent.dataTransfer.getData("text"));a=e(a.target).closest("div."+this.f+"-header-cell,div."+this.q);if(this.A&&b.Ka==this.Z){var b=b.column,c=a[0].columnName,f=this.a.get(b),d=this.a.get(c);f&&d&&f.F&&(d.F||d!=this.b[0])&&this.moveColumn(b,c)}e(a).removeClass("drag-over")},qa:function(){if(this.h){var a=this.u.find(">div."+
this.f+"-header-cell.sorted"),b=a.find(">div>.sort-arrow");_.forEach(b,_.bind(function(a){if(a=this.a.get(a.parentNode.parentNode.columnName))a.ha=0},this));b.remove();a.removeClass("sorted").removeClass("desc")}return this},Ga:function(a,b){var c=this.a.get(a),f=r("span");f.className="sort-arrow";c.element.addClass(b?"sorted desc":"sorted");c.element[0].firstChild.insertBefore(f,c.element[0].firstChild.firstChild);c.n!=p.RELATIVE&&this.Y&&(c.ha=f.scrollWidth+(parseFloat(e(f).css("margin-right"))||
0)+(parseFloat(e(f).css("margin-left"))||0));return this},hb:function(a){var b=this.u.find("div."+this.f+"-header-cell"),c=this.a.get(b[a].columnName);if(c){b[a].style.width=(c.t||c.k)+"px";for(var b=(c.t||c.k)+"px",c=this.l[0].childNodes,e=0,d=c.length,g;e<d;e++)g=c[e],1===g.nodeType&&(g.childNodes[a].style.width=b)}return this},Ia:function(){this.u&&this.u.find("div."+this.f+"-header-cell").off("mousemove").off("mouseleave").off("dragstart").off("selectstart").off("click").find(">div").off("dragenter").off("dragover").off("dragleave").off("drop");
return this},gb:function(){this.Ia().Ja();var a=this.ma,b=this.Ra,c=this.f,f=c+"-header-cell",d=r("div"),h=e(d),m=r("div"),k=e(m);d.className=c+"-header";m.className=c+"-header-row";var l;t&&(l=function(a){a.preventDefault();this.lb();return!1});for(var q=0,n,p,A,B;q<this.b.length;q++)if(n=this.b[q],n.visible&&(p=r("div"),B=e(p),p.draggable=!0,p.className=f,p.style.width=n.k+"px",this.r&&n.sortable&&(p.className+=" sortable"),p.columnName=n.name,A=r("div"),A.innerHTML=this.Wa(n.label,n.name),p.appendChild(A),
a&&b&&this.ba(p),m.appendChild(p),this.b[q].element=B,B.on("mousedown",_.bind(this.$a,this)).on("mousemove",_.bind(this.Ba,this)).on("mouseleave",_.bind(this.Aa,this)).on("dragstart",_.bind(this.Da,this)).on("click",_.bind(this.va,this)),e(A).on("dragenter",_.bind(this.wa,this)).on("dragover",_.bind(this.ya,this)).on("dragleave",_.bind(this.xa,this)).on("drop",_.bind(this.za,this)),t))B.on("selectstart",_.bind(l,p));this.X&&this.X.remove();this.X=h;this.Q=d;this.u=k;this.sa=m;k.appendTo(this.X);h.prependTo(this.$el);
this.el.style.overflow=this.L==u.Width.SCROLL?"hidden":"";if(this.h&&this.j&&(this.h.remove(),this.l))for(a=this.l[0].childNodes,q=0,b=a.length;q<b;q++)this.trigger("rowdestroy",a[q]);g(this.$el);!this.v&&this.j&&(this.v=this.$el.innerHeight());this.j&&!this.s&&(d=function(){var a=r("div"),b=a.appendChild(r("div")),d=b.appendChild(r("div"));a.className=c+"-row";b.className=c+"-cell";d.innerHTML="0";a.style.visibility="hidden";a.style.position="absolute";return a},a=e("<div>").addClass(this.className).css({"z-index":-1,
position:"absolute",left:"0",top:"-9999px",width:"1px",overflow:"hidden"}).append(e("<div>").addClass(c).append(q=e("<div>").addClass(c+"-body").css("width",99999))),a.appendTo(document.body),b=d(),f=d(),d=d(),q.append(b,f,d),this.D=e(b).outerHeight(),this.s=e(f).outerHeight(),this.ga=e(d).outerHeight(),Math.min(Math.min(this.D,this.s),this.ga),Math.max(Math.max(this.D,this.s),this.ga),a.remove());if(this.j||!this.h)q=document.createDocumentFragment(),a=r("div"),b=e(a),a.className=this.f,this.j&&
(a.className+=" virtual"),k=this.v-k.outerHeight(),"border-box"!==b.css("box-sizing")&&(k-=parseFloat(b.css("border-top-width"))||0,k-=parseFloat(b.css("border-bottom-width"))||0,k-=parseFloat(b.css("padding-top"))||0,k-=parseFloat(b.css("padding-bottom"))||0),this.jb=k,a.style.height=this.v?k+"px":"auto",a.style.display="block",a.style.overflowY="auto",a.style.overflowX=this.L==u.Width.SCROLL?"auto":"hidden",q.appendChild(a),k=r("div"),f=e(k),k.className=this.f+"-body",this.e=a,this.i=k,this.h=b,
this.l=f,this.G(),g(f),g(b),a.appendChild(k),this.el.appendChild(q);return this},C:function(a){var b=this.e.offsetWidth-this.e.clientWidth;if(b!=this.B||a){this.B=b;for(a=0;a<this.a.length;a++)this.a[a].t=null;if(0<this.B){b=this.b.length-1;this.b[b].t=this.b[b].k-this.B;var c=this.b[b].t+"px",e=this.i.childNodes;a=0;for(var d=e.length,g;a<d;a++)g=e[a],1===g.nodeType&&(g.childNodes[b].style.width=c);this.sa.childNodes[b].style.width=c}}return this},w:function(a){var b=this.na();this.i.style.minWidth=
b+"px";this.sa.style.minWidth=b+(this.B||0)+"px";this.h.off("scroll",this.Ea);if(this.L==u.Width.AUTO)this.$el.width(this.h.width(this.l.outerWidth()).outerWidth());else if(this.L==u.Width.SCROLL){if(a){a=this.e?this.e.scrollTop:0;var b=this.e?this.e.scrollLeft:0,c=this.el,e=c.style.display;c.style.display="none";c.offsetHeight;c.style.display=e;this.e.scrollTop=a;this.e.scrollLeft=b;this.Q.scrollLeft=b}this.h.on("scroll",this.Ea)}return this},I:function(){return"rtl"===this.h.css("direction")},S:function(a){return a.n===
p.AUTO?"auto":a.n===p.RELATIVE?100*a.width+"%":a.width},Ua:function(a){this.la=!1;var b=a.firstChild;if(1<b.scrollWidth-b.clientWidth||1<b.scrollHeight-b.clientHeight){this.ta();var c=e(a),f=e(b),d=r("div"),g=e(d);d.innerHTML=a.innerHTML;d.className=this.q;if(c.hasClass(this.f+"-header-cell")&&(d.className+=" header",c.hasClass("sortable")&&(d.className+=" sortable"),d.draggable=!0,e(d).on("mousemove",_.bind(this.Ba,this)).on("mouseleave",_.bind(this.Aa,this)).on("dragstart",_.bind(this.Da,this)).on("click",
_.bind(this.va,this)),e(d.firstChild).on("dragenter",_.bind(this.wa,this)).on("dragover",_.bind(this.ya,this)).on("dragleave",_.bind(this.xa,this)).on("drop",_.bind(this.za,this)),t))e(d).on("selectstart",_.bind(function(a){a.preventDefault();this.lb();return!1},d));var h=parseFloat(c.css("padding-left"))||0,k=parseFloat(c.css("padding-right"))||0,m=parseFloat(c.css("padding-top"))||0,p=parseFloat(c.css("padding-bottom"))||0,b=b.scrollWidth+a.clientWidth-b.offsetWidth;"border-box"===c.css("boxSizing")?
(b-=parseFloat(e(a).css("border-left-width"))||0,b-=parseFloat(e(a).css("border-right-width"))||0,g.css("box-sizing","border-box")):(b-=h+k,g.css({"margin-top":parseFloat(e(a).css("border-top-width"))||0}));if(!this.ea){var n=document.createElement("div");n.style.backgroundColor="transparent";this.ea=e(n).css("background-color");n.style.backgroundColor="rgba(0,0,0,0)";this.Ha=e(n).css("background-color")}n=e(a).css("background-color");if(n===this.ea||n===this.Ha)n=e(a.parentNode).css("background-color");
if(n===this.ea||n===this.Ha)n="#fff";g.css({"box-sizing":"content-box",width:b+"px","min-height":c.height()+"px","padding-left":h,"padding-right":k,"padding-top":m,"padding-bottom":p,overflow:"hidden",position:"absolute",zIndex:"-1",left:"0",top:"0","background-color":n,cursor:"default"});document.body.appendChild(d);e(d.firstChild).css({direction:f.css("direction"),"white-space":f.css("white-space")}).data("row-el",c.closest("tr"));f=d.row=a.parentNode.rowIndex;d.columnName=this.b[_.indexOf(a.parentNode.childNodes,
a)].name;this.trigger("cellpreview",d.firstChild,null==f?null:f,d.__column,null==f?null:(this.d||this.c)[f]);this.la||(f=c.offset(),this.I()?(h=g.outerWidth(),c=c.outerWidth(),f.left-=h-c):f.left+=parseFloat(e(a).css("border-left-width"))||0,f.top+=parseFloat(e(a).css("border-top-width"))||parseFloat(e(a).css("border-bottom-width"))||0,c=e(window).width()-g.outerWidth(),f.left=0>f.left?0:f.left>c?c:f.left,g.css({left:f.left,top:f.top,"z-index":9999}),d.__cell=a,this.O=g,a.__previewEl=d,this.ca(a),
this.ca(d))}},Ta:function(){this.ta()},ta:function(){if(this.O){var a=this.O[0];this.O.remove();this.fa(a.__cell);this.fa(a);a.__cell.__previewEl=null;a.__cell=null;this.trigger("cellpreviewdestroy",a.firstChild,a.row,a.columnName);this.O=null}return this}}),p={AUTO:0,ABSOLUTE:1,RELATIVE:2};u.Width={NONE:"none",AUTO:"auto",SCROLL:"SCROLL"};l.DGTable=u})(this,jQuery);
DGTable.Pa=function(){function l(){var e=[];_.extend(e,l.prototype);e.initialize.apply(e,arguments);return e}l.prototype=[];l.prototype.initialize=function(){};l.prototype.get=function(e){for(var g=0,h=this.length;g<h;g++)if(this[g].name==e)return this[g];return null};l.prototype.indexOf=function(e){for(var g=0,h=this.length;g<h;g++)if(this[g].name==e)return g;return-1};l.prototype.V=function(e){for(var g=0,h=this.length;g<h;g++)if(this[g].order==e)return this[g];return null};l.prototype.ja=function(){var e=
[],g;for(g=0;g<this.length;g++)e.push(this[g]);e.sort(function(e,g){return e.order<g.order?-1:e.order>g.order?1:0});for(g=0;g<e.length;g++)e[g].order=g};l.prototype.N=function(){for(var e=[],g=0,h;g<this.length;g++)h=this[g],h.visible&&e.push(h);e.sort(function(e,g){return e.order<g.order?-1:e.order>g.order?1:0});return e};l.prototype.Ma=function(){for(var e=0,g=0,h;g<this.length;g++)h=this[g],h.order>e&&(e=h.order);return e};l.prototype.moveColumn=function(e,g){if(e&&g){var h=e.order,m=g.order,l;
if(h<m)for(h+=1;h<=m;h++)l=this.V(h),l.order--;else for(h-=1;h>=m;h--)l=this.V(h),l.order++;e.order=m}return this};return l}();
DGTable.Qa=function(){function l(){var e=[];_.extend(e,l.prototype);e.initialize.apply(e,arguments);return e}l.prototype=[];_.extend(l.prototype,Backbone.Events);l.prototype.initialize=function(e){e=e||{};this.U=this.M=null;this.ia=!1;this.sortColumn=null==e.sortColumn?[]:e.sortColumn};l.prototype.add=function(e,g){var h,m;if("splice"in e&&"length"in e)if(g)for(h=0,m=e.length;h<m;h++)this.splice(g++,0,e[h]);else for(h=0,m=e.length;h<m;h++)this.push(e[h]);else g?this.splice(g,0,e):this.push(e)};l.prototype.reset=
function(e){this.length=0;e&&this.add(e)};l.prototype.La=function(e,g,h){if((g=g.toString())&&null!=e){var m=new l({sortColumn:this.sortColumn});this.M=e;this.U=g;this.ia=h;g=e=0;h=this.length;for(var t;g<h;g++)t=this[g],this.mb(t)&&(t.__i=e++,m.push(t));return m}return this.U=this.M=null};l.prototype.mb=function(e){if(e&&this.M){e=e[this.M];if(null==e)return!1;e=e.toString();var g=this.U;this.ia||(e=e.toUpperCase(),g=g.toUpperCase());return-1!==e.indexOf(g)}return!0};(function(){function e(e,g){var l=
g?1:-1,r=g?-1:1;return function(g,m){var a=g[e],b=m[e];return a<b?l:a>b?r:0}}var g=l.prototype.sort;l.prototype.sort=function(h){if(this.sortColumn.length){var m=[],l,r;for(l=0;l<this.sortColumn.length;l++)r={},this.trigger("requiresComparatorForColumn",r,this.sortColumn[l].column,this.sortColumn[l].descending),m.push(_.bind(r.kb||e(this.sortColumn[l].column,this.sortColumn[l].descending),this));if(1===m.length)g.call(this,m[0]);else{var u=m.length,p;g.call(this,function(a,b){for(l=0;l<u&&(p=m[l](a,
b),0===p);l++);return p})}h||this.trigger("sort")}return this}})();return l}();
//# sourceMappingURL=DGTable.min.js.map