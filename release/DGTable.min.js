'use strict';(function(l,e){function h(a){_.contains(["relative","absolute","fixed"],a.css("position"))||a.css("position","relative")}var g=navigator.userAgent,t=-1!=g.indexOf("MSIE ")?parseFloat(g.substr(g.indexOf("MSIE ")+5)):null,r=t&&10>t,s=_.bind(document.createElement,document),v=Backbone.View.extend({className:"dgtable-wrapper",tagName:"div",VERSION:"0.3.2",initialize:function(a){function b(a){a=a||event;a=a.toElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==
this.__previewEl||jQuery.contains(this.__previewEl,a))||h.Ua.call(h,this)}function c(a){a=a||event;a=a.fromElement||a.relatedTarget;a==this||jQuery.contains(this,a)||this.__previewEl&&(a==this.__previewEl||jQuery.contains(this.__previewEl,a))||h.Va.call(h,this)}a=a||{};a.columns=a.columns||[];this.Da=_.bind(this.$a,this);this.ea=_.bind(this.Za,this);this.Fa=_.bind(this.ab,this);this.$el.on("dragend",this.ea);this.C=!0;this.l=void 0===a.virtualTable?!0:!!a.virtualTable;this.n=Math.max(a.minColumnWidth||
35,0);this.R=a.resizeAreaWidth||8;this.K=void 0===a.resizableColumns?!0:!!a.resizableColumns;this.A=void 0===a.movableColumns?!0:!!a.movableColumns;this.q=void 0===a.sortableColumns?1:parseInt(a.sortableColumns,10)||1;this.X=void 0===a.adjustColumnWidthForSortArrow?!0:!!a.adjustColumnWidthForSortArrow;this.sa=void 0===a.convertColumnWidthsToRelative?!1:!!a.convertColumnWidthsToRelative;this.Ta=void 0===a.cellClasses?"":a.cellClasses;this.hb=void 0===a.resizerClassName?"dgtable-resize":a.resizerClassName;
this.h=void 0===a.tableClassName?"dgtable":a.tableClassName;this.na=void 0===a.allowCellPreview?!0:a.allowCellPreview;this.Sa=void 0===a.allowHeaderCellPreview?!0:a.allowHeaderCellPreview;this.p=void 0===a.cellPreviewClassName?"dgtable-cell-preview":a.cellPreviewClassName;this.P=void 0===a.comparatorCallback?null:a.comparatorCallback;this.L=void 0===a.width?v.Width.NONE:a.width;this.cb=void 0===a.relativeWidthGrowsToFillWidth?!0:!!a.relativeWidthGrowsToFillWidth;this.eb=void 0===a.relativeWidthShrinksToFillWidth?
!1:!!a.relativeWidthShrinksToFillWidth;this.qa=a.cellFormatter||function(a){return a};this.Xa=a.headerCellFormatter||function(a){return a};var f,d,e,q,k=new v.Qa;for(q=f=0;f<a.columns.length;f++)d=a.columns[f],e=this.ua(d),void 0!==d.order?(d.order>q&&(q=d.order+1),e.order=d.order):e.order=q++,k.push(e);k.ka();this.a=k;this.b=k.N();if(void 0===a.sortColumn)a.sortColumn=null;else if("string"==typeof a.sortColumn)this.a.get(a.sortColumn)?a.sortColumn=[{column:a.sortColumn,descending:!1}]:a.sortColumn=
null;else if(a.sortColumn instanceof Array){q=[];f=0;d=a.sortColumn.length;for(e;f<d&&(e=a.sortColumn[f],e=void 0!==e.column?e:{column:e,descending:!1},(e=this.a.get(e.column))&&!_.contains(q,e.name)&&q.push(e.name),q.length!=this.q&&q.length!=this.b.length);f++);a.sortColumn=q}else"object"==typeof a.sortColumn?this.a.get(a.sortColumn.column)||(a.sortColumn=null):a.sortColumn=null;this.c=new v.Ra({sortColumn:a.sortColumn,columns:this.columns});this.listenTo(this.c,"sort",this.render).listenTo(this.c,
"requiresComparatorForColumn",_.bind(function(a,b,c){this.P&&(a.jb=this.P(b,c))},this));this.e=null;this.u=a.height;var h=this;"addEventListener"in window?(this.ca=function(a){a.__hoverIn||a.addEventListener("mouseover",a.__hoverIn=_.bind(c,a));return this},this.T=function(a){a.__hoverIn&&(a.removeEventListener("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.da=function(a){a.__hoverOut||a.addEventListener("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.ga=function(a){a.__hoverOut&&
(a.removeEventListener("mouseout",a.__hoverOut),a.__hoverOut=null);return this}):(this.ca=function(a){a.__hoverIn||a.attachEvent("mouseover",a.__hoverIn=_.bind(c,a));return this},this.T=function(a){a.__hoverIn&&(a.detachEvent("mouseover",a.__hoverIn),a.__hoverIn=null);return this},this.da=function(a){a.__hoverOut||a.attachEvent("mouseout",a.__hoverOut=_.bind(b,a.__cell||a));return this},this.ga=function(a){a.__hoverOut&&(a.detachEvent("mouseout",a.__hoverOut),a.__hoverOut=null);return this})},Ga:function(a){var b=
parseFloat(a),c=p.AUTO;0<b&&(a==b+"%"?(c=p.RELATIVE,b/=100):0<b&&1>b?c=p.RELATIVE:(b<this.n&&(b=this.n),c=p.ABSOLUTE));return{width:b,mode:c}},ua:function(a){var b=this.Ga(a.width);return{name:a.name,label:void 0===a.label?a.name:a.label,width:b.width,m:b.mode,resizable:void 0===a.resizable?!0:a.resizable,sortable:void 0===a.sortable?!0:a.sortable,F:void 0===a.F?!0:a.F,visible:void 0===a.visible?!0:a.visible,cellClasses:void 0===a.cellClasses?this.Ta:a.cellClasses}},close:function(){this.i&&(this.i.remove(),
this.i=null);if(this.k)for(var a=this.k[0].childNodes,b=0,c=a.length;b<c;b++)this.trigger("rowdestroy",a[b]);this.remove();this.Ja().Ka();this.g.unbind();this.k.unbind();this.$el.unbind();this.unbind();if(this.o){for(a=0;a<this.o.length;a++)b=this.o[a],b.Pa.removeEventListener("message",b.Oa,!1);this.o.length=0}this.c.length=this.a.length=0;for(var f in this)this.hasOwnProperty(f)&&(this[f]=null)},Ka:function(){if(this.la)for(var a=0,b=this.la[0].childNodes,c=b.length,f;a<c;a++){f=b[a];var d=0;f=
f.childNodes;for(var e=f.length;d<e;d++)this.T(f[d])}if(this.k)for(a=0,b=this.k[0].childNodes,c=b.length;a<c;a++)for(f=b[a],d=0,f=f.childNodes,e=f.length;d<e;d++)this.T(f[d]);return this},ob:function(a){var b=0;a=a.childNodes;for(var c=a.length;b<c;b++)this.T(a[b]);return this},render:function(){if(!0===this.C){this.C=!1;this.L==v.Width.AUTO&&this.ra();var a=this.d?this.d.scrollTop:0,b=this.d?this.d.scrollLeft:0;this.tableWidthChanged(!0,!1).fb();if(this.l)this.v();else{var c=(this.e||this.c).length,
f=this.G(0,c-1);this.k.html("").append(f);this.v(!0)}this.d.scrollTop=a;this.d.scrollLeft=b;this.Q.scrollLeft=b;this.w(!0);for(f=0;f<this.c.sortColumn.length;f++)this.Ha(this.c.sortColumn[f].column,this.c.sortColumn[f].descending);this.X&&this.c.sortColumn.length&&this.tableWidthChanged(!0);this.trigger("renderskeleton");this.l&&(this.g.on("scroll",_.bind(this.bb,this)),this.render())}else if(this.l){c=(this.e||this.c).length;b=this.d.scrollTop;a=Math.floor((b-this.D)/this.r)+1;b=Math.ceil((b-this.D+
this.ib)/this.r);0>a&&(a=0);b>=c&&(b=c-1);var d=-1,c=-1,e=this.f.childNodes;e.length&&(d=e[0].rowIndex,c=e[e.length-1].rowIndex);if(-1!==d&&d<a){for(var q=Math.min(c+1,a)-d,f=0;f<q;f++)this.trigger("rowdestroy",e[0]),this.f.removeChild(e[0]);d+=q;d>c&&(d=c=-1)}else if(-1!==c&&c>b){q=c-Math.max(d-1,b);for(f=0;f<q;f++)this.trigger("rowdestroy",e[e.length-1]),this.f.removeChild(e[e.length-1]);c<d&&(d=c=-1)}a<d&&(f=this.G(a,Math.min(b,d-1)),this.k.prepend(f));if(b>c||-1===c)f=this.G(-1===c?a:c+1,b),this.k.append(f)}this.trigger("render");
return this},clearAndRender:function(){this.C=!0;return this.render()},G:function(a,b){var c=this.h,f=c+"-row",c=c+"-cell",d=this.e||this.c,e=!!this.e,q=this.na,k=this.b,h=this.qa,m=this.l,D=this.D,g=this.r,l,t,r=k.length;l=0;for(var p;l<r;l++)p=k[l],p.Wa=p.s||p.j;for(var v=document.createDocumentFragment(),E=this.I()?"right":"left",x=a,F=d.length,z,w,y,C;x<F&&x<=b;x++){z=d[x];t=e?z.__i:x;w=s("div");w.className=f;w.rowIndex=x;w.physicalRowIndex=t;for(l=0;l<r;l++)p=k[l],y=s("div"),y.columnName=p.name,
y.className=c,y.style.width=p.Wa+"px",p.cellClasses&&(y.className+=" "+p.cellClasses),q&&this.ca(y),C=y.appendChild(s("div")),C.innerHTML=h(z[p.name],p.name,z),w.appendChild(y);m&&(l=0<x?D+(x-1)*g:0,w.style.position="absolute",w.style[E]=0,w.style.top=l+"px");v.appendChild(w);this.trigger("rowcreate",x,t,w,z)}return v},Y:function(){if(this.f){var a=(this.e||this.c).length,b=this.r*a;a&&(b+=this.D-this.r,b+=this.ha-this.r);this.f.style.height=b+"px"}return this},oa:function(){var a=this.h,b=a+"-row",
c=a+"-cell",f=this.b,d=f.length,u,q,k,b=e("<div>").addClass(b).css("float","left");for(q=0;q<d;q++)k=f[q],u=s("div"),u.className=c,u.style.width=k.j+"px",k.cellClasses&&(u.className+=" "+k.cellClasses),u.appendChild(s("div")),b.append(u);a=e("<div>").addClass(this.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px","float":"left",width:"1px",overflow:"hidden"}).append(e("<div>").addClass(a).append(e("<div>").addClass(a+"-body").css("width",99999).append(b)));a.appendTo(document.body);
c=b.outerWidth();c-=this.B||0;a.remove();return c},addColumn:function(a,b){if(a&&!this.a.get(a.name)){var c=null;void 0!==b&&(c=this.a.get(b)||this.a.V(b));var f=this.ua(a);f.order=c?c.order:this.a.Na()+1;for(var c=this.a.Na(),d=f.order,e;c>=d;c--)(e=this.a.V(c))&&e.order++;this.a.push(f);this.a.ka();this.C=!0;this.b=this.a.N();this.render();this.trigger("addcolumn",f.name)}return this},removeColumn:function(a){var b=this.a.indexOf(a);-1<b&&(this.a.splice(b,1),this.a.ka(),this.b=this.a.N(),this.clearAndRender(),
this.trigger("removecolumn",a));return this},filter:function(a,b,c){if(this.a.get(a)){var f=!!this.e;this.e&&(this.e=null);this.e=this.c.Ma(a,b,c);if(f||this.e)this.clearAndRender(),this.trigger("filter",a,b,c)}return this},J:function(){this.e&&(this.e=null,this.e=this.c.Ma(this.c.M,this.c.U,this.c.ja));return this},setColumnLabel:function(a,b){var c=this.a.get(a);if(c&&(c.label=void 0===b?c.name:b,c.element))for(var f=0;f<c.element[0].firstChild.childNodes.length;f++){var d=c.element[0].firstChild.childNodes[f];
if(3===d.nodeType){d.textContent=c.label;break}}return this},moveColumn:function(a,b){var c,f;"string"===typeof a?c=this.a.get(a):"number"===typeof a&&(c=this.b[a]);"string"===typeof b?f=this.a.get(b):"number"===typeof b&&(f=this.b[b]);if(c&&f&&a!==b){var d=c.order,e=f.order;this.b=this.a.moveColumn(c,f).N();if(this.l)this.clearAndRender().v(!0);else{var q=this.t.find(">div."+this.h+"-header-cell");f=d<e?e+1:e;q[0].parentNode.insertBefore(q[d],q[f]);for(var q=this.b[d],q=(q.s||q.j)+"px",k=this.b[e],
k=(k.s||k.j)+"px",h=this.k[0].childNodes,m=0,g=h.length,n;m<g;m++)n=h[m],1===n.nodeType&&(n.insertBefore(n.childNodes[d],n.childNodes[f]),n.childNodes[e].firstChild.style.width=k,n.childNodes[d].firstChild.style.width=q)}this.trigger("movecolumn",c.name,d,e)}return this},sort:function(a,b,c){var f=this.a.get(a);if(f){var d=this.c.sortColumn;d.length&&d[d.length-1].column==a&&(b=void 0===b?!d[d.length-1].descending:b);if(c){for(a=0;a<d.length;a++)if(d[a].column==f.name){a<d.length-1?d.length=0:d.splice(d.length-
1,1);break}if(0<this.q&&d.length>=this.q||d.length>=this.b.length)d.length=0}else d.length=0;d.push({column:f.name,descending:!(void 0===b||!b)});this.c.sortColumn=d;this.ra();for(a=0;a<d.length;a++)this.Ha(d[a].column,d[a].descending);this.X&&this.tableWidthChanged(!0);if(this.l)for(;this.f.firstChild;)this.trigger("rowdestroy",this.f.firstChild),this.f.removeChild(this.f.firstChild);else this.C=!0;this.c.sort(!!this.e);this.J();this.e&&this.render();b=[];for(a=0;a<d.length;a++)b.push({column:d[a].column,
descending:d[a].descending});this.trigger("sort",b)}return this},setColumnVisible:function(a,b){var c=this.a.get(a);c&&!!c.visible!=!!b&&(c.visible=!!b,this.b=this.a.N(),this.clearAndRender(),this.trigger(b?"showcolumn":"hidecolumn",a));return this},isColumnVisible:function(a){return(a=this.a.get(a))?a.visible:!1},setMinColumnWidth:function(a){a=Math.max(a,0);this.n!=a&&(this.n=a,this.tableWidthChanged(!0));return this},getMinColumnWidth:function(){return this.n},setSortableColumns:function(a){if(this.q!=
a&&(this.q=a,this.g)){a=this.t.find(">div."+this.h+"-header-cell");for(var b=0;b<a.length;b++)e(a[0])[0<this.q&&this.b[b].sortable?"addClass":"removeClass"]("sortable")}return this},getSortableColumns:function(){return this.q},setMovableColumns:function(a){a=!!a;this.A!=a&&(this.A=a);return this},getMovableColumns:function(){return this.A},setResizableColumns:function(a){a=!!a;this.K!=a&&(this.K=a);return this},getResizableColumns:function(){return this.K},setComparatorCallback:function(a){this.P!=
a&&(this.P=a);return this},setColumnWidth:function(a,b){var c=this.Ga(b),f=this.a.get(a);if(f){var d=this.S(f);f.width=c.width;f.m=c.mode;c=this.S(f);d!=c&&this.tableWidthChanged(!0);this.trigger("columnwidth",f.name,d,c)}return this},getColumnWidth:function(a){return(a=this.a.get(a))?this.S(a):null},getColumnConfig:function(a){return(a=this.a.get(a))?{order:a.order,width:this.S(a),visible:a.visible}:null},getColumnsConfig:function(){for(var a={},b=0;b<this.a.length;b++)a[this.a[b].name]=this.getColumnConfig(this.a[b]);
return a},getSortedColumns:function(){for(var a=[],b=0,c;b<this.c.sortColumn.length;b++)c=this.c.sortColumn[b],a.push({column:c.column,descending:c.descending});return a},getHtmlForCell:function(a,b){if(0>a||a>this.c.length-1||!this.a.get(b))return null;var c=this.c[a];return this.qa(c[b],b,c)},getDataForRow:function(a){return 0>a||a>this.c.length-1?null:this.c[a]},getDataForFilteredRow:function(a){return 0>a||a>(this.e||this.c).length-1?null:(this.e||this.c)[a]},H:function(a){return(parseFloat(e.css(a,
"padding-left"))||0)+(parseFloat(e.css(a,"padding-right"))||0)},Ya:function(a){return(parseFloat(e.css(a,"border-left"))||0)+(parseFloat(e.css(a,"border-right"))||0)},pa:function(){var a,b,c;this.g&&(b=this.d?this.d.scrollTop:0,c=this.d?this.d.scrollLeft:0,a=this.g[0].style.display,this.g[0].style.display="none");var f=this.$el.width();this.g&&(this.g[0].style.display=a,this.d.scrollTop=b,this.d.scrollLeft=c,this.Q.scrollLeft=c);var d;b=this.h;if(this.g)c=this.t;else{d=e("<div>").addClass(this.className).css({"z-index":-1,
position:"absolute",left:"0",top:"-9999px"});a=e("<div>").addClass(b+"-header").appendTo(d);c=e("<div>").addClass(b+"-header-row").appendTo(a);for(a=0;a<this.b.length;a++)c.append(e("<div><div></div></div>").addClass(b+"-header-cell").addClass(this.b[a].cellClasses||""));d.appendTo(document.body)}f-=this.Ya(c[0]);b=c.find(">div."+b+"-header-cell");a=0;for(var u;a<b.length;a++)e(b[a].firstChild),c=e(b[a]),u="border-box"===c.css("boxSizing"),f-=(parseFloat(c.css("border-right-width"))||0)+(parseFloat(c.css("border-left-width"))||
0)+(u?0:this.H(c[0]));d&&d.remove();return f},tableWidthChanged:function(){var a=null;return function(b,c){var f=this.pa(),d=f,u=0;c=void 0===c||c;var q=0;c&&(q=parseFloat(this.f.style.minWidth)||0);if(d!=a||b){a=f;var k,f=0,h=[],m,g,n=0;for(m=0;m<this.a.length;m++)this.a[m].s=null;for(m=0;m<this.b.length;m++)if(g=this.b[m],g.m===p.ABSOLUTE)k=g.width,k+=g.ia||0,k<this.n&&(k=this.n),d-=k,f+=k,k!==g.j&&(g.j=k,h.push(m));else if(g.m===p.AUTO){var l=g.label,t=this.h;k=void 0;l=e("<div>").addClass(this.$el).append(e("<div>").addClass(t+
"-header").append(e("<div>").addClass(t+"-header-row").append(k=e("<div>").addClass(t+"-header-cell").append(e("<div>").text(l))))).css({position:"absolute",top:"-9999px",visibility:"hidden"});l.appendTo(document.body);k=k.width();l.remove();k+=20;k+=g.ia||0;k<this.n&&(k=this.n);d-=k;f+=k;k!==g.j&&(g.j=k,this.sa||h.push(m))}else g.m===p.RELATIVE&&(n+=g.width,u++);if(this.sa)for(m=0;m<this.b.length;m++)g=this.b[m],g.m===p.AUTO&&(g.m=p.RELATIVE,d+=g.j,g.width=g.j/f,n+=g.width,u++);if(u&&(1>n&&this.cb||
1<n&&this.eb))for(m=0;m<this.b.length;m++)g=this.b[m],g.m===p.RELATIVE&&(g.width/=n);f=d;n=this.n/f;isNaN(n)&&(n=0);if(0<n){for(m=k=0;m<this.b.length;m++)g=this.b[m],g.m===p.RELATIVE&&g.width<n&&(k+=n-g.width,g.width=n);for(m=0;m<this.b.length;m++)g=this.b[m],g.m===p.RELATIVE&&g.width>n&&0<k&&(l=Math.min(k,g.width-n),g.width-=l,k-=l)}for(m=0;m<this.b.length;m++)g=this.b[m],g.m===p.RELATIVE&&(k=Math.round(f*g.width),d-=k,u--,0===u&&1===d&&(k++,d--),-1===d&&(k--,d++),k!==g.j&&(g.j=k,h.push(m)));this.b[this.b.length-
1].s=this.b[this.b.length-1].j-(this.B||0);if(c){d=this.oa();q<d&&this.w(!1);for(m=0;m<h.length;m++)this.gb(h[m]);q>d&&this.w(!1)}}return this}}(),tableHeightChanged:function(){var a=this.$el.innerHeight()-(parseFloat(this.g.css("border-top-width"))||0)-(parseFloat(this.g.css("border-bottom-width"))||0);a!=this.u&&(this.u=a,this.k&&(this.k[0].style.height=this.u-this.la.outerHeight()+"px"),this.l&&this.clearAndRender());return this},addRows:function(a){if(a){this.c.add(a);if(this.l){for(;this.f.firstChild;)this.trigger("rowdestroy",
this.f.firstChild),this.f.removeChild(this.f.firstChild);this.e&&this.J();this.Y().v().w(!1);this.render()}else if(this.e){var b=this.e.length;this.J();this.e&&this.e.length==b||this.clearAndRender()}else this.k&&(b=this.c.length-a.length,b=this.G(b,b+a.length-1),this.f.appendChild(b),this.v().w(!0));this.trigger("addrows",a.length,!1)}return this},removeRow:function(a,b){if(0>a||a>this.c.length-1)return this;this.c.splice(a,1);b=void 0===b?!0:!!b;if(this.e)this.J(),this.C=!0,b&&this.render();else if(b){var c=
this.f.childNodes;if(this.l){for(var f=0;f<c.length;f++)c[f].rowIndex>=a&&(this.trigger("rowdestroy",c[f]),this.f.removeChild(c[f]),f--);this.Y().v().render().w(!1)}else{for(f=0;f<c.length;f++)if(c[f].rowIndex===a){this.trigger("rowdestroy",c[f]);this.f.removeChild(c[f]);break}this.render().v().w(!0)}}return this},refreshRow:function(a){if(0>a||a>this.c.length-1)return this;var b=-1;if(this.e&&-1===(b=_.indexOf(this.e,this.c[a])))return this;-1===b&&(b=a);var c=this.f.childNodes;if(this.l){for(var f=
!1,d=0;d<c.length;d++)if(c[d].physicalRowIndex===a){f=!0;this.trigger("rowdestroy",c[d]);this.f.removeChild(c[d]);break}f&&(a=this.G(b,b),this.f.insertBefore(a,c[d]||null))}else this.trigger("rowdestroy",c[b]),this.f.removeChild(c[b]),a=this.G(b,b),this.f.insertBefore(a,c[b]||null);return this},setRows:function(a){this.scrollTop=this.$el.find(".table").scrollTop();this.c.reset(a);this.J();this.clearAndRender().trigger("addrows",a.length,!0);return this},getUrlForElementContent:function(a){if(a=document.getElementById(a)){a=
a.textContent;if("function"===typeof Blob)a=new Blob([a]);else{var b=l.BlobBuilder||l.WebKitBlobBuilder||l.nb||l.mb;if(!b)return null;b=new b;b.append(a);a=b.getBlob()}return(l.URL||l.webkitURL).createObjectURL(a)}return null},isWorkerSupported:function(){return l.Worker instanceof Function},createWebWorker:function(a,b){if(this.isWorkerSupported()){var c=this,f=new Worker(a),d=function(a){a.data.append?c.addRows(a.data.rows):c.setRows(a.data.rows)};f.addEventListener("message",d,!1);this.o||(this.o=
[]);this.o.push({Pa:f,Oa:d});(b||void 0===b)&&f.postMessage(null);return f}return null},unbindWebWorker:function(a){if(this.o)for(var b=0;b<this.o.length;b++)this.o[b].Pa==a&&(a.removeEventListener("message",this.o[b].Oa,!1),this.o.splice(b,1),b--);return this},abortCellPreview:function(){this.ma=!0;return this},bb:function(){this.render()},ab:function(){this.Q.scrollLeft=this.d.scrollLeft},aa:function(a){var b=this.I(),c=e(a.target).closest("div."+this.h+"-header-cell,div."+this.p),f=c[0];f.__cell&&
(f=f.__cell,c=e(f));for(var d=c[0].previousSibling;d&&1!=d.nodeType;)d=d.previousSibling;var g=!d;a=(a.originalEvent.pageX||a.originalEvent.clientX)-c.offset().left;if(b){if(!g&&c.outerWidth()-a<=this.R/2)return d.columnName;if(a<=this.R/2)return f.columnName}else{if(!g&&a<=this.R/2)return d.columnName;if(c.outerWidth()-a<=this.R/2)return f.columnName}return null},Aa:function(a){var b=this.aa(a);if(b){var c=this.a.get(b);if(!this.K||!c||!c.resizable)return!1;b=this.I();this.i&&e(this.i).remove();
this.i=e("<div></div>").addClass(this.hb).css({position:"absolute",display:"block","z-index":-1,visibility:"hidden",width:"2px",background:"#000",opacity:0.7}).appendTo(this.$el);var c=c.element,f=this.i.parent(),d=c.offset(),g=f.offset();8===t&&(d=c.offset());g.left+=parseFloat(f.css("border-left-width"))||0;g.top+=parseFloat(f.css("border-top-width"))||0;d.left-=g.left;d.top-=g.top;d.top-=parseFloat(c.css("border-top-width"))||0;f=this.i.outerWidth();b?d.left-=Math.ceil((parseFloat(c.css("border-left-width"))||
0)/2):(d.left+=c.outerWidth(),d.left+=Math.ceil((parseFloat(c.css("border-right-width"))||0)/2));d.left-=Math.ceil(f/2);this.i.css({"z-index":"10",visibility:"visible",left:d.left,top:d.top,height:this.$el.height()})[0].columnName=c[0].columnName;try{this.i[0].style.zIndex=""}catch(h){}e(document).on("mousemove",this.Da);e(document).on("mouseup",this.ea);a.preventDefault()}},Ca:function(a){if(this.K){var b=this.aa(a);a=e(a.target).closest("div."+this.h+"-header-cell,div."+this.p)[0];b&&this.a.get(b).resizable?
a.style.cursor="e-resize":a.style.cursor=""}},Ba:function(a){e(a.target).closest("div."+this.h+"-header-cell,div."+this.p)[0].style.cursor=""},va:function(a){if(!this.aa(a)&&(a=e(a.target).closest("div."+this.h+"-header-cell,div."+this.p)[0],this.q)){var b=this.a.get(a.columnName);b&&b.sortable&&this.sort(a.columnName,void 0,!0)}},Ea:function(a){if(this.A){var b=e(a.target).closest("div."+this.h+"-header-cell,div."+this.p),c=this.a.get(b[0].columnName);c&&c.F?(b[0].style.opacity=0.35,this.Z=161061273*
Math.random(),a.originalEvent.dataTransfer.setData("text",JSON.stringify({La:this.Z,column:c.name}))):a.preventDefault()}else a.preventDefault()},$a:function(a){var b=this.a.get(this.i[0].columnName),c=this.I(),b=b.element,f=this.i.parent(),d=b.offset(),e=f.offset();e.left+=parseFloat(f.css("border-left-width"))||0;d.left-=e.left;f=this.i.outerWidth();a=a.pageX-e.left;d=d.left;c?(d+=b.outerWidth(),d-=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),d-=Math.ceil(f/2),d-=this.n,d-=this.H(b[0]),
a>d&&(a=d)):(d+=Math.ceil((parseFloat(b.css("border-right-width"))||0)/2),d-=Math.ceil(f/2),d+=this.n,d+=this.H(b[0]),a<d&&(a=d));this.i.css("left",a+"px")},Za:function(a){if(this.i){e(document).off("mousemove",this.Da);e(document).off("mouseup",this.ea);var b=this.a.get(this.i[0].columnName),c=this.I(),f=b.element,d=this.i.parent(),g=f.offset(),h=d.offset();h.left+=parseFloat(d.css("border-left-width"))||0;g.left-=h.left;d=this.i.outerWidth();a=a.pageX-h.left;g=h=g.left;g=0;c?(a+=this.H(f[0]),h+=
f.outerWidth(),h-=Math.ceil((parseFloat(f.css("border-right-width"))||0)/2),h-=Math.ceil(d/2),g=h-this.n,a>g&&(a=g),g=h-a):(a-=this.H(f[0]),h+=Math.ceil((parseFloat(f.css("border-right-width"))||0)/2),h-=Math.ceil(d/2),g=h+this.n,a<g&&(a=g),g=a-h);this.i.remove();this.i=null;c=g;if(b.m===p.RELATIVE){c=this.pa();for(f=0;f<this.b.length;f++)d=this.b[f],d.m!=p.RELATIVE&&(c-=d.j);c=g/c*100;c+="%"}this.setColumnWidth(b.name,c)}else a.target.style.opacity=null},wa:function(a){if(this.A){var b=a.originalEvent.dataTransfer.getData("text"),
b=b?JSON.parse(b):null;a=e(a.target).closest("div."+this.h+"-header-cell,div."+this.p);(!b||this.Z==b.La&&a.columnName!==b.column)&&(b=this.a.get(a[0].columnName))&&(b.F||b!=this.b[0])&&e(a).addClass("drag-over")}},ya:function(a){a.preventDefault()},xa:function(a){var b=e(a.target).closest("div."+this.h+"-header-cell,div."+this.p);e(b[0].firstChild).has(a.originalEvent.relatedTarget).length||b.removeClass("drag-over")},za:function(a){a.preventDefault();var b=JSON.parse(a.originalEvent.dataTransfer.getData("text"));
a=e(a.target).closest("div."+this.h+"-header-cell,div."+this.p);if(this.A&&b.La==this.Z){var b=b.column,c=a[0].columnName,f=this.a.get(b),d=this.a.get(c);f&&d&&f.F&&(d.F||d!=this.b[0])&&this.moveColumn(b,c)}e(a).removeClass("drag-over")},ra:function(){if(this.g){var a=this.t.find(">div."+this.h+"-header-cell.sorted"),b=a.find(">div>.sort-arrow");_.forEach(b,_.bind(function(a){if(a=this.a.get(a.parentNode.parentNode.columnName))a.ia=0},this));b.remove();a.removeClass("sorted").removeClass("desc")}return this},
Ha:function(a,b){var c=this.a.get(a),f=s("span");f.className="sort-arrow";c.element.addClass(b?"sorted desc":"sorted");c.element[0].firstChild.insertBefore(f,c.element[0].firstChild.firstChild);c.m!=p.RELATIVE&&this.X&&(c.ia=f.scrollWidth+(parseFloat(e(f).css("margin-right"))||0)+(parseFloat(e(f).css("margin-left"))||0));return this},gb:function(a){var b=this.t.find("div."+this.h+"-header-cell"),c=this.a.get(b[a].columnName);if(c){b[a].style.width=(c.s||c.j)+"px";for(var b=(c.s||c.j)+"px",c=this.k[0].childNodes,
e=0,d=c.length,g;e<d;e++)g=c[e],1===g.nodeType&&(g.childNodes[a].style.width=b)}return this},Ja:function(){this.t&&this.t.find("div."+this.h+"-header-cell").off("mousedown").off("mousemove").off("mouseleave").off("dragstart").off("selectstart").off("click").find(">div").off("dragenter").off("dragover").off("dragleave").off("drop");return this},fb:function(){this.Ja().Ka();var a=this.na,b=this.Sa,c=this.h,f=c+"-header-cell",d=s("div"),g=e(d),l=s("div"),k=e(l);d.className=c+"-header";l.className=c+
"-header-row";var t;r&&(t=function(a){a.preventDefault();this.kb();return!1});for(var m=0,p,n,A,B;m<this.b.length;m++)if(p=this.b[m],p.visible&&(n=s("div"),B=e(n),n.draggable=!0,n.className=f,n.style.width=p.j+"px",this.q&&p.sortable&&(n.className+=" sortable"),n.columnName=p.name,A=s("div"),A.innerHTML=this.Xa(p.label,p.name),n.appendChild(A),a&&b&&this.ca(n),l.appendChild(n),this.b[m].element=B,B.on("mousedown",_.bind(this.Aa,this)).on("mousemove",_.bind(this.Ca,this)).on("mouseleave",_.bind(this.Ba,
this)).on("dragstart",_.bind(this.Ea,this)).on("click",_.bind(this.va,this)),e(A).on("dragenter",_.bind(this.wa,this)).on("dragover",_.bind(this.ya,this)).on("dragleave",_.bind(this.xa,this)).on("drop",_.bind(this.za,this)),r))B.on("selectstart",_.bind(t,n));this.W&&this.W.remove();this.W=g;this.Q=d;this.t=k;this.ta=l;k.appendTo(this.W);g.prependTo(this.$el);this.el.style.overflow=this.L==v.Width.SCROLL?"hidden":"";if(this.g&&this.l&&(this.g.remove(),this.k))for(a=this.k[0].childNodes,m=0,b=a.length;m<
b;m++)this.trigger("rowdestroy",a[m]);h(this.$el);!this.u&&this.l&&(this.u=this.$el.innerHeight());this.l&&!this.r&&(d=function(){var a=s("div"),b=a.appendChild(s("div")),d=b.appendChild(s("div"));a.className=c+"-row";b.className=c+"-cell";d.innerHTML="0";a.style.visibility="hidden";a.style.position="absolute";return a},a=e("<div>").addClass(this.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px",width:"1px",overflow:"hidden"}).append(e("<div>").addClass(c).append(m=e("<div>").addClass(c+
"-body").css("width",99999))),a.appendTo(document.body),b=d(),f=d(),d=d(),m.append(b,f,d),this.D=e(b).outerHeight(),this.r=e(f).outerHeight(),this.ha=e(d).outerHeight(),Math.min(Math.min(this.D,this.r),this.ha),Math.max(Math.max(this.D,this.r),this.ha),a.remove());if(this.l||!this.g)m=document.createDocumentFragment(),a=s("div"),b=e(a),a.className=this.h,this.l&&(a.className+=" virtual"),k=this.u-k.outerHeight(),"border-box"!==b.css("box-sizing")&&(k-=parseFloat(b.css("border-top-width"))||0,k-=parseFloat(b.css("border-bottom-width"))||
0,k-=parseFloat(b.css("padding-top"))||0,k-=parseFloat(b.css("padding-bottom"))||0),this.ib=k,a.style.height=this.u?k+"px":"auto",a.style.display="block",a.style.overflowY="auto",a.style.overflowX=this.L==v.Width.SCROLL?"auto":"hidden",m.appendChild(a),k=s("div"),f=e(k),k.className=this.h+"-body",this.d=a,this.f=k,this.g=b,this.k=f,this.Y(),h(f),h(b),a.appendChild(k),this.el.appendChild(m);return this},v:function(a){var b=this.d.offsetWidth-this.d.clientWidth;if(b!=this.B||a){this.B=b;for(a=0;a<this.a.length;a++)this.a[a].s=
null;if(0<this.B){b=this.b.length-1;this.b[b].s=this.b[b].j-this.B;var c=this.b[b].s+"px",e=this.f.childNodes;a=0;for(var d=e.length,g;a<d;a++)g=e[a],1===g.nodeType&&(g.childNodes[b].style.width=c);this.ta.childNodes[b].style.width=c}}return this},w:function(a){var b=this.oa();this.f.style.minWidth=b+"px";this.ta.style.minWidth=b+(this.B||0)+"px";this.g.off("scroll",this.Fa);if(this.L==v.Width.AUTO)this.$el.width(this.g.width(this.k.outerWidth()).outerWidth());else if(this.L==v.Width.SCROLL){if(a){a=
this.d?this.d.scrollTop:0;var b=this.d?this.d.scrollLeft:0,c=this.el,e=c.style.display;c.style.display="none";c.offsetHeight;c.style.display=e;this.d.scrollTop=a;this.d.scrollLeft=b;this.Q.scrollLeft=b}this.g.on("scroll",this.Fa)}return this},I:function(){return"rtl"===this.g.css("direction")},S:function(a){return a.m===p.AUTO?"auto":a.m===p.RELATIVE?100*a.width+"%":a.width},Va:function(a){var b=this;b.ma=!1;var c=a.firstChild;if(1<c.scrollWidth-c.clientWidth||1<c.scrollHeight-c.clientHeight){b.ba();
var f=e(a),d=e(c),g=s("div"),h=e(g);g.innerHTML=a.innerHTML;g.className=b.p;if(f.hasClass(this.h+"-header-cell")&&(g.className+=" header",f.hasClass("sortable")&&(g.className+=" sortable"),g.draggable=!0,e(g).on("mousedown",_.bind(b.Aa,b)).on("mousemove",_.bind(b.Ca,b)).on("mouseleave",_.bind(b.Ba,b)).on("dragstart",_.bind(b.Ea,b)).on("click",_.bind(b.va,b)),e(g.firstChild).on("dragenter",_.bind(b.wa,b)).on("dragover",_.bind(b.ya,b)).on("dragleave",_.bind(b.xa,b)).on("drop",_.bind(b.za,b)),r))e(g).on("selectstart",
_.bind(function(a){a.preventDefault();this.kb();return!1},g));var k=parseFloat(f.css("padding-left"))||0,l=parseFloat(f.css("padding-right"))||0,m=parseFloat(f.css("padding-top"))||0,p=parseFloat(f.css("padding-bottom"))||0,c=c.scrollWidth+a.clientWidth-c.offsetWidth;"border-box"===f.css("boxSizing")?(c-=parseFloat(e(a).css("border-left-width"))||0,c-=parseFloat(e(a).css("border-right-width"))||0,h.css("box-sizing","border-box")):(c-=k+l,h.css({"margin-top":parseFloat(e(a).css("border-top-width"))||
0}));if(!b.fa){var n=document.createElement("div");n.style.backgroundColor="transparent";b.fa=e(n).css("background-color");n.style.backgroundColor="rgba(0,0,0,0)";b.Ia=e(n).css("background-color")}n=e(a).css("background-color");if(n===b.fa||n===b.Ia)n=e(a.parentNode).css("background-color");if(n===b.fa||n===b.Ia)n="#fff";h.css({"box-sizing":"content-box",width:c+"px","min-height":f.height()+"px","padding-left":k,"padding-right":l,"padding-top":m,"padding-bottom":p,overflow:"hidden",position:"absolute",
zIndex:"-1",left:"0",top:"0","background-color":n,cursor:"default"});document.body.appendChild(g);e(g.firstChild).css({direction:d.css("direction"),"white-space":d.css("white-space")});g.rowIndex=a.parentNode.rowIndex;d=g.physicalRowIndex=a.parentNode.physicalRowIndex;g.columnName=b.b[_.indexOf(a.parentNode.childNodes,a)].name;b.trigger("cellpreview",g.firstChild,null==d?null:d,g.columnName,null==d?null:b.c[d]);b.ma||(d=f.offset(),"right"===f.css("float")?(k=h.outerWidth(),f=f.outerWidth(),d.left-=
k-f,d.left-=parseFloat(e(a).css("border-right-width"))||0):d.left+=parseFloat(e(a).css("border-left-width"))||0,d.top+=parseFloat(e(a).css("border-top-width"))||parseFloat(e(a).css("border-bottom-width"))||0,f=e(window).width()-h.outerWidth(),d.left=0>d.left?0:d.left>f?f:d.left,h.css({left:d.left,top:d.top,"z-index":9999}),g.__cell=a,b.O=h,a.__previewEl=g,b.da(a),b.da(g),h.on("mousewheel",function(a){var c=a.originalEvent,d=c.wheelDelta||-c.detail;a=c.wheelDeltaX||(1==c.axis?d:0);c=c.wheelDeltaY||
(2==c.axis?d:0);d&&b.ba();c&&b.d.scrollHeight>b.d.clientHeight&&(d=-1*c+b.g.scrollTop(),b.g.scrollTop(d));a&&b.d.scrollWidth>b.d.clientWidth&&(a=-1*a+b.g.scrollLeft(),b.g.scrollLeft(a))}))}},Ua:function(){this.ba()},ba:function(){if(this.O){var a=this.O[0];this.O.remove();this.ga(a.__cell);this.ga(a);a.__cell.__previewEl=null;a.__cell=null;this.trigger("cellpreviewdestroy",a.firstChild,a.physicalRowIndex,a.columnName);this.O=null}return this}}),p={AUTO:0,ABSOLUTE:1,RELATIVE:2};v.Width={NONE:"none",
AUTO:"auto",SCROLL:"SCROLL"};l.DGTable=v})(this,jQuery);
DGTable.Qa=function(){function l(){var e=[];_.extend(e,l.prototype);e.initialize.apply(e,arguments);return e}l.prototype=[];l.prototype.initialize=function(){};l.prototype.get=function(e){for(var h=0,g=this.length;h<g;h++)if(this[h].name==e)return this[h];return null};l.prototype.indexOf=function(e){for(var h=0,g=this.length;h<g;h++)if(this[h].name==e)return h;return-1};l.prototype.V=function(e){for(var h=0,g=this.length;h<g;h++)if(this[h].order==e)return this[h];return null};l.prototype.ka=function(){var e=
[],h;for(h=0;h<this.length;h++)e.push(this[h]);e.sort(function(e,h){return e.order<h.order?-1:e.order>h.order?1:0});for(h=0;h<e.length;h++)e[h].order=h};l.prototype.N=function(){for(var e=[],h=0,g;h<this.length;h++)g=this[h],g.visible&&e.push(g);e.sort(function(e,g){return e.order<g.order?-1:e.order>g.order?1:0});return e};l.prototype.Na=function(){for(var e=0,h=0,g;h<this.length;h++)g=this[h],g.order>e&&(e=g.order);return e};l.prototype.moveColumn=function(e,h){if(e&&h){var g=e.order,l=h.order,r;
if(g<l)for(g+=1;g<=l;g++)r=this.V(g),r.order--;else for(g-=1;g>=l;g--)r=this.V(g),r.order++;e.order=l}return this};return l}();
DGTable.Ra=function(){function l(){var e=[];_.extend(e,l.prototype);e.initialize.apply(e,arguments);return e}l.prototype=[];_.extend(l.prototype,Backbone.Events);l.prototype.initialize=function(e){e=e||{};this.U=this.M=null;this.ja=!1;this.sortColumn=null==e.sortColumn?[]:e.sortColumn};l.prototype.add=function(e,h){var g,l;if("splice"in e&&"length"in e)if(h)for(g=0,l=e.length;g<l;g++)this.splice(h++,0,e[g]);else for(g=0,l=e.length;g<l;g++)this.push(e[g]);else h?this.splice(h,0,e):this.push(e)};l.prototype.reset=
function(e){this.length=0;e&&this.add(e)};l.prototype.Ma=function(e,h,g){if((h=h.toString())&&null!=e){var t=new l({sortColumn:this.sortColumn});this.M=e;this.U=h;this.ja=g;e=0;for(h=this.length;e<h;e++)g=this[e],this.lb(g)&&(g.__i=e,t.push(g));return t}return this.U=this.M=null};l.prototype.lb=function(e){if(e&&this.M){e=e[this.M];if(null==e)return!1;e=e.toString();var h=this.U;this.ja||(e=e.toUpperCase(),h=h.toUpperCase());return-1!==e.indexOf(h)}return!0};(function(){function e(e,h){var l=h?1:
-1,s=h?-1:1;return function(h,p){var a=h[e],b=p[e];return a<b?l:a>b?s:0}}var h=l.prototype.sort;l.prototype.sort=function(g){if(this.sortColumn.length){var l=[],r,s;for(r=0;r<this.sortColumn.length;r++)s={},this.trigger("requiresComparatorForColumn",s,this.sortColumn[r].column,this.sortColumn[r].descending),l.push(_.bind(s.jb||e(this.sortColumn[r].column,this.sortColumn[r].descending),this));if(1===l.length)h.call(this,l[0]);else{var v=l.length,p;h.call(this,function(a,b){for(r=0;r<v&&(p=l[r](a,b),
0===p);r++);return p})}g||this.trigger("sort")}return this}})();return l}();
//# sourceMappingURL=DGTable.min.js.map