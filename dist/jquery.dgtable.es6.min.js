/*!
 * jquery.dgtable 0.5.23
 * git://github.com/danielgindi/jquery.dgtable.git
 */
import e from"jquery";const t=Function.prototype.bind,o=function(e,o){if(t)return e.bind(o);if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");let l=Array.prototype.slice.call(arguments,1),r=this,i=function(){},n=function(){return r.apply(this instanceof i?this:o,l.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(i.prototype=this.prototype),n.prototype=new i,n},l=Function.prototype.indexOf,r=function(e,t,o){if(l)return e.indexOf(t,o);let r;if(null==e)throw new TypeError('"this" is null or not defined');let i=e.length>>>0;if(0===i)return-1;let n=0|o;if(n>=i)return-1;for(r=Math.max(n>=0?n:i-Math.abs(n),0);r<i;){if(r in e&&e[r]===t)return r;r++}return-1},i=function(e,t){return r(e,t)>=0},n=function(e,t){for(let o=0,l=e.length;o>=0&&o<l;o+=1)if(t(e[o],o,e))return e[o]},s=Function.prototype.forEach;function a(){let e=[];return Object.assign(e,a.prototype),e.initialize.apply(e,arguments),e}a.prototype=[],a.prototype.initialize=function(e){e=e||{},this.sortColumn=null==e.sortColumn?[]:e.sortColumn},a.prototype.add=function(e,t){let o,l;if("splice"in e&&"length"in e)if(t)for(o=0,l=e.length;o<l;o++)this.splice(t++,0,e[o]);else for(o=0,l=e.length;o<l;o++)this.push(e[o]);else t?this.splice(t,0,e):this.push(e)},a.prototype.reset=function(e){this.length=0,e&&this.add(e)},a.prototype.filteredCollection=function(e,t){if(e&&t){let o=new a({sortColumn:this.sortColumn});for(let l,r=0,i=this.length;r<i;r++)e(l=this[r],t)&&(l.__i=r,o.push(l));return o}return null},a.prototype.onComparatorRequired=null,a.prototype.onSort=null;let d=a.prototype.sort;function h(e,t){let o=e.column,l=e.comparePath||o;"string"==typeof l&&(l=l.split("."));let r,i=l.length,n=i>1,s=t?1:-1,a=t?-1:1;return function(e,t){let o=e[l[0]],d=t[l[0]];if(n)for(r=1;r<i;r++)o=o&&o[l[r]],d=d&&d[l[r]];return o===d?0:null==o?s:o<d?s:a}}function u(){let e=[];return Object.assign(e,u.prototype),e.initialize.apply(e,arguments),e}a.prototype.sort=function(e){if(this.sortColumn.length){let t,l,r=[];for(t=0;t<this.sortColumn.length;t++)l=null,this.onComparatorRequired&&(l=this.onComparatorRequired(this.sortColumn[t].column,this.sortColumn[t].descending)),l||(l=h(this.sortColumn[t],this.sortColumn[t].descending)),r.push(o(l,this));if(1===r.length)d.call(this,r[0]);else{let e,o=r.length;l=function(l,i){for(t=0;t<o;t++)if(0!==(e=r[t](l,i)))return e;return e},d.call(this,l)}e||this.onSort&&this.onSort()}return this},u.prototype=[],u.prototype.initialize=function(){},u.prototype.get=function(e){for(let t=0,o=this.length;t<o;t++)if(this[t].name==e)return this[t];return null},u.prototype.indexOf=function(e){for(let t=0,o=this.length;t<o;t++)if(this[t].name==e)return t;return-1},u.prototype.getByOrder=function(e){for(let t=0,o=this.length;t<o;t++)if(this[t].order==e)return this[t];return null},u.prototype.normalizeOrder=function(){let e,t=[];for(e=0;e<this.length;e++)t.push(this[e]);for(t.sort(function(e,t){return e.order<t.order?-1:e.order>t.order?1:0}),e=0;e<t.length;e++)t[e].order=e;return this},u.prototype.getVisibleColumns=function(){let e=[];for(let t,o=0;o<this.length;o++)(t=this[o]).visible&&e.push(t);return e.sort((e,t)=>e.order<t.order?-1:e.order>t.order?1:0),e},u.prototype.getMaxOrder=function(){let e=0;for(let t,o=0;o<this.length;o++)(t=this[o]).order>e&&(e=t.order);return e},u.prototype.moveColumn=function(e,t){if(e&&t){let o,l,r=e.order,i=t.order;if(r<i)for(o=r+1;o<=i;o++)(l=this.getByOrder(o)).order--;else for(o=r-1;o>=i;o--)(l=this.getByOrder(o)).order++;e.order=i}return this};const c=e,p=document.defaultView&&document.defaultView.getComputedStyle,m=c&&c.fn.jquery>="3",f={width:["Left","Right","Width"],height:["Top","Bottom","Height"]},g=["width","height"],b={};let v=function(e,t,o,l){return function(){let r=arguments[0],i=arguments[1];if(r&&!(r instanceof Element)&&"length"in r&&(r=r[0]),!r)return null;let n,s,a,d=p?document.defaultView.getComputedStyle(r):r.currentStyle,h="border-box"===d.boxSizing,u=l&&!0===arguments[2]||!0===arguments[1];(h||l||o)&&(s=parseFloat(d["border"+t[0]+"Width"]||0)+parseFloat(d["border"+t[1]+"Width"]||0),a=parseFloat(d["padding"+t[0]]||0)+parseFloat(d["padding"+t[1]]||0));let c=u?parseFloat(d["margin"+t[0]]||0)+parseFloat(d["margin"+t[1]]||0):0;return null==i?(n=parseFloat(d[e]),h?(a+s>n&&(n=a+s),l?u&&(n+=c):n-=o?s:a+s):l?(n+=a+s,u&&(n+=c)):o&&(n+=a),n):(n=i=i||0,h?l?u&&(n-=c):n+=o?s:a+s:(l?(n-=a+s,u&&(n-=c)):o&&(n-=a),n<0&&(n=0)),r.style[e]=n+"px",i)}},C=function(e){return function(){let t=arguments[0];c.isArray(t)||t instanceof c||(t=[t]);let o=c.fn[e].apply(t,Array.prototype.slice.call(arguments,1));return arguments.length>1?this:o}};for(let e=0;e<g.length;e++){let t=g[e],o=f[t];m?(b[t]=C(t),b["inner"+o[2]]=C("inner"+o[2]),b["outer"+o[2]]=C("outer"+o[2])):(b[t]=v(t,o,!1,!1),b["inner"+o[2]]=v(t,o,!0,!1),b["outer"+o[2]]=v(t,o,!1,!0))}v=null;class w{static saveSelection(e){let t=window.getSelection().getRangeAt(0);if(e!==t.commonAncestorContainer&&!function(e,t){for(;(e=e.parentNode)&&e!==t;);return!!e}(t.commonAncestorContainer,e))return null;let o=t.cloneRange();o.selectNodeContents(e),o.setEnd(t.startContainer,t.startOffset);let l=o.toString().length;return{start:l,end:l+t.toString().length}}static restoreSelection(e,t){let o,l=0,r=[e],i=!1,n=!1,s=document.createRange();for(s.setStart(e,0),s.collapse(!0);!n&&(o=r.pop());)if(3==o.nodeType){let e=l+o.length;!i&&t.start>=l&&t.start<=e&&(s.setStart(o,t.start-l),i=!0),i&&t.end>=l&&t.end<=e&&(s.setEnd(o,t.end-l),n=!0),l=e}else{let e=o.childNodes.length;for(;e--;)r.push(o.childNodes[e])}let a=window.getSelection();a.removeAllRanges(),a.addRange(s)}}function y(e,t){let o=t.column,l=null==t.keyword?"":t.keyword.toString();if(!l||!o)return!0;let r=e[o];return null!=r&&(r=r.toString(),t.caseSensitive||(r=r.toLowerCase(),l=l.toLowerCase()),-1!==r.indexOf(l))}const _=e;let R=navigator.userAgent,W=-1!=R.indexOf("MSIE ")?parseFloat(R.substr(R.indexOf("MSIE ")+5)):null,T=W&&W<10,N=o(document.createElement,document);const F=Object.prototype.hasOwnProperty;function H(e){i(["relative","absolute","fixed"],e.css("position"))||e.css("position","relative")}let M=function e(){if(!(this instanceof e))return new(Function.prototype.bind.apply(e,[e].concat(Array.prototype.slice.call(arguments,0))));this.initialize.apply(this,arguments)};M.VERSION="@@VERSION",M.prototype.VERSION=M.VERSION,M.prototype.initialize=function(e){let t=this;e=e||{};let l=t.o={},r=t.p={};r.events={},t.el=e.el&&e.el instanceof Element?e.el:document.createElement("div");let i=t.$el=_(t.el);t.el!==e.el&&i.addClass(e.className||"dgtable-wrapper"),i.data("control",t).data("dgtable",t),i.on("remove",function(){t.destroy()}),r.onMouseMoveResizeAreaBound=o(this._onMouseMoveResizeArea,this),r.onEndDragColumnHeaderBound=o(this._onEndDragColumnHeader,this),r.onTableScrolledHorizontallyBound=o(this._onTableScrolledHorizontally,this),this.$el.on("dragend",r.onEndDragColumnHeaderBound),r.tableSkeletonNeedsRendering=!0,l.virtualTable=void 0===e.virtualTable||!!e.virtualTable,l.rowsBufferSize=e.rowsBufferSize||3,l.minColumnWidth=Math.max(e.minColumnWidth||35,0),l.resizeAreaWidth=e.resizeAreaWidth||8,l.resizableColumns=void 0===e.resizableColumns||!!e.resizableColumns,l.movableColumns=void 0===e.movableColumns||!!e.movableColumns,l.sortableColumns=void 0===e.sortableColumns?1:parseInt(e.sortableColumns,10)||1,l.adjustColumnWidthForSortArrow=void 0===e.adjustColumnWidthForSortArrow||!!e.adjustColumnWidthForSortArrow,l.convertColumnWidthsToRelative=void 0!==e.convertColumnWidthsToRelative&&!!e.convertColumnWidthsToRelative,l.autoFillTableWidth=void 0!==e.autoFillTableWidth&&!!e.autoFillTableWidth,l.cellClasses=void 0===e.cellClasses?"":e.cellClasses,l.resizerClassName=void 0===e.resizerClassName?"dgtable-resize":e.resizerClassName,l.tableClassName=void 0===e.tableClassName?"dgtable":e.tableClassName,l.allowCellPreview=void 0===e.allowCellPreview||e.allowCellPreview,l.allowHeaderCellPreview=void 0===e.allowHeaderCellPreview||e.allowHeaderCellPreview,l.cellPreviewClassName=void 0===e.cellPreviewClassName?"dgtable-cell-preview":e.cellPreviewClassName,l.cellPreviewAutoBackground=void 0===e.cellPreviewAutoBackground||e.cellPreviewAutoBackground,l.onComparatorRequired=void 0===e.onComparatorRequired?null:e.onComparatorRequired,l.onComparatorRequired||"function"!=typeof e.comparatorCallback||(l.onComparatorRequired=e.comparatorCallback),l.width=void 0===e.width?M.Width.NONE:e.width,l.relativeWidthGrowsToFillWidth=void 0===e.relativeWidthGrowsToFillWidth||!!e.relativeWidthGrowsToFillWidth,l.relativeWidthShrinksToFillWidth=void 0!==e.relativeWidthShrinksToFillWidth&&!!e.relativeWidthShrinksToFillWidth,this.setCellFormatter(e.cellFormatter),this.setHeaderCellFormatter(e.headerCellFormatter),this.setFilter(e.filter),l.height=e.height,t.setColumns(e.columns||[],!1);let n=[];if(e.sortColumn){let t=e.sortColumn;if(t&&"object"!=typeof t&&(t=[t]),t instanceof Array||"object"==typeof t)for(let e=0,o=t.length;e<o;e++){let o=t[e];"string"==typeof o&&(o={column:o,descending:!1});let l=r.columns.get(o.column);n.push({column:o.column,comparePath:l.comparePath,descending:o.descending})}}r.rows=new a({sortColumn:n}),r.rows.onComparatorRequired=function(e,t){if(l.onComparatorRequired)return l.onComparatorRequired(e,t)},r.filteredRows=null;let s=function(e){let o=(e=e||event).fromElement||e.relatedTarget;o==this||_.contains(this,o)||this.__previewCell&&(o==this.__previewCell||_.contains(this.__previewCell,o))||t._cellMouseOverEvent.call(t,this)},d=function(e){let o=(e=e||event).toElement||e.relatedTarget;o==this||_.contains(this,o)||this.__previewCell&&(o==this.__previewCell||_.contains(this.__previewCell,o))||t._cellMouseOutEvent.call(t,this)};"addEventListener"in window?(r._bindCellHoverIn=function(e){e.__hoverIn||e.addEventListener("mouseover",e.__hoverIn=o(s,e))},r._unbindCellHoverIn=function(e){e.__hoverIn&&(e.removeEventListener("mouseover",e.__hoverIn),e.__hoverIn=null)},r._bindCellHoverOut=function(e){return e.__hoverOut||e.addEventListener("mouseout",e.__hoverOut=o(d,e.__cell||e)),this},r._unbindCellHoverOut=function(e){return e.__hoverOut&&(e.removeEventListener("mouseout",e.__hoverOut),e.__hoverOut=null),this}):(r._bindCellHoverIn=function(e){e.__hoverIn||e.attachEvent("mouseover",e.__hoverIn=o(s,e))},r._unbindCellHoverIn=function(e){e.__hoverIn&&(e.detachEvent("mouseover",e.__hoverIn),e.__hoverIn=null)},r._bindCellHoverOut=function(e){e.__hoverOut||e.attachEvent("mouseout",e.__hoverOut=o(d,e.__cell||e))},r._unbindCellHoverOut=function(e){return e.__hoverOut&&(e.detachEvent("mouseout",e.__hoverOut),e.__hoverOut=null),this})},M.prototype.on=function(e,t){let o=this.p.events;return"function"!=typeof t?this:(F.call(o,e)||(o[e]=[]),o[e].push({cb:t,once:!1}),this)},M.prototype.once=function(e,t){let o=this.p.events;return"function"!=typeof t?this:(F.call(o,e)||(o[e]=[]),o[e].push({cb:t,once:!0}),this)},M.prototype.off=function(e,t){let o=this.p.events;if(!F.call(o,e))return this;let l=o[e];for(let e=0;e<l.length;e++){let o=l[e];t&&o.cb!==t||l.splice(e--,1)}return this},M.prototype.trigger=function(e){let t=this.p.events;if(F.call(t,e)){let o=t[e];for(let e=0;e<o.length;e++){let t=o[e];t.once&&o.splice(e--,1),t.cb.apply(this,Array.prototype.slice.call(arguments,1))}}return this},M.prototype._parseColumnWidth=function(e,t){let o=Math.max(0,parseFloat(e)),l=z.AUTO;return o>0&&(e==o+"%"?(l=z.RELATIVE,o/=100):o>0&&o<1?l=z.RELATIVE:(o<t&&(o=t),l=z.ABSOLUTE)),{width:o,mode:l}},M.prototype._initColumnFromData=function(e){let t=this._parseColumnWidth(e.width,e.ignoreMin?0:this.o.minColumnWidth),o={name:e.name,label:void 0===e.label?e.name:e.label,width:t.width,widthMode:t.mode,resizable:void 0===e.resizable||e.resizable,sortable:void 0===e.sortable||e.sortable,movable:void 0===e.movable||e.movable,visible:void 0===e.visible||e.visible,cellClasses:void 0===e.cellClasses?this.o.cellClasses:e.cellClasses,ignoreMin:void 0!==e.ignoreMin&&!!e.ignoreMin};return o.dataPath=void 0===e.dataPath?o.name:e.dataPath,o.comparePath=void 0===e.comparePath?o.dataPath:e.comparePath,"string"==typeof o.dataPath&&(o.dataPath=o.dataPath.split(".")),"string"==typeof o.comparePath&&(o.comparePath=o.comparePath.split(".")),o},M.prototype.close=M.prototype.remove=M.prototype.destroy=function(){let e=this,t=e.p||{},o=e.$el;if(e.__removed)return e;if(t.$resizer&&(t.$resizer.remove(),t.$resizer=null),t.$tbody){let o=t.$tbody[0].childNodes;for(let t=0,l=o.length;t<l;t++)e.trigger("rowdestroy",o[t])}if(this._destroyHeaderCells()._unbindCellEventsForTable(),t.$table&&t.$table.empty(),t.$tbody&&t.$tbody.empty(),t.workerListeners){for(let e=0;e<t.workerListeners.length;e++){let o=t.workerListeners[e];o.worker.removeEventListener("message",o.listener,!1)}t.workerListeners.length=0}t.rows.length=t.columns.length=0,t._deferredRender&&clearTimeout(t._deferredRender);for(let t in e)F.call(e,t)&&(e[t]=null);return e.__removed=!0,o&&o.remove(),this},M.prototype._unbindCellEventsForTable=function(){const e=this.p;if(e.headerRow)for(let t=0,o=e.headerRow.childNodes,l=o.length;t<l;t++)for(let l=0,r=o[t].childNodes,i=r.length;l<i;l++)e._unbindCellHoverIn(r[l]);if(e.tbody)for(let t=0,o=e.tbody.childNodes,l=o.length;t<l;t++)this._unbindCellEventsForRow(o[t]);return this},M.prototype._unbindCellEventsForRow=function(e){const t=this.p;for(let o=0,l=e.childNodes,r=l.length;o<r;o++)t._unbindCellHoverIn(l[o]);return this},M.prototype.render=function(){const e=this.o,t=this.p;if(!this.el.offsetParent)return t._deferredRender||(t._deferredRender=setTimeout(()=>{t._deferredRender=null,!this.__removed&&this.el.offsetParent&&this.render()})),this;let l,r;if(!0===t.tableSkeletonNeedsRendering){t.tableSkeletonNeedsRendering=!1,e.width==M.Width.AUTO&&this._clearSortArrows();let i=t.table?t.table.scrollTop:0,n=t.table?t.table.scrollLeft:0;this._renderSkeletonBase()._renderSkeletonBody().tableWidthChanged(!0,!1)._renderSkeletonHeaderCells(),e.virtualTable?this._updateLastCellWidthFromScrollbar():(r=(t.filteredRows||t.rows).length,l=this.renderRows(0,r-1),t.$tbody.html("").append(l),this._updateLastCellWidthFromScrollbar(!0)),t.table.scrollTop=i,t.table.scrollLeft=n,t.header.scrollLeft=n,this._updateTableWidth(!0);for(let e=0;e<t.rows.sortColumn.length;e++)this._showSortArrow(t.rows.sortColumn[e].column,t.rows.sortColumn[e].descending);e.adjustColumnWidthForSortArrow&&t.rows.sortColumn.length?this.tableWidthChanged(!0):e.virtualTable||this.tableWidthChanged(),this.trigger("renderskeleton"),e.virtualTable&&(t.$table.on("scroll",o(this._onVirtualTableScrolled,this)),this.render())}else if(e.virtualTable){r=(t.filteredRows||t.rows).length;let o=t.table.scrollTop,i=Math.floor((o-t.virtualRowHeightFirst)/t.virtualRowHeight)+1-e.rowsBufferSize,n=Math.ceil((o-t.virtualRowHeightFirst+t.visibleHeight)/t.virtualRowHeight)+e.rowsBufferSize;i<0&&(i=0),n>=r&&(n=r-1);let s,a=-1,d=-1,h=t.tbody.childNodes;if(h.length&&(a=h[0].rowIndex,d=h[h.length-1].rowIndex),-1!==a&&a<i){s=Math.min(d+1,i)-a;for(let e=0;e<s;e++)this.trigger("rowdestroy",h[0]),this._unbindCellEventsForRow(h[0]),t.tbody.removeChild(h[0]);(a+=s)>d&&(a=d=-1)}else if(-1!==d&&d>n){s=d-Math.max(a-1,n);for(let e=0;e<s;e++)this.trigger("rowdestroy",h[h.length-1]),this._unbindCellEventsForRow(h[h.length-1]),t.tbody.removeChild(h[h.length-1]);d<a&&(a=d=-1)}i<a&&(l=this.renderRows(i,Math.min(n,a-1)),t.$tbody.prepend(l)),(n>d||-1===d)&&(l=this.renderRows(-1===d?i:d+1,n),t.$tbody.append(l))}return this.trigger("render"),this},M.prototype.clearAndRender=function(e){return this.p.tableSkeletonNeedsRendering=!0,(void 0===e||e)&&this.render(),this},M.prototype.renderRows=function(e,t){const o=this.o,l=this.p;let r,i,n=o.tableClassName,s=n+"-row",a=n+"-cell",d=l.filteredRows||l.rows,h=!!l.filteredRows,u=o.allowCellPreview,c=l.visibleColumns,p=o.virtualTable,m=l.virtualRowHeightFirst,f=l.virtualRowHeight,g=c.length;for(let e,t=0;t<g;t++)(e=c[t])._finalWidth=e.actualWidthConsideringScrollbarWidth||e.actualWidth;let b=document.createDocumentFragment(),v=this._isTableRtl()?"right":"left";for(let o=e,n=d.length;o<n&&o<=t;o++){let e=d[o];i=h?e.__i:o;let t=N("div");t.className=s,t.rowIndex=o,t.physicalRowIndex=i;for(let o=0;o<g;o++){let r=c[o],i=N("div");i.columnName=r.name,i.setAttribute("data-column",r.name),i.className=a,i.style.width=r._finalWidth+"px",r.cellClasses&&(i.className+=" "+r.cellClasses),u&&l._bindCellHoverIn(i),i.appendChild(N("div")).innerHTML=this._getHtmlForCell(e,r),t.appendChild(i)}p&&(r=o>0?m+(o-1)*f:0,t.style.position="absolute",t.style[v]=0,t.style.top=r+"px"),b.appendChild(t),this.trigger("rowcreate",o,i,t,e)}return b},M.prototype._calculateVirtualHeight=function(){let e=this.p;if(e.tbody){let t=(e.filteredRows||e.rows).length,o=e.virtualRowHeight*t;t&&(o+=e.virtualRowHeightFirst-e.virtualRowHeight,o+=e.virtualRowHeightLast-e.virtualRowHeight),o<1&&(o=1),e.tbody.style.height=o+"px"}return this},M.prototype._calculateTbodyWidth=function(){const e=this.p;let t,o,l,r,i=this.o.tableClassName,n=i+"-row",s=i+"-cell",a=e.visibleColumns,d=a.length,h=_("<div>").addClass(n).css("float","left"),u=0;for(l=0;l<d;l++)r=a[l],(t=N("div")).className=s,t.style.width=r.actualWidth+"px",r.cellClasses&&(t.className+=" "+r.cellClasses),o=t.appendChild(N("div")),h.append(t),u+=r.actualWidth;let c=_("<div>").addClass(this.el.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px",float:"left",width:"1px",overflow:"hidden"}).append(_("<div>").addClass(i).append(_("<div>").addClass(i+"-body").css("width",u+1e4).append(h)));c.appendTo(document.body);let p=_('<div style="border:1.5px solid #000;width:0;height:0;position:absolute;left:0;top:-9999px">').appendTo(document.body),m=parseFloat(p.css("border-width"));m=Math.round(m)!=m,p.remove();let f=b.outerWidth(h);return f-=e.scrollbarWidth||0,m&&f++,c.remove(),f},M.prototype.setColumns=function(e,t){const o=this.p;e=e||[];let l=new u;for(let t=0,o=0;t<e.length;t++){let r=e[t],i=this._initColumnFromData(r);void 0!==r.order?(r.order>o&&(o=r.order+1),i.order=r.order):i.order=o++,l.push(i)}return l.normalizeOrder(),o.columns=l,o.visibleColumns=l.getVisibleColumns(),this._ensureVisibleColumns().clearAndRender(t),this},M.prototype.addColumn=function(e,t,o){const l=this.p;let r=l.columns;if(e&&!r.get(e.name)){let i=null;void 0!==t&&(i=r.get(t)||r.getByOrder(t));let n=this._initColumnFromData(e);n.order=i?i.order:r.getMaxOrder()+1;for(let e=r.getMaxOrder(),t=n.order;e>=t;e--){let t=r.getByOrder(e);t&&t.order++}r.push(n),r.normalizeOrder(),l.visibleColumns=r.getVisibleColumns(),this._ensureVisibleColumns().clearAndRender(o),this.trigger("addcolumn",n.name)}return this},M.prototype.removeColumn=function(e,t){const o=this.p;let l=o.columns,r=l.indexOf(e);return r>-1&&(l.splice(r,1),l.normalizeOrder(),o.visibleColumns=l.getVisibleColumns(),this._ensureVisibleColumns().clearAndRender(t),this.trigger("removecolumn",e)),this},M.prototype.setCellFormatter=function(e){return this.o.cellFormatter=e||function(e){return e},this},M.prototype.setHeaderCellFormatter=function(e){return this.o.headerCellFormatter=e||function(e){return e},this},M.prototype.setFilter=function(e){return this.o.filter=e,this},M.prototype.filter=function(e){const t=this.p;let o=this.o.filter||y;"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&(e={column:arguments[0],keyword:arguments[1],caseSensitive:arguments[2]});let l=!!t.filteredRows;return t.filteredRows&&(t.filteredRows=null),t.filterArgs="object"!=typeof e||Array.isArray(e)?e:_.extend({},e),t.filteredRows=t.rows.filteredCollection(o,e),(l||t.filteredRows)&&(this.clearAndRender(),this.trigger("filter",e)),this},M.prototype._refilter=function(){const e=this.p;if(e.filteredRows&&e.filterArgs){let t=this.o.filter||y;e.filteredRows=e.rows.filteredCollection(t,e.filterArgs)}return this},M.prototype.setColumnLabel=function(e,t){let o=this.p.columns.get(e);if(o&&(o.label=void 0===t?o.name:t,o.element))for(let e=0;e<o.element[0].firstChild.childNodes.length;e++){let t=o.element[0].firstChild.childNodes[e];if(3===t.nodeType){t.textContent=o.label;break}}return this},M.prototype.moveColumn=function(e,t){const o=this.o,l=this.p;let r,i,n=l.columns;if("string"==typeof e?r=n.get(e):"number"==typeof e&&(r=l.visibleColumns[e]),"string"==typeof t?i=n.get(t):"number"==typeof t&&(i=l.visibleColumns[t]),r&&i&&e!==t){let e=r.order,t=i.order;if(l.visibleColumns=n.moveColumn(r,i).getVisibleColumns(),this._ensureVisibleColumns(),o.virtualTable)this.clearAndRender()._updateLastCellWidthFromScrollbar(!0);else{let r=l.$headerRow.find(">div."+o.tableClassName+"-header-cell"),i=e<t?t+1:t,n=e;r[0].parentNode.insertBefore(r[n],r[i]);let s=l.visibleColumns[e];s=(s.actualWidthConsideringScrollbarWidth||s.actualWidth)+"px";let a=l.visibleColumns[t];a=(a.actualWidthConsideringScrollbarWidth||a.actualWidth)+"px";let d=l.$tbody[0].childNodes;for(let o=0,l=d.length;o<l;o++){let l=d[o];1===l.nodeType&&(l.insertBefore(l.childNodes[n],l.childNodes[i]),l.childNodes[t].firstChild.style.width=a,l.childNodes[e].firstChild.style.width=s)}}this.trigger("movecolumn",r.name,e,t)}return this},M.prototype.sort=function(e,t,o){const l=this.o,r=this.p;let i=r.columns.get(e),n=r.rows.sortColumn;if(i){if(n.length&&n[n.length-1].column==e&&(t=void 0===t?!n[n.length-1].descending:t),o){for(let e=0;e<n.length;e++)if(n[e].column==i.name){e<n.length-1?n.length=0:n.splice(n.length-1,1);break}(l.sortableColumns>0&&n.length>=l.sortableColumns||n.length>=r.visibleColumns.length)&&(n.length=0)}else n.length=0;t=void 0!==t&&t,n.push({column:i.name,comparePath:i.comparePath,descending:!!t})}else n.length=0;this._clearSortArrows();for(let e=0;e<n.length;e++)this._showSortArrow(n[e].column,n[e].descending);if(l.adjustColumnWidthForSortArrow&&!l._tableSkeletonNeedsRendering&&this.tableWidthChanged(!0),l.virtualTable)for(;r.tbody&&r.tbody.firstChild;)this.trigger("rowdestroy",r.tbody.firstChild),this._unbindCellEventsForRow(r.tbody.firstChild),r.tbody.removeChild(r.tbody.firstChild);else r.tableSkeletonNeedsRendering=!0;r.rows.sortColumn=n,n.length&&(r.rows.sort(!!r.filteredRows),r.filteredRows&&r.filteredRows.sort(!!r.filteredRows));let s=[];for(let e=0;e<n.length;e++)s.push({column:n[e].column,descending:n[e].descending});return this.trigger("sort",s),this},M.prototype.resort=function(){const e=this.p;let t=e.columns,o=e.rows.sortColumn;if(o.length){for(let e=0;e<o.length;e++)t.get(o[e].column)||o.splice(e--,1);e.rows.sortColumn=o,o.length&&(e.rows.sort(!!e.filteredRows),e.filteredRows&&e.filteredRows.sort(!!e.filteredRows));let l=[];for(let e=0;e<o.length;e++)l.push({column:o[e].column,descending:o[e].descending});this.trigger("sort",l)}return this},M.prototype._ensureVisibleColumns=function(){const e=this.p;return 0===e.visibleColumns.length&&e.columns.length&&(e.columns[0].visible=!0,e.visibleColumns.push(e.columns[0]),this.trigger("showcolumn",e.columns[0].name)),this},M.prototype.setColumnVisible=function(e,t){const o=this.p;let l=o.columns.get(e);return t=!!t,l&&!!l.visible!=t&&(l.visible=t,o.visibleColumns=o.columns.getVisibleColumns(),this.trigger(t?"showcolumn":"hidecolumn",e),this._ensureVisibleColumns(),this.clearAndRender()),this},M.prototype.isColumnVisible=function(e){let t=this.p.columns.get(e);return!!t&&t.visible},M.prototype.setMinColumnWidth=function(e){let t=this.o;return e=Math.max(e,0),t.minColumnWidth!=e&&(t.minColumnWidth=e,this.tableWidthChanged(!0)),this},M.prototype.getMinColumnWidth=function(){return this.o.minColumnWidth},M.prototype.setSortableColumns=function(e){const t=this.p,o=this.o;if(o.sortableColumns!=e&&(o.sortableColumns=e,t.$table)){let e=t.$headerRow.find(">div."+o.tableClassName+"-header-cell");for(let l=0;l<e.length;l++)_(e[0])[o.sortableColumns>0&&t.visibleColumns[l].sortable?"addClass":"removeClass"]("sortable")}return this},M.prototype.getSortableColumns=function(){return this.o.sortableColumns},M.prototype.setMovableColumns=function(e){let t=this.o;return e=void 0===e||!!e,t.movableColumns!=e&&(t.movableColumns=e),this},M.prototype.getMovableColumns=function(){return this.o.movableColumns},M.prototype.setResizableColumns=function(e){let t=this.o;return e=void 0===e||!!e,t.resizableColumns!=e&&(t.resizableColumns=e),this},M.prototype.getResizableColumns=function(){return this.o.resizableColumns},M.prototype.setComparatorCallback=function(e){let t=this.o;return t.onComparatorRequired!=e&&(t.onComparatorRequired=e),this},M.prototype.setColumnWidth=function(e,t){let o=this.p.columns.get(e),l=this._parseColumnWidth(t,o.ignoreMin?0:this.o.minColumnWidth);if(o){let e=this._serializeColumnWidth(o);o.width=l.width,o.widthMode=l.mode;let t=this._serializeColumnWidth(o);e!=t&&this.tableWidthChanged(!0),this.trigger("columnwidth",o.name,e,t)}return this},M.prototype.getColumnWidth=function(e){let t=this.p.columns.get(e);return t?this._serializeColumnWidth(t):null},M.prototype.getColumnConfig=function(e){let t=this.p.columns.get(e);return t?{order:t.order,width:this._serializeColumnWidth(t),visible:t.visible,label:t.label}:null},M.prototype.getColumnsConfig=function(){const e=this.p;let t={};for(let o=0;o<e.columns.length;o++)t[e.columns[o].name]=this.getColumnConfig(e.columns[o].name);return t},M.prototype.getSortedColumns=function(){const e=this.p;let t=[];for(let o=0;o<e.rows.sortColumn.length;o++){let l=e.rows.sortColumn[o];t.push({column:l.column,descending:l.descending})}return t},M.prototype.getHtmlForCell=function(e,t){const o=this.p;if(e<0||e>o.rows.length-1)return null;let l=o.columns.get(t);if(!l)return null;let r=o.rows[e],i=l.dataPath,n=r[i[0]];for(let e=1;e<i.length;e++)n=n[i[e]];let s=this.o.cellFormatter(n,l.name,r);return void 0===s&&(s=""),s},M.prototype._getHtmlForCell=function(e,t){let o=t.dataPath,l=e[o[0]];for(let e=1;e<o.length&&null!=l;e++)l=l&&l[o[e]];let r=this.o.cellFormatter(l,t.name,e);return void 0===r&&(r=""),r},M.prototype.getRowYPos=function(e){const t=this.p;if(this.o.virtualTable)return e>0?t.virtualRowHeightFirst+(e-1)*t.virtualRowHeight:0;{let o=t.tbody.childNodes[e];return o?o.offsetTop:null}},M.prototype.getDataForRow=function(e){const t=this.p;return e<0||e>t.rows.length-1?null:t.rows[e]},M.prototype.getRowCount=function(){const e=this.p;return e.rows?e.rows.length:0},M.prototype.getIndexForRow=function(e){return this.p.rows.indexOf(e)},M.prototype.getFilteredRowCount=function(){const e=this.p;return(e.filteredRows||e.rows).length},M.prototype.getIndexForFilteredRow=function(e){const t=this.p;return(t.filteredRows||t.rows).indexOf(e)},M.prototype.getDataForFilteredRow=function(e){const t=this.p;return e<0||e>(t.filteredRows||t.rows).length-1?null:(t.filteredRows||t.rows)[e]},M.prototype.getHeaderRowElement=function(){return this.p.headerRow},M.prototype._horizontalPadding=function(e){return(parseFloat(_.css(e,"padding-left"))||0)+(parseFloat(_.css(e,"padding-right"))||0)},M.prototype._horizontalBorderWidth=function(e){return(parseFloat(_.css(e,"border-left"))||0)+(parseFloat(_.css(e,"border-right"))||0)},M.prototype._calculateWidthAvailableForColumns=function(){const e=this.o,t=this.p;let o,l,r;t.$table&&(l=t.table?t.table.scrollTop:0,r=t.table?t.table.scrollLeft:0,e.virtualTable&&(o=t.$table[0].style.display,t.$table[0].style.display="none"));let i=b.width(this.$el);t.$table&&(e.virtualTable&&(t.$table[0].style.display=o),t.table.scrollTop=l,t.table.scrollLeft=r,t.header.scrollLeft=r);let n=e.tableClassName,s=_("<div>").addClass(this.el.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px"}),a=_("<div>").addClass(n+"-header").appendTo(s),d=_("<div>").addClass(n+"-header-row").appendTo(a);for(let e=0;e<t.visibleColumns.length;e++)d.append(_("<div><div></div></div>").addClass(n+"-header-cell").addClass(t.visibleColumns[e].cellClasses||""));s.appendTo(document.body),i-=this._horizontalBorderWidth(d[0]);let h=d.find(">div."+n+"-header-cell");for(let e=0;e<h.length;e++){let t=_(h[e]);"border-box"===t.css("boxSizing")||(i-=(parseFloat(t.css("border-right-width"))||0)+(parseFloat(t.css("border-left-width"))||0)+this._horizontalPadding(t[0]))}return s&&s.remove(),Math.max(0,i)},M.prototype.tableWidthChanged=function(){let e=function(e){let t,o=this.o.tableClassName,l=_("<div>").addClass(this.$el).append(_("<div>").addClass(o+"-header").append(_("<div>").addClass(o+"-header-row").append(t=_("<div>").addClass(o+"-header-cell").append(_("<div>").text(e))))).css({position:"absolute",top:"-9999px",visibility:"hidden"});l.appendTo(document.body);let r=b.width(t);return l.remove(),r},t=null;return function(o,l){let r=this.o,i=this.p,n=this._calculateWidthAvailableForColumns(),s=n,a=0;l=void 0===l||l;let d=0;if(i.tbody||(l=!1),l&&(d=parseFloat(i.tbody.style.minWidth)||0),s!=t||o){t=n;let o=0,h=[],u=0;for(let e=0;e<i.columns.length;e++)i.columns[e].actualWidthConsideringScrollbarWidth=null;for(let t=0;t<i.visibleColumns.length;t++){let l=i.visibleColumns[t];if(l.widthMode===z.ABSOLUTE){let e=l.width;e+=l.arrowProposedWidth||0,!l.ignoreMin&&e<r.minColumnWidth&&(e=r.minColumnWidth),s-=e,o+=e,e!==l.actualWidth&&(l.actualWidth=e,h.push(t))}else if(l.widthMode===z.AUTO){let i=e.call(this,l.label)+20;i+=l.arrowProposedWidth||0,!l.ignoreMin&&i<r.minColumnWidth&&(i=r.minColumnWidth),s-=i,o+=i,i!==l.actualWidth&&(l.actualWidth=i,r.convertColumnWidthsToRelative||h.push(t))}else l.widthMode===z.RELATIVE&&(u+=l.width,a++)}if(r.convertColumnWidthsToRelative)for(let e=0;e<i.visibleColumns.length;e++){let t=i.visibleColumns[e];t.widthMode===z.AUTO&&(t.widthMode=z.RELATIVE,s+=t.actualWidth,t.width=t.actualWidth/o,u+=t.width,a++)}if(a&&(u<1&&r.relativeWidthGrowsToFillWidth||u>1&&r.relativeWidthShrinksToFillWidth))for(let e=0;e<i.visibleColumns.length;e++){let t=i.visibleColumns[e];t.widthMode===z.RELATIVE&&(t.width/=u)}let c=Math.max(0,s);0===c&&(c=i.table.clientWidth);let p=r.minColumnWidth/c;if(isNaN(p)&&(p=0),p>0){let e,t=0;for(let e=0;e<i.visibleColumns.length;e++){let o=i.visibleColumns[e];o.widthMode===z.RELATIVE&&!o.ignoreMin&&o.width<p&&(t+=p-o.width,o.width=p)}for(let o=0;o<i.visibleColumns.length;o++){let l=i.visibleColumns[o];l.widthMode===z.RELATIVE&&!l.ignoreMin&&l.width>p&&t>0&&(e=Math.min(t,l.width-p),l.width-=e,t-=e)}}if(r.autoFillTableWidth&&s>0){let e=0,t=s;for(let o=0;o<i.visibleColumns.length;o++){let l=i.visibleColumns[o];l.resizable||l.widthMode!==z.ABSOLUTE||(e+=l.width),l.widthMode===z.RELATIVE&&(t-=Math.round(c*l.width))}let o=(n-e)/(n-t-e)||NaN;for(let e=0;e<i.visibleColumns.length&&t>0;e++){let t=i.visibleColumns[e];if(t.resizable||t.widthMode!==z.ABSOLUTE)if(t.widthMode===z.RELATIVE)t.width*=o;else{let l=t.actualWidth*o;t.actualWidth!==l&&(t.actualWidth=l,-1===h.indexOf(e)&&h.push(e))}}}for(let e=0;e<i.visibleColumns.length;e++){let t=i.visibleColumns[e];if(t.widthMode===z.RELATIVE){let o=Math.round(c*t.width);s-=o,0==--a&&1===s&&(o++,s--),-1===s&&(o--,s++),o!==t.actualWidth&&(t.actualWidth=o,h.push(e))}}if(i.visibleColumns.length&&(i.visibleColumns[i.visibleColumns.length-1].actualWidthConsideringScrollbarWidth=i.visibleColumns[i.visibleColumns.length-1].actualWidth-(i.scrollbarWidth||0)),l){let e=this._calculateTbodyWidth();d<e&&this._updateTableWidth(!1);for(let e=0;e<h.length;e++)this._resizeColumnElements(h[e]);d>e&&this._updateTableWidth(!1)}}return this}}(),M.prototype.tableHeightChanged=function(){let e=this.o,t=this.p;if(!t.$table)return this;let o=b.innerHeight(this.$el)-(parseFloat(t.$table.css("border-top-width"))||0)-(parseFloat(t.$table.css("border-bottom-width"))||0);return o!=e.height&&(e.height=o,t.tbody&&(t.tbody.style.height=Math.max(e.height-b.outerHeight(t.$headerRow),1)+"px"),e.virtualTable&&this.clearAndRender()),this},M.prototype.addRows=function(e,t,o,l){let r=this,i=r.p;if("boolean"==typeof t&&(l=o,o=t,t=-1),"number"!=typeof t&&(t=-1),(t<0||t>i.rows.length)&&(t=i.rows.length),l=void 0===l||!!l,e){if(i.rows.add(e,t),i.filteredRows||o&&i.rows.sortColumn.length)o&&i.rows.sortColumn.length?this.resort():this._refilter(),i.tableSkeletonNeedsRendering=!0,l&&this.render();else if(l){let o=i.tbody.childNodes;if(r.o.virtualTable){for(;i.tbody.firstChild;)this.trigger("rowdestroy",i.tbody.firstChild),this._unbindCellEventsForRow(i.tbody.firstChild),i.tbody.removeChild(i.tbody.firstChild);this._calculateVirtualHeight()._updateLastCellWidthFromScrollbar().render()._updateTableWidth(!1)}else if(i.$tbody){let l=t,n=t+e.length-1,s=r.renderRows(l,n);i.tbody.insertBefore(s,o[t]||null);for(let t=n+1;t<o.length;t++){let l=o[t];l.rowIndex+=e.length,l.physicalRowIndex+=e.length}this.render()._updateLastCellWidthFromScrollbar()._updateTableWidth(!0)}}this.trigger("addrows",e.length,!1)}return this},M.prototype.removeRows=function(e,t,o){let l=this.p;if("number"!=typeof t||t<=0)return this;if(e<0||e>l.rows.length-1)return this;if(l.rows.splice(e,t),o=void 0===o||!!o,l.filteredRows)this._refilter(),l.tableSkeletonNeedsRendering=!0,o&&this.render();else if(o){let o=l.tbody.childNodes;if(this.o.virtualTable){for(;l.tbody.firstChild;)this.trigger("rowdestroy",l.tbody.firstChild),this._unbindCellEventsForRow(l.tbody.firstChild),l.tbody.removeChild(l.tbody.firstChild);this._calculateVirtualHeight()._updateLastCellWidthFromScrollbar().render()._updateTableWidth(!1)}else{let r=e+t-1;for(let i=0;i<o.length;i++){let n=o[i],s=n.physicalRowIndex;s>=e?s<=r?(this.trigger("rowdestroy",n),this._unbindCellEventsForRow(n),l.tbody.removeChild(n),i--):n.physicalRowIndex-=t:n.rowIndex=i}this.render()._updateLastCellWidthFromScrollbar()._updateTableWidth(!0)}}return this},M.prototype.removeRow=function(e,t){return this.removeRows(e,1,t)},M.prototype.refreshRow=function(e){let t=this.p;if(e<0||e>t.rows.length-1)return this;let o=-1;if(t.filteredRows&&-1===(o=r(t.filteredRows,t.rows[e])))return this;-1===o&&(o=e);let l=t.tbody.childNodes;if(this.o.virtualTable){let r=!1,i=0;for(;i<l.length;i++)if(l[i].physicalRowIndex===e){r=!0,this.trigger("rowdestroy",l[i]),this._unbindCellEventsForRow(l[i]),t.tbody.removeChild(l[i]);break}if(r){let e=this.renderRows(o,o);t.tbody.insertBefore(e,l[i]||null)}}else{this.trigger("rowdestroy",l[o]),this._unbindCellEventsForRow(l[o]),t.tbody.removeChild(l[o]);let e=this.renderRows(o,o);t.tbody.insertBefore(e,l[o]||null)}return this},M.prototype.getRowElement=function(e){let t=this.p;if(e<0||e>t.rows.length-1)return null;let o=-1;if(t.filteredRows&&-1===(o=r(t.filteredRows,t.rows[e])))return this;-1===o&&(o=e);let l=t.tbody.childNodes;if(!this.o.virtualTable)return l[o];for(let t=0;t<l.length;t++)if(l[t].physicalRowIndex===e)return l[t];return null},M.prototype.refreshAllVirtualRows=function(){const e=this.p;if(this.o.virtualTable){let t=[],o=e.tbody.childNodes;for(let l=0,r=o.length;l<r;l++)t.push(o[l].physicalRowIndex),this.trigger("rowdestroy",o[l]),this._unbindCellEventsForRow(o[l]),e.tbody.removeChild(o[l]),l--,r--;for(let o=0;o<t.length;o++){let l=this.renderRows(t[o],t[o]);e.tbody.appendChild(l)}}return this},M.prototype.setRows=function(e,t){let o=this.p;return o.rows.reset(e),t&&o.rows.sortColumn.length?this.resort():this._refilter(),this.clearAndRender().trigger("addrows",e.length,!0),this},M.prototype.getUrlForElementContent=function(e){let t,o=document.getElementById(e);if(o){let e=o.textContent;if("function"==typeof Blob)t=new Blob([e]);else{let o=global.BlobBuilder||global.WebKitBlobBuilder||global.MozBlobBuilder||global.MSBlobBuilder;if(!o)return null;let l=new o;l.append(e),t=l.getBlob()}return(global.URL||global.webkitURL).createObjectURL(t)}return null},M.prototype.isWorkerSupported=function(){return global.Worker instanceof Function},M.prototype.createWebWorker=function(e,t,o){if(this.isWorkerSupported()){let l=this,r=l.p,i=new Worker(e),n=function(e){e.data.append?l.addRows(e.data.rows,o):l.setRows(e.data.rows,o)};return i.addEventListener("message",n,!1),r.workerListeners||(r.workerListeners=[]),r.workerListeners.push({worker:i,listener:n}),(t||void 0===t)&&i.postMessage(null),i}return null},M.prototype.unbindWebWorker=function(e){let t=this.p;if(t.workerListeners)for(let o=0;o<t.workerListeners.length;o++)t.workerListeners[o].worker==e&&(e.removeEventListener("message",t.workerListeners[o].listener,!1),t.workerListeners.splice(o,1),o--);return this},M.prototype.abortCellPreview=function(){return this.hideCellPreview(),this},M.prototype.cancelColumnResize=function(){const e=this.p;return e.$resizer&&(e.$resizer.remove(),e.$resizer=null,_(document).off("mousemove.dgtable",e.onMouseMoveResizeAreaBound).off("mouseup.dgtable",e.onEndDragColumnHeaderBound)),this},M.prototype._onVirtualTableScrolled=function(e){this.render()},M.prototype._onTableScrolledHorizontally=function(e){const t=this.p;t.header.scrollLeft=t.table.scrollLeft},M.prototype._getColumnByResizePosition=function(e){let t=this.o,o=this._isTableRtl(),l=_(e.target).closest("div."+t.tableClassName+"-header-cell,div."+t.cellPreviewClassName),r=l[0];r.__cell&&(r=r.__cell,l=_(r));let i=l[0].previousSibling;for(;i&&1!=i.nodeType;)i=i.previousSibling;let n=!i,s=((null!=e.pageX?e.pageX:e.originalEvent.pageX)||e.originalEvent.clientX)-l.offset().left;if(o){if(!n&&b.outerWidth(l)-s<=t.resizeAreaWidth/2)return i.columnName;if(s<=t.resizeAreaWidth/2)return r.columnName}else{if(!n&&s<=t.resizeAreaWidth/2)return i.columnName;if(b.outerWidth(l)-s<=t.resizeAreaWidth/2)return r.columnName}return null},M.prototype._onTouchStartColumnHeader=function(e){const t=this.p;if(t.currentTouchId)return;let o=e.originalEvent.changedTouches[0];t.currentTouchId=o.identifier;let l,r=_(e.currentTarget),i={x:o.pageX,y:o.pageY},s=i,a=function(){t.currentTouchId=null,r.off("touchend").off("touchcancel"),clearTimeout(l)},d=function(t){let o=_.Event(t),l=Array.prototype.slice.call(arguments,1);return _.each(["target","clientX","clientY","offsetX","offsetY","screenX","screenY","pageX","pageY","which"],function(){o[this]=e[this];for(let e=0;e<l.length;e++)null!=l[e][this]&&(o[this]=l[e][this])}),o};r.trigger(d("mousedown",e.originalEvent.changedTouches[0],{which:1})),l=setTimeout(()=>{a(),r.one("touchend",e=>{e.preventDefault(),r.off("touchend").off("touchcancel")}).one("touchcancel",e=>{r.off("touchend").off("touchcancel")}),Math.sqrt(Math.pow(Math.abs(s.x-i.x),2)+Math.pow(Math.abs(s.y-i.y),2))<9&&(this.cancelColumnResize(),r.trigger(d("mouseup",e.originalEvent.changedTouches[0],{which:3})))},500),r.on("touchend",e=>{let o=n(e.originalEvent.changedTouches,e=>e.identifier===t.currentTouchId);o&&(a(),e.preventDefault(),s={x:o.pageX,y:o.pageY},(Math.sqrt(Math.pow(Math.abs(s.x-i.x),2)+Math.pow(Math.abs(s.y-i.y),2))<9||t.$resizer)&&(r.trigger(d("mouseup",o,{which:1})),r.trigger(d("click",o,{which:1}))))}).on("touchcancel",()=>{a()}).on("touchmove",e=>{let o=n(e.originalEvent.changedTouches,e=>e.identifier===t.currentTouchId);o&&(s={x:o.pageX,y:o.pageY},t.$resizer&&(e.preventDefault(),r.trigger(d("mousemove",o))))})},M.prototype._onMouseDownColumnHeader=function(e){if(1!==e.which)return this;let t=this.o,o=this.p,l=this._getColumnByResizePosition(e);if(l){let r=o.columns.get(l);if(!t.resizableColumns||!r||!r.resizable)return!1;let i=this._isTableRtl();o.$resizer&&_(o.$resizer).remove(),o.$resizer=_("<div></div>").addClass(t.resizerClassName).css({position:"absolute",display:"block","z-index":-1,visibility:"hidden",width:"2px",background:"#000",opacity:.7}).appendTo(this.$el);let n=r.element,s=o.$resizer.parent(),a=n.offset(),d=s.offset();8===W&&(a=n.offset()),d.left+=parseFloat(s.css("border-left-width"))||0,d.top+=parseFloat(s.css("border-top-width"))||0,a.left-=d.left,a.top-=d.top,a.top-=parseFloat(n.css("border-top-width"))||0;let h=b.outerWidth(o.$resizer);i?(a.left-=Math.ceil((parseFloat(n.css("border-left-width"))||0)/2),a.left-=Math.ceil(h/2)):(a.left+=b.outerWidth(n),a.left+=Math.ceil((parseFloat(n.css("border-right-width"))||0)/2),a.left-=Math.ceil(h/2)),o.$resizer.css({"z-index":"10",visibility:"visible",left:a.left,top:a.top,height:b.height(this.$el)})[0].columnName=n[0].columnName;try{o.$resizer[0].style.zIndex=""}catch(e){}_(document).on("mousemove.dgtable",o.onMouseMoveResizeAreaBound),_(document).on("mouseup.dgtable",o.onEndDragColumnHeaderBound),e.preventDefault()}},M.prototype._onMouseMoveColumnHeader=function(e){let t=this.o,o=this.p;if(t.resizableColumns){let l=this._getColumnByResizePosition(e),r=_(e.target).closest("div."+t.tableClassName+"-header-cell,div."+t.cellPreviewClassName)[0];l&&o.columns.get(l).resizable?r.style.cursor="e-resize":r.style.cursor=""}},M.prototype._onMouseUpColumnHeader=function(e){if(3===e.which){let t=this.o,o=_(e.target).closest("div."+t.tableClassName+"-header-cell,div."+t.cellPreviewClassName),l=o.offset();l.width=b.outerWidth(o),l.height=b.outerHeight(o),this.trigger("headercontextmenu",o[0].columnName,e.pageX,e.pageY,l)}return this},M.prototype._onMouseLeaveColumnHeader=function(e){let t=this.o;_(e.target).closest("div."+t.tableClassName+"-header-cell,div."+t.cellPreviewClassName)[0].style.cursor=""},M.prototype._onClickColumnHeader=function(e){if(!this._getColumnByResizePosition(e)){let t=this,o=t.o,l=t.p,r=_(e.target).closest("div."+o.tableClassName+"-header-cell,div."+o.cellPreviewClassName)[0];if(o.sortableColumns){let e=l.columns.get(r.columnName);e&&e.sortable&&this.sort(r.columnName,void 0,!0).render()}}},M.prototype._onStartDragColumnHeader=function(e){let t=this.o,o=this.p;if(t.movableColumns){let l=_(e.target).closest("div."+t.tableClassName+"-header-cell,div."+t.cellPreviewClassName),r=o.columns.get(l[0].columnName);r&&r.movable?(l[0].style.opacity=.35,o.dragId=161061273*Math.random(),e.originalEvent.dataTransfer.setData("text",JSON.stringify({dragId:o.dragId,column:r.name}))):e.preventDefault()}else e.preventDefault()},M.prototype._onMouseMoveResizeArea=function(e){let t=this.p,o=t.columns.get(t.$resizer[0].columnName),l=this._isTableRtl(),r=o.element,i=t.$resizer.parent(),n=r.offset(),s=i.offset();s.left+=parseFloat(i.css("border-left-width"))||0,n.left-=s.left;let a=b.outerWidth(t.$resizer),d="border-box"===r.css("box-sizing"),h=e.pageX-s.left,u=n.left;u-=Math.ceil(a/2),l?(u+=b.outerWidth(r),u-=o.ignoreMin?0:this.o.minColumnWidth,d||(u-=Math.ceil((parseFloat(r.css("border-left-width"))||0)/2),u-=this._horizontalPadding(r[0])),h>u&&(h=u)):(u+=o.ignoreMin?0:this.o.minColumnWidth,d||(u+=Math.ceil((parseFloat(r.css("border-right-width"))||0)/2),u+=this._horizontalPadding(r[0])),h<u&&(h=u)),t.$resizer.css("left",h+"px")},M.prototype._onEndDragColumnHeader=function(e){let t=this.o,o=this.p;if(o.$resizer){_(document).off("mousemove.dgtable",o.onMouseMoveResizeAreaBound).off("mouseup.dgtable",o.onEndDragColumnHeaderBound);let l=o.columns.get(o.$resizer[0].columnName),r=this._isTableRtl(),i=l.element,n=o.$resizer.parent(),s=i.offset(),a=n.offset();a.left+=parseFloat(n.css("border-left-width"))||0,s.left-=a.left;let d=b.outerWidth(o.$resizer),h="border-box"===i.css("box-sizing"),u=e.pageX-a.left,c=s.left,p=s.left,m=0;c-=Math.ceil(d/2),r?(h||(u+=this._horizontalPadding(i[0]),u+=parseFloat(i.css("border-left-width"))||0,u+=parseFloat(i.css("border-right-width"))||0),u>(p=(c+=b.outerWidth(i))-(l.ignoreMin?0:this.o.minColumnWidth))&&(u=p),m=c-u):(h||(u-=this._horizontalPadding(i[0]),u-=parseFloat(i.css("border-left-width"))||0,u-=parseFloat(i.css("border-right-width"))||0),u<(p=c+(l.ignoreMin?0:this.o.minColumnWidth))&&(u=p),m=u-c),o.$resizer.remove(),o.$resizer=null;let f=m;if(l.widthMode===z.RELATIVE){let e=this._calculateWidthAvailableForColumns(),r=0,i=0;for(let t=0;t<o.visibleColumns.length;t++){let n=o.visibleColumns[t];n.name!==l.name&&(n.widthMode==z.RELATIVE?(r+=n.width,i++):e-=n.actualWidth)}if(f=m/(e=Math.max(1,e)),i>0){let e=f/((1-f)/r);((r+=f)<1&&t.relativeWidthGrowsToFillWidth||r>1&&t.relativeWidthShrinksToFillWidth)&&(f=e)}f*=100,f+="%"}this.setColumnWidth(l.name,f)}else e.target.style.opacity=null},M.prototype._onDragEnterColumnHeader=function(e){let t=this.o,o=this.p;if(t.movableColumns){let l=e.originalEvent.dataTransfer.getData("text");l=l?JSON.parse(l):null;let r=_(e.target).closest("div."+t.tableClassName+"-header-cell,div."+t.cellPreviewClassName);if(!l||o.dragId==l.dragId&&r.columnName!==l.column){let e=o.columns.get(r[0].columnName);e&&(e.movable||e!=o.visibleColumns[0])&&_(r).addClass("drag-over")}}},M.prototype._onDragOverColumnHeader=function(e){e.preventDefault()},M.prototype._onDragLeaveColumnHeader=function(e){let t=this.o,o=_(e.target).closest("div."+t.tableClassName+"-header-cell,div."+t.cellPreviewClassName);_(o[0].firstChild).has(e.originalEvent.relatedTarget).length||o.removeClass("drag-over")},M.prototype._onDropColumnHeader=function(e){e.preventDefault();let t=this.o,o=this.p,l=JSON.parse(e.originalEvent.dataTransfer.getData("text")),r=_(e.target).closest("div."+t.tableClassName+"-header-cell,div."+t.cellPreviewClassName);if(t.movableColumns&&l.dragId==o.dragId){let e=l.column,t=r[0].columnName,i=o.columns.get(e),n=o.columns.get(t);i&&n&&i.movable&&(n.movable||n!=o.visibleColumns[0])&&this.moveColumn(e,t)}_(r).removeClass("drag-over")},M.prototype._clearSortArrows=function(){let e=this.p;if(e.$table){let t=this.o.tableClassName,l=e.$headerRow.find(">div."+t+"-header-cell.sorted"),r=l.find(">div>.sort-arrow");!function(e,t,o){if(s)return e.forEach(t,o);let l,r;if(null===this)throw new TypeError(" this is null or not defined");let i=e.length>>>0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(l=o),r=0;r<i;){if(r in e){let o=e[r];t.call(l,o,r,e)}r++}}(r,o(function(t){let o=e.columns.get(t.parentNode.parentNode.columnName);o&&(o.arrowProposedWidth=0)},this)),r.remove(),l.removeClass("sorted").removeClass("desc")}return this},M.prototype._showSortArrow=function(e,t){let o=this.p.columns.get(e);if(!o)return!1;let l=N("span");return l.className="sort-arrow",o.element&&(o.element.addClass(t?"sorted desc":"sorted"),o.element[0].firstChild.insertBefore(l,o.element[0].firstChild.firstChild)),o.widthMode!=z.RELATIVE&&this.o.adjustColumnWidthForSortArrow&&(o.arrowProposedWidth=l.scrollWidth+(parseFloat(_(l).css("margin-right"))||0)+(parseFloat(_(l).css("margin-left"))||0)),this},M.prototype._resizeColumnElements=function(e){let t=this.p,o=t.$headerRow.find("div."+this.o.tableClassName+"-header-cell"),l=t.columns.get(o[e].columnName);if(l){o[e].style.width=(l.actualWidthConsideringScrollbarWidth||l.actualWidth)+"px";let r=(l.actualWidthConsideringScrollbarWidth||l.actualWidth)+"px",i=t.$tbody[0].childNodes;for(let t=0,o=i.length;t<o;t++){let o=i[t];1===o.nodeType&&(o.childNodes[e].style.width=r)}}return this},M.prototype._destroyHeaderCells=function(){let e=this.o,t=this.p;return t.$headerRow&&(this.trigger("headerrowdestroy",t.headerRow),t.$headerRow.find("div."+e.tableClassName+"-header-cell").remove(),t.$headerRow=null,t.headerRow=null),this},M.prototype._renderSkeletonBase=function(){let e=this,t=e.p,o=e.o;if(t.$table&&o.virtualTable){if(t.$table.remove(),t.$tbody){let o=t.$tbody[0].childNodes;for(let t=0,l=o.length;t<l;t++)e.trigger("rowdestroy",o[t]),e._unbindCellEventsForRow(o[t])}t.$table=t.table=t.$tbody=t.tbody=null}e._destroyHeaderCells(),t.currentTouchId=null,t.$header&&t.$header.remove();let l=o.tableClassName,r=N("div"),i=_(r),n=N("div"),s=_(n);return r.className=l+"-header",n.className=l+"-header-row",t.$header=i,t.header=r,t.$headerRow=s,t.headerRow=n,s.appendTo(t.$header),i.prependTo(this.$el),H(e.$el),o.width==M.Width.SCROLL?this.el.style.overflow="hidden":this.el.style.overflow="",!o.height&&o.virtualTable&&(o.height=b.innerHeight(this.$el)),this},M.prototype._renderSkeletonHeaderCells=function(){let e,t=this,l=t.p,r=t.o,i=r.allowCellPreview,n=r.allowHeaderCellPreview,s=r.tableClassName+"-header-cell",a=(l.header,l.$header,l.headerRow);l.$headerRow,T&&(e=function(e){return e.preventDefault(),this.dragDrop(),!1});let d=function(e){e.preventDefault()};for(let h=0;h<l.visibleColumns.length;h++){let u=l.visibleColumns[h];if(u.visible){let c=N("div"),p=_(c);c.draggable=!0,c.className=s,c.style.width=u.actualWidth+"px",r.sortableColumns&&u.sortable&&(c.className+=" sortable"),c.columnName=u.name,c.setAttribute("data-column",u.name);let m=N("div");m.innerHTML=r.headerCellFormatter(u.label,u.name),c.appendChild(m),i&&n&&l._bindCellHoverIn(c),a.appendChild(c),l.visibleColumns[h].element=p,p.on("mousedown.dgtable",o(t._onMouseDownColumnHeader,t)).on("mousemove.dgtable",o(t._onMouseMoveColumnHeader,t)).on("mouseup.dgtable",o(t._onMouseUpColumnHeader,t)).on("mouseleave.dgtable",o(t._onMouseLeaveColumnHeader,t)).on("touchstart.dgtable",o(t._onTouchStartColumnHeader,t)).on("dragstart.dgtable",o(t._onStartDragColumnHeader,t)).on("click.dgtable",o(t._onClickColumnHeader,t)).on("contextmenu.dgtable",d),_(m).on("dragenter.dgtable",o(t._onDragEnterColumnHeader,t)).on("dragover.dgtable",o(t._onDragOverColumnHeader,t)).on("dragleave.dgtable",o(t._onDragLeaveColumnHeader,t)).on("drop.dgtable",o(t._onDropColumnHeader,t)),T&&p.on("selectstart.dgtable",o(e,c)),p.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none"})}}return this.trigger("headerrowcreate",a),this},M.prototype._renderSkeletonBody=function(){let e=this,t=e.p,o=e.o,l=o.tableClassName;if(o.virtualTable&&!t.virtualRowHeight){let o,r=function(){let e=N("div"),t=e.appendChild(N("div")),o=t.appendChild(N("div"));return e.className=l+"-row",t.className=l+"-cell",o.innerHTML="0",e.style.visibility="hidden",e.style.position="absolute",e},i=_("<div>").addClass(e.el.className).css({"z-index":-1,position:"absolute",left:"0",top:"-9999px",width:"1px",overflow:"hidden"}).append(_("<div>").addClass(l).append(o=_("<div>").addClass(l+"-body").css("width",99999)));i.appendTo(document.body);let n=r(),s=r(),a=r();o.append(n,s,a),t.virtualRowHeightFirst=b.outerHeight(n),t.virtualRowHeight=b.outerHeight(s),t.virtualRowHeightLast=b.outerHeight(a),t.virtualRowHeightMin=Math.min(Math.min(t.virtualRowHeightFirst,t.virtualRowHeight),t.virtualRowHeightLast),t.virtualRowHeightMax=Math.max(Math.max(t.virtualRowHeightFirst,t.virtualRowHeight),t.virtualRowHeightLast),i.remove()}if(!t.$table){let r=document.createDocumentFragment(),i=N("div"),n=_(i);i.className=l,o.virtualTable&&(i.className+=" virtual");let s=o.height-b.outerHeight(t.$headerRow);"border-box"!==n.css("box-sizing")&&(s-=parseFloat(n.css("border-top-width"))||0,s-=parseFloat(n.css("border-bottom-width"))||0,s-=parseFloat(n.css("padding-top"))||0,s-=parseFloat(n.css("padding-bottom"))||0),t.visibleHeight=s,i.style.height=o.height?s+"px":"auto",i.style.display="block",i.style.overflowY="auto",i.style.overflowX=o.width==M.Width.SCROLL?"auto":"hidden",r.appendChild(i);let a=N("div"),d=_(a);a.className=o.tableClassName+"-body",t.table=i,t.tbody=a,t.$table=n,t.$tbody=d,o.virtualTable&&(t.virtualVisibleRows=Math.ceil(t.visibleHeight/t.virtualRowHeightMin)),e._calculateVirtualHeight(),H(d),H(n),i.appendChild(a),e.el.appendChild(r)}return this},M.prototype._renderSkeleton=function(){return this},M.prototype._updateLastCellWidthFromScrollbar=function(e){const t=this.p;let o=t.table.offsetWidth-t.table.clientWidth;if(o!=t.scrollbarWidth||e){t.scrollbarWidth=o;for(let e=0;e<t.columns.length;e++)t.columns[e].actualWidthConsideringScrollbarWidth=null;if(t.scrollbarWidth>0&&t.visibleColumns.length>0){let e=t.visibleColumns.length-1;t.visibleColumns[e].actualWidthConsideringScrollbarWidth=t.visibleColumns[e].actualWidth-t.scrollbarWidth;let o=t.visibleColumns[e].actualWidthConsideringScrollbarWidth+"px",l=t.tbody.childNodes;for(let t=0,r=l.length;t<r;t++){let r=l[t];1===r.nodeType&&(r.childNodes[e].style.width=o)}t.headerRow.childNodes[e].style.width=o}}return this},M.prototype._updateTableWidth=function(e){const t=this.o,o=this.p;let l=this._calculateTbodyWidth();if(o.tbody.style.minWidth=l+"px",o.headerRow.style.minWidth=l+(o.scrollbarWidth||0)+"px",o.$table.off("scroll",o.onTableScrolledHorizontallyBound),t.width==M.Width.AUTO)b.width(o.$table,b.outerWidth(o.$tbody)),b.width(this.$el,b.outerWidth(o.$table));else if(t.width==M.Width.SCROLL){if(e){let e=o.table?o.table.scrollTop:0,t=o.table?o.table.scrollLeft:0;!function(e){let t=e.style.display;e.style.display="none",e.offsetHeight,e.style.display=t}(this.el),o.table.scrollTop=e,o.table.scrollLeft=t,o.header.scrollLeft=t}o.$table.on("scroll",o.onTableScrolledHorizontallyBound)}return this},M.prototype._isTableRtl=function(){return"rtl"===this.p.$table.css("direction")},M.prototype._serializeColumnWidth=function(e){return e.widthMode===z.AUTO?"auto":e.widthMode===z.RELATIVE?100*e.width+"%":e.width},M.prototype._cellMouseOverEvent=function(e){const t=this.o,l=this.p;let i=e.firstChild;if(i.scrollWidth-i.clientWidth>1||i.scrollHeight-i.clientHeight>1){this.hideCellPreview(),l.abortCellPreview=!1;let n=_(e),s=_(i),a=N("div"),d=_(a);a.innerHTML=e.innerHTML,a.className=t.cellPreviewClassName;let h=n.hasClass(t.tableClassName+"-header-cell");h&&(a.className+=" header",n.hasClass("sortable")&&(a.className+=" sortable"),a.draggable=!0,_(a).on("mousedown",o(this._onMouseDownColumnHeader,this)).on("mousemove",o(this._onMouseMoveColumnHeader,this)).on("mouseup",o(this._onMouseUpColumnHeader,this)).on("mouseleave",o(this._onMouseLeaveColumnHeader,this)).on("touchstart",o(this._onTouchStartColumnHeader,this)).on("dragstart",o(this._onStartDragColumnHeader,this)).on("click",o(this._onClickColumnHeader,this)).on("contextmenu.dgtable",function(e){e.preventDefault()}),_(a.firstChild).on("dragenter",o(this._onDragEnterColumnHeader,this)).on("dragover",o(this._onDragOverColumnHeader,this)).on("dragleave",o(this._onDragLeaveColumnHeader,this)).on("drop",o(this._onDropColumnHeader,this)),T&&_(a).on("selectstart",o(function(e){return e.preventDefault(),this.dragDrop(),!1},a)));let u=parseFloat(n.css("padding-left"))||0,c=parseFloat(n.css("padding-right"))||0,p=parseFloat(n.css("padding-top"))||0,m=parseFloat(n.css("padding-bottom"))||0,f=i.scrollWidth+(e.clientWidth-i.offsetWidth),g="border-box"===n.css("box-sizing");if(g?d.css("box-sizing","border-box"):(f-=u+c,d.css("margin-top",parseFloat(_(e).css("border-top-width"))||0)),!l.transparentBgColor1){let e=document.createElement("div");e.style.backgroundColor="transparent",l.transparentBgColor1=_(e).css("background-color"),e.style.backgroundColor="rgba(0,0,0,0)",l.transparentBgColor2=_(e).css("background-color")}let v={"box-sizing":g?"border-box":"content-box",width:f,"min-height":b.height(n),"padding-left":u,"padding-right":c,"padding-top":p,"padding-bottom":m,overflow:"hidden",position:"absolute","z-index":"-1",left:"0",top:"0",cursor:"default"};if(v){let t=_(e).css("background-color");t!==l.transparentBgColor1&&t!==l.transparentBgColor2||(t=_(e.parentNode).css("background-color")),t!==l.transparentBgColor1&&t!==l.transparentBgColor2||(t="#fff"),v["background-color"]=t}d.css(v),this.el.appendChild(a),_(a.firstChild).css({direction:s.css("direction"),"white-space":s.css("white-space")}),h&&d.css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none"}),a.rowIndex=e.parentNode.rowIndex;let C=a.physicalRowIndex=e.parentNode.physicalRowIndex;a.columnName=l.visibleColumns[r(e.parentNode.childNodes,e)].name;try{let t=w.saveSelection(e);t&&w.restoreSelection(a,t)}catch(e){}if(this.trigger("cellpreview",a.firstChild,null==C?null:C,a.columnName,null==C?null:l.rows[C],e),l.abortCellPreview)return void d.remove();let y=this.$el,R=y[0]===window?_(document):y,W=n.offset(),F=y.offset(),H="right"===n.css("float"),M=H?"right":"left";if(H){let e=_(window).width();W.right=e-(W.left+b.outerWidth(n)),F.right=e-(F.left+b.outerWidth(y))}W.left-=parseFloat(y.css("border-left-width"))||0,W.right-=parseFloat(y.css("border-right-width"))||0,W.top-=parseFloat(y.css("border-top-width"))||0,W[M]+=parseFloat(_(e).css("border-"+M+"-width"))||0,W.top+=parseFloat(_(e).css("border-top-width"))||parseFloat(_(e).css("border-bottom-width"))||0,W.left-=F.left,W.right-=F.right,W.top-=F.top;let z=0,E=y-b.outerWidth(d);W[M]=W[M]<z?z:W[M]>E?E:W[M];let S=b.outerHeight(n),x=R.scrollTop()+b.innerHeight(y)-S;W.top>x&&(W.top=Math.max(0,x));let $={top:W.top,"z-index":9999};$[M]=W[M],d.css($),a.__cell=e,l.$cellPreviewCell=d,e.__previewCell=a,l._bindCellHoverOut(e),l._bindCellHoverOut(a),d.on("mousewheel",e=>{let t=e.originalEvent,o=t.wheelDelta||-t.detail,r=t.wheelDeltaX||(1==t.axis?o:0),i=t.wheelDeltaY||(2==t.axis?o:0);if(o&&this.hideCellPreview(),i&&l.table.scrollHeight>l.table.clientHeight){let e=-1*i+l.$table.scrollTop();l.$table.scrollTop(e)}if(r&&l.table.scrollWidth>l.table.clientWidth){let e=-1*r+l.$table.scrollLeft();l.$table.scrollLeft(e)}})}},M.prototype._cellMouseOutEvent=function(e){this.hideCellPreview()},M.prototype.hideCellPreview=function(){const e=this.p;if(e.$cellPreviewCell){let t,o=e.$cellPreviewCell[0],l=o.__cell;try{t=w.saveSelection(o)}catch(e){}e.$cellPreviewCell.remove(),e._unbindCellHoverOut(l),e._unbindCellHoverOut(o);try{t&&w.restoreSelection(l,t)}catch(e){}this.trigger("cellpreviewdestroy",o.firstChild,o.physicalRowIndex,o.columnName,l),l.__previewCell=null,o.__cell=null,e.$cellPreviewCell=null,e.abortCellPreview=!1}else e.abortCellPreview=!0;return this};const z={AUTO:0,ABSOLUTE:1,RELATIVE:2};M.Width={NONE:"none",AUTO:"auto",SCROLL:"scroll"},_.controls||(_.controls={}),_.controls.dgtable=M;export default M;

//# sourceMappingURL=jquery.dgtable.es6.min.js.map