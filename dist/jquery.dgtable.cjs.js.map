{"version":3,"file":"index.js","sources":["src/util.js","src/row_collection.js","src/column_collection.js","src/css_util.js","src/selection_helper.js","src/by_column_filter.js","src/index.js"],"sourcesContent":["'use strict';\r\n\r\nconst indexOf = Array.prototype.indexOf;\r\n\r\nexport const includes = function includes (array, item) {\r\n    return indexOf.call(array, item) >= 0;\r\n};\r\n\r\nexport const find = function find (array, predicate) {\r\n    for (let i = 0, len = array.length; i >= 0 && i < len; i += 1) {\r\n        if (predicate(array[i], i, array))\r\n            return array[i];\r\n    }\r\n};\r\n\r\nexport const htmlEncode = function htmlEncode (text) {\r\n    return text.replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\")\r\n        .replace(/>/g, \"&gt;\")\r\n        .replace(/'/g, \"&#39;\")\r\n        .replace(/\"/g, \"&quot;\")\r\n        .replace(/\\n/g, '<br />');\r\n};\r\n","'use strict';\r\n\r\n// Define class RowCollection\r\nfunction RowCollection () {\r\n\r\n    // Instantiate an Array. Seems like the `.length = ` of an inherited Array does not work well.\r\n    // I will not use the IFRAME solution either in fear of memory leaks, and we're supporting large datasets...\r\n    let collection = [];\r\n\r\n    // Synthetically set the 'prototype'\r\n    Object.assign(collection, RowCollection.prototype);\r\n\r\n    // Call initializer\r\n    collection.initialize.apply(collection, arguments);\r\n\r\n    return collection;\r\n}\r\n\r\n// Inherit Array\r\nRowCollection.prototype = [];\r\n\r\nRowCollection.prototype.initialize = function (options) {\r\n\r\n    options = options || {};\r\n\r\n    /** @field {string} sortColumn */\r\n    this.sortColumn = options.sortColumn == null ? [] : options.sortColumn;\r\n};\r\n\r\n/**\r\n * @param {Object|Object[]} rows - row or array of rows to add to this collection\r\n * @param {number?} at - position to insert rows at\r\n */\r\nRowCollection.prototype.add = function (rows, at) {\r\n    let isArray = ('splice' in rows && 'length' in rows), i, len;\r\n    if (isArray) {\r\n        if (at) {\r\n            for (i = 0, len = rows.length; i < len; i++) {\r\n                this.splice(at++, 0, rows[i]);\r\n            }\r\n        } else {\r\n            for (i = 0, len = rows.length; i < len; i++) {\r\n                this.push(rows[i]);\r\n            }\r\n        }\r\n    } else {\r\n        if (at) {\r\n            this.splice(at, 0, rows);\r\n        } else {\r\n            this.push(rows);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @param {Object|Object[]=} rows Row or array of rows to add to this collection\r\n */\r\nRowCollection.prototype.reset = function (rows) {\r\n    this.length = 0;\r\n    if (rows) {\r\n        this.add(rows);\r\n    }\r\n};\r\n\r\n/**\r\n * @param {Function} filterFunc - Filtering function\r\n * @param {Object|null} args? - Options to pass to the function\r\n * @returns {RowCollection} success result\r\n */\r\nRowCollection.prototype.filteredCollection = function (filterFunc, args) {\r\n    if (filterFunc && args) {\r\n        let rows = new RowCollection({ sortColumn: this.sortColumn });\r\n        \r\n        for (let i = 0, len = this.length, row; i < len; i++) {\r\n            row = this[i];\r\n            if (filterFunc(row, args)) {\r\n                row['__i'] = i;\r\n                rows.push(row);\r\n            }\r\n        }\r\n        return rows;\r\n    } else {\r\n        return null;\r\n    }\r\n};\r\n\r\n/**\r\n * @type {Function|null|undefined}\r\n */\r\nRowCollection.prototype.onComparatorRequired = null;\r\n\r\n/**\r\n * @type {Function|null|undefined}\r\n */\r\nRowCollection.prototype.onSort = null;\r\n\r\nlet nativeSort = RowCollection.prototype.sort;\r\n\r\nfunction getDefaultComparator(column, descending) {\r\n    let columnName = column.column;\r\n    let comparePath = column.comparePath || columnName;\r\n    if (typeof comparePath === 'string') {\r\n        comparePath = comparePath.split('.');\r\n    }\r\n    let pathLength = comparePath.length,\r\n        hasPath = pathLength > 1,\r\n        i;\r\n\r\n    let lessVal = descending ? 1 : -1, moreVal = descending ? -1 : 1;\r\n    return function(leftRow, rightRow) {\r\n        let leftVal = leftRow[comparePath[0]],\r\n            rightVal = rightRow[comparePath[0]];\r\n        if (hasPath) {\r\n            for (i = 1; i < pathLength; i++) {\r\n                leftVal = leftVal && leftVal[comparePath[i]];\r\n                rightVal = rightVal && rightVal[comparePath[i]];\r\n            }\r\n        }\r\n        if (leftVal === rightVal) return 0;\r\n        if (leftVal == null) return lessVal;\r\n        if (leftVal < rightVal) return lessVal;\r\n        return moreVal;\r\n    };\r\n}\r\n\r\n/**\r\n * @param {Boolean=false} silent\r\n * @returns {RowCollection} self\r\n */\r\nRowCollection.prototype.sort = function (silent) {\r\n    if (this.sortColumn.length) {\r\n        let comparators = [], i, comparator;\r\n\r\n        for (i = 0; i < this.sortColumn.length; i++) {\r\n            comparator = null;\r\n            if (this.onComparatorRequired) {\r\n                comparator = this.onComparatorRequired(this.sortColumn[i].column, this.sortColumn[i].descending);\r\n            }\r\n            if (!comparator) {\r\n                comparator = getDefaultComparator(this.sortColumn[i], this.sortColumn[i].descending);\r\n            }\r\n            comparators.push(comparator.bind(this));\r\n        }\r\n\r\n        if (comparators.length === 1) {\r\n            nativeSort.call(this, comparators[0]);\r\n        } else {\r\n            let len = comparators.length,\r\n                value;\r\n\r\n            comparator = function(leftRow, rightRow) {\r\n                for (i = 0; i < len; i++) {\r\n                    value = comparators[i](leftRow, rightRow);\r\n                    if (value !== 0) {\r\n                        return value;\r\n                    }\r\n                }\r\n                return value;\r\n            };\r\n\r\n            nativeSort.call(this, comparator);\r\n        }\r\n\r\n        if (!silent) {\r\n            if (this.onSort) {\r\n                this.onSort();\r\n            }\r\n        }\r\n    }\r\n    return this;\r\n};\r\n\r\nexport default RowCollection;","'use strict';\r\n\r\n// Define class RowCollection\r\nfunction ColumnCollection () {\r\n\r\n    // Instantiate an Array. Seems like the `.length = ` of an inherited Array does not work well.\r\n    // I will not use the IFRAME solution either in fear of memory leaks, and we're supporting large datasets...\r\n    let collection = [];\r\n\r\n    // Synthetically set the 'prototype'\r\n    Object.assign(collection, ColumnCollection.prototype);\r\n\r\n    // Call initializer\r\n    collection.initialize.apply(collection, arguments);\r\n\r\n    return collection;\r\n}\r\n\r\n// Inherit Array\r\nColumnCollection.prototype = [];\r\n\r\nColumnCollection.prototype.initialize = function () {\r\n\r\n};\r\n\r\n/**\r\n * Get the column by this name\r\n * @param {String} column column name\r\n * @returns {Object} the column object\r\n */\r\nColumnCollection.prototype.get = function (column) {\r\n    for (let i = 0, len = this.length; i < len; i++) {\r\n        if (this[i].name == column) {\r\n            return this[i];\r\n        }\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Get the index of the column by this name\r\n * @param {String} column column name\r\n * @returns {int} the index of this column\r\n */\r\nColumnCollection.prototype.indexOf = function (column) {\r\n    for (let i = 0, len = this.length; i < len; i++) {\r\n        if (this[i].name == column) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n};\r\n\r\n/**\r\n * Get the column by the specified order\r\n * @param {Number} order the column's order\r\n * @returns {Object} the column object\r\n */\r\nColumnCollection.prototype.getByOrder = function (order) {\r\n    for (let i = 0, len = this.length; i < len; i++) {\r\n        if (this[i].order == order) {\r\n            return this[i];\r\n        }\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Normalize order\r\n * @returns {ColumnCollection} self\r\n */\r\nColumnCollection.prototype.normalizeOrder = function () {\r\n    let ordered = [], i;\r\n    for (i = 0; i < this.length; i++) {\r\n        ordered.push(this[i]);\r\n    }\r\n    ordered.sort(function(col1, col2){ return col1.order < col2.order ? -1 : (col1.order > col2.order ? 1 : 0); });\r\n    for (i = 0; i < ordered.length; i++) {\r\n        ordered[i].order = i;\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Get the array of visible columns, order by the order property\r\n * @returns {Array<Object>} ordered array of visible columns\r\n */\r\nColumnCollection.prototype.getVisibleColumns = function () {\r\n    let visible = [];\r\n    for (let i = 0, column; i < this.length; i++) {\r\n        column = this[i];\r\n        if (column.visible) {\r\n            visible.push(column);\r\n        }\r\n    }\r\n    visible.sort((col1, col2) => col1.order < col2.order ? -1 : (col1.order > col2.order ? 1 : 0));\r\n    return visible;\r\n};\r\n\r\n/**\r\n * @returns {int} maximum order currently in the array\r\n */\r\nColumnCollection.prototype.getMaxOrder = function () {\r\n    let order = 0;\r\n    for (let i = 0, column; i < this.length; i++) {\r\n        column = this[i];\r\n        if (column.order > order) {\r\n            order = column.order;\r\n        }\r\n    }\r\n    return order;\r\n};\r\n\r\n/**\r\n * Move a column to a new spot in the collection\r\n * @param {Object} src the column to move\r\n * @param {Object} dest the destination column\r\n * @returns {ColumnCollection} self\r\n */\r\nColumnCollection.prototype.moveColumn = function (src, dest) {\r\n    if (src && dest) {\r\n        let srcOrder = src.order, destOrder = dest.order, i, col;\r\n        if (srcOrder < destOrder) {\r\n            for (i = srcOrder + 1; i <= destOrder; i++) {\r\n                col = this.getByOrder(i);\r\n                col.order--;\r\n            }\r\n        } else {\r\n            for (i = srcOrder - 1; i >= destOrder; i--) {\r\n                col = this.getByOrder(i);\r\n                col.order++;\r\n            }\r\n        }\r\n        src.order = destOrder;\r\n    }\r\n    return this;\r\n};\r\n\r\nexport default ColumnCollection;","/* eslint-env browser */\r\n\r\n'use strict';\r\n\r\nimport jQuery from 'jquery';\r\n\r\nconst $ = jQuery;\r\n\r\nconst hasComputedStyle = document.defaultView && document.defaultView.getComputedStyle;\r\n\r\nconst jQuerySupportsFractions = $ && $.fn.jquery >= '3';\r\n\r\nconst cssExpands = {\r\n    'width': [\r\n        'Left',\r\n        'Right',\r\n        'Width',\r\n    ],\r\n    'height': [\r\n        'Top',\r\n        'Bottom',\r\n        'Height',\r\n    ],\r\n};\r\n\r\nconst sizeKeys = ['width', 'height'];\r\n\r\nconst CssUtil = {};\r\n\r\nlet generateSizeFunction = function (key, cssExpand, inner, outer) {\r\n\r\n    return function () {\r\n        let el = arguments[0];\r\n        let value = arguments[1];\r\n\r\n        if (el && !(el instanceof Element) && 'length' in el) {\r\n            el = el[0];\r\n        }\r\n\r\n        if (!el) {\r\n            return null;\r\n        }\r\n\r\n        let style = hasComputedStyle ? document.defaultView.getComputedStyle(el) : el.currentStyle;\r\n        let isBoxing = style['boxSizing'] === 'border-box';\r\n        let size, border, padding;\r\n        let includeMargins = outer && arguments[2] === true || arguments[1] === true;\r\n\r\n        if (isBoxing || outer || inner) {\r\n            border = parseFloat(style['border' + cssExpand[0] + 'Width'] || 0)\r\n                + parseFloat(style['border' + cssExpand[1] + 'Width'] || 0);\r\n\r\n            padding = parseFloat(style['padding' + cssExpand[0]] || 0)\r\n                + parseFloat(style['padding' + cssExpand[1]] || 0);\r\n        }\r\n\r\n        let margin = includeMargins ?\r\n            (parseFloat(style['margin' + cssExpand[0]] || 0)\r\n            + parseFloat(style['margin' + cssExpand[1]] || 0)) : 0;\r\n\r\n        if (value == undefined) {\r\n            size = parseFloat(style[key]);\r\n\r\n            if (isBoxing) {\r\n\r\n                if (padding + border > size) {\r\n                    size = padding + border;\r\n                }\r\n\r\n                if (outer) {\r\n                    if (includeMargins) {\r\n                        size += margin;\r\n                    }\r\n                }\r\n                else if (inner) {\r\n                    size -= border;\r\n                }\r\n                else {\r\n                    size -= padding + border;\r\n                }\r\n\r\n            } else {\r\n\r\n                if (outer) {\r\n                    size += padding + border;\r\n\r\n                    if (includeMargins) {\r\n                        size += margin;\r\n                    }\r\n                }\r\n                else if (inner) {\r\n                    size += padding;\r\n                }\r\n\r\n            }\r\n\r\n            return size;\r\n        } else {\r\n            value = value || 0;\r\n            size = value;\r\n\r\n            if (isBoxing) {\r\n\r\n                if (outer) {\r\n                    if (includeMargins) {\r\n                        size -= margin;\r\n                    }\r\n                }\r\n                else if (inner) {\r\n                    size += border;\r\n                }\r\n                else {\r\n                    size += padding + border;\r\n                }\r\n\r\n            } else {\r\n\r\n                if (outer) {\r\n                    size -= padding + border;\r\n\r\n                    if (includeMargins) {\r\n                        size -= margin;\r\n                    }\r\n                }\r\n                else if (inner) {\r\n                    size -= padding;\r\n                }\r\n\r\n                if (size < 0) {\r\n                    size = 0;\r\n                }\r\n            }\r\n\r\n            el.style[key] = size + 'px';\r\n\r\n            return value;\r\n        }\r\n    };\r\n};\r\n\r\nlet generatejQueryFunction = function (key) {\r\n    return function () {\r\n        let collection = arguments[0];\r\n        if (!$.isArray(collection) && !(collection instanceof $)) {\r\n            collection = [collection];\r\n        }\r\n        \r\n        let ret = $.fn[key].apply(collection, Array.prototype.slice.call(arguments, 1));\r\n        \r\n        if (arguments.length > 1) {\r\n            return this;\r\n        }\r\n        \r\n        return ret;\r\n    };\r\n};\r\n\r\nfor (let i = 0; i < sizeKeys.length; i++) {\r\n    let key = sizeKeys[i];\r\n    let cssExpand = cssExpands[key];\r\n\r\n    if (jQuerySupportsFractions) {\r\n\r\n        CssUtil[key] = generatejQueryFunction(key);\r\n        CssUtil['inner' + cssExpand[2]] = generatejQueryFunction('inner' + cssExpand[2]);\r\n        CssUtil['outer' + cssExpand[2]] = generatejQueryFunction('outer' + cssExpand[2]);\r\n\r\n    } else {\r\n\r\n        CssUtil[key] = generateSizeFunction(key, cssExpand, false, false);\r\n        CssUtil['inner' + cssExpand[2]] = generateSizeFunction(key, cssExpand, true, false);\r\n        CssUtil['outer' + cssExpand[2]] = generateSizeFunction(key, cssExpand, false, true);\r\n\r\n    }\r\n}\r\n\r\n// Remove that huge function from memory\r\ngenerateSizeFunction = null;\r\n\r\nexport default CssUtil;","/* eslint-env browser */\r\n\r\n'use strict';\r\n\r\n// saveSelection/restoreSelection courtesy of Tim Down, with my improvements\r\n// https://stackoverflow.com/questions/13949059/persisting-the-changes-of-range-objects-after-selection-in-html/13950376#13950376\r\n\r\nfunction isChildOf(child, parent) {\r\n  while ((child = child.parentNode) && child !== parent); \r\n  return !!child; \r\n}\r\n\r\nclass SelectionHelper {\r\n    \r\n    static saveSelection(el) {\r\n        let range = window.getSelection().getRangeAt(0);\r\n        \r\n        if (el !== range.commonAncestorContainer && !isChildOf(range.commonAncestorContainer, el))\r\n            return null;\r\n        \r\n        let preSelectionRange = range.cloneRange();\r\n        preSelectionRange.selectNodeContents(el);\r\n        preSelectionRange.setEnd(range.startContainer, range.startOffset);\r\n        let start = preSelectionRange.toString().length;\r\n\r\n        return {\r\n            start: start,\r\n            end: start + range.toString().length,\r\n        };\r\n    }\r\n    \r\n    static restoreSelection(el, savedSel) {\r\n        let charIndex = 0;\r\n        let nodeStack = [el], node, foundStart = false, stop = false;\r\n        let range = document.createRange();\r\n        range.setStart(el, 0);\r\n        range.collapse(true);\r\n        \r\n        while (!stop && (node = nodeStack.pop())) {\r\n            if (node.nodeType == 3) {\r\n                let nextCharIndex = charIndex + node.length;\r\n                if (!foundStart && savedSel.start >= charIndex && savedSel.start <= nextCharIndex) {\r\n                    range.setStart(node, savedSel.start - charIndex);\r\n                    foundStart = true;\r\n                }\r\n                if (foundStart && savedSel.end >= charIndex && savedSel.end <= nextCharIndex) {\r\n                    range.setEnd(node, savedSel.end - charIndex);\r\n                    stop = true;\r\n                }\r\n                charIndex = nextCharIndex;\r\n            } else {\r\n                let i = node.childNodes.length;\r\n                while (i--) {\r\n                    nodeStack.push(node.childNodes[i]);\r\n                }\r\n            }\r\n        }\r\n\r\n        let sel = window.getSelection();\r\n        sel.removeAllRanges();\r\n        sel.addRange(range);\r\n    }\r\n}\r\n\r\nexport default SelectionHelper;\r\n","'use strict';\r\n\r\nfunction ByColumnFilter (row, args) {\r\n    \r\n    let column = args.column;\r\n    let keyword = args.keyword == null ? '' : args.keyword.toString();\r\n    \r\n    if (!keyword || !column) return true;\r\n\r\n    let actualVal = row[column];\r\n    if (actualVal == null) {\r\n        return false;\r\n    }\r\n    \r\n    actualVal = actualVal.toString();\r\n    \r\n    if (!args.caseSensitive) {\r\n        actualVal = actualVal.toLowerCase();\r\n        keyword = keyword.toLowerCase();\r\n    }\r\n    \r\n    return actualVal.indexOf(keyword) !== -1;\r\n}\r\n\r\nexport default ByColumnFilter;","/* eslint-env browser */\r\n\r\n'use strict';\r\n\r\nimport jQuery from 'jquery';\r\nimport { includes, find, htmlEncode } from './util';\r\nimport RowCollection from './row_collection';\r\nimport ColumnCollection from './column_collection';\r\nimport CssUtil from './css_util';\r\nimport SelectionHelper from './selection_helper';\r\nimport ByColumnFilter from './by_column_filter';\r\n\r\nconst nativeIndexOf = Array.prototype.indexOf;\r\nconst $ = jQuery;\r\n\r\nlet userAgent = navigator.userAgent;\r\nlet ieVersion = userAgent.indexOf('MSIE ') != -1 ? parseFloat(userAgent.substr(userAgent.indexOf('MSIE ') + 5)) : null;\r\nlet hasIeDragAndDropBug = ieVersion && ieVersion < 10;\r\nlet createElement = document.createElement.bind(document);\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\nfunction webkitRenderBugfix(el) {\r\n    // BUGFIX: WebKit has a bug where it does not relayout, and this affects us because scrollbars \r\n    //   are still calculated even though they are not there yet. This is the last resort.\r\n    let oldDisplay = el.style.display;\r\n    el.style.display = 'none';\r\n    //noinspection BadExpressionStatementJS\r\n    el.offsetHeight; // No need to store this anywhere, the reference is enough\r\n    el.style.display = oldDisplay;\r\n    return el;\r\n}\r\n\r\nfunction relativizeElement($el) {\r\n    if (!includes(['relative', 'absolute', 'fixed'], $el.css('position'))) {\r\n        $el.css('position', 'relative');\r\n    }\r\n}\r\n\r\n/** @class DGTable */\r\nlet DGTable = function DGTable () {\r\n    if (!(this instanceof DGTable)) {\r\n        // Allow constructing without `new`\r\n        return new (Function.prototype.bind.apply(\r\n            DGTable,\r\n            [DGTable].concat(Array.prototype.slice.call(arguments, 0))));\r\n    }\r\n\r\n    this.initialize.apply(this, arguments);\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @type {string}\r\n */\r\nDGTable.VERSION = '@@VERSION';\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @type {string}\r\n */\r\nDGTable.prototype.VERSION = DGTable.VERSION;\r\n\r\n/**\r\n * @constructs\r\n * @param {DGTable.Options?} options - initialization options\r\n * @returns {DGTable}\r\n */\r\nDGTable.prototype.initialize = function (options) {\r\n    let that = this;\r\n\r\n    options = options || {};\r\n\r\n    /**\r\n     * @private\r\n     * @type {DGTable.Options}\r\n     * */\r\n    let o = that.o = {};\r\n\r\n    /**\r\n     * @private\r\n     * This is for encapsulating private data */\r\n    let p = that.p = {};\r\n\r\n    /** This is for encapsulating event callback */\r\n    p.events = {};\r\n\r\n    /**\r\n     * @public\r\n     * @expose\r\n     * */\r\n    that.el = (options.el && options.el instanceof Element) ? options.el : document.createElement('div');\r\n\r\n    /**\r\n     * @public\r\n     * @expose\r\n     * */\r\n    let $el = that.$el = $(that.el);\r\n    \r\n    if (that.el !== options.el) {\r\n        $el.addClass(options.className || 'dgtable-wrapper');\r\n    }\r\n\r\n    // Set control data\r\n    $el\r\n        .data('control', that)\r\n        .data('dgtable', that);\r\n\r\n    // For jQuery.UI or jquery.removeevent\r\n    $el.on('remove', function () {\r\n        that.destroy();\r\n    });\r\n\r\n    p.onMouseMoveResizeAreaBound = this._onMouseMoveResizeArea.bind(this);\r\n    p.onEndDragColumnHeaderBound = this._onEndDragColumnHeader.bind(this);\r\n    p.onTableScrolledHorizontallyBound = this._onTableScrolledHorizontally.bind(this);\r\n\r\n    this.$el.on('dragend', p.onEndDragColumnHeaderBound);\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} _tableSkeletonNeedsRendering */\r\n    p.tableSkeletonNeedsRendering = true;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} virtualTable */\r\n    o.virtualTable = options.virtualTable === undefined ? true : !!options.virtualTable;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Number} rowsBufferSize */\r\n    o.rowsBufferSize = options.rowsBufferSize || 3;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Number} minColumnWidth */\r\n    o.minColumnWidth = Math.max(options.minColumnWidth || 35, 0);\r\n\r\n    /**\r\n     * @private\r\n     * @field {Number} resizeAreaWidth */\r\n    o.resizeAreaWidth = options.resizeAreaWidth || 8;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} resizableColumns */\r\n    o.resizableColumns = options.resizableColumns === undefined ? true : !!options.resizableColumns;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} movableColumns */\r\n    o.movableColumns = options.movableColumns === undefined ? true : !!options.movableColumns;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Number} sortableColumns */\r\n    o.sortableColumns = options.sortableColumns === undefined ? 1 : (parseInt(options.sortableColumns, 10) || 1);\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} adjustColumnWidthForSortArrow */\r\n    o.adjustColumnWidthForSortArrow = options.adjustColumnWidthForSortArrow === undefined ? true : !!options.adjustColumnWidthForSortArrow;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} convertColumnWidthsToRelative */\r\n    o.convertColumnWidthsToRelative = options.convertColumnWidthsToRelative === undefined ? false : !!options.convertColumnWidthsToRelative;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} autoFillTableWidth */\r\n    o.autoFillTableWidth = options.autoFillTableWidth === undefined ? false : !!options.autoFillTableWidth;\r\n\r\n    /**\r\n     * @private\r\n     * @field {String} cellClasses */\r\n    o.cellClasses = options.cellClasses === undefined ? '' : options.cellClasses;\r\n\r\n    /**\r\n     * @private\r\n     * @field {String} resizerClassName */\r\n    o.resizerClassName = options.resizerClassName === undefined ? 'dgtable-resize' : options.resizerClassName;\r\n\r\n    /**\r\n     * @private\r\n     * @field {String} tableClassName */\r\n    o.tableClassName = options.tableClassName === undefined ? 'dgtable' : options.tableClassName;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} allowCellPreview */\r\n    o.allowCellPreview = options.allowCellPreview === undefined ? true : options.allowCellPreview;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} allowHeaderCellPreview */\r\n    o.allowHeaderCellPreview = options.allowHeaderCellPreview === undefined ? true : options.allowHeaderCellPreview;\r\n\r\n    /**\r\n     * @private\r\n     * @field {String} cellPreviewClassName */\r\n    o.cellPreviewClassName = options.cellPreviewClassName === undefined ? 'dgtable-cell-preview' : options.cellPreviewClassName;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} cellPreviewAutoBackground */\r\n    o.cellPreviewAutoBackground = options.cellPreviewAutoBackground === undefined ? true : options.cellPreviewAutoBackground;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Function(String,Boolean)Function(a,b)Boolean} onComparatorRequired */\r\n    o.onComparatorRequired = options.onComparatorRequired === undefined ? null : options.onComparatorRequired;\r\n    if (!o.onComparatorRequired && typeof options['comparatorCallback'] === 'function') {\r\n        o.onComparatorRequired = options['comparatorCallback'];\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} width */\r\n    o.width = options.width === undefined ? DGTable.Width.NONE : options.width;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} relativeWidthGrowsToFillWidth */\r\n    o.relativeWidthGrowsToFillWidth = options.relativeWidthGrowsToFillWidth === undefined ? true : !!options.relativeWidthGrowsToFillWidth;\r\n\r\n    /**\r\n     * @private\r\n     * @field {Boolean} relativeWidthShrinksToFillWidth */\r\n    o.relativeWidthShrinksToFillWidth = options.relativeWidthShrinksToFillWidth === undefined ? false : !!options.relativeWidthShrinksToFillWidth;\r\n\r\n    this.setCellFormatter(options.cellFormatter);\r\n    this.setHeaderCellFormatter(options.headerCellFormatter);\r\n    this.setFilter(options.filter);\r\n\r\n    /** @private\r\n     * @field {Number} height */\r\n    o.height = options.height;\r\n\r\n    // Prepare columns\r\n    that.setColumns(options.columns || [], false);\r\n\r\n    // Set sorting columns\r\n    let sortColumns = [];\r\n\r\n    if (options.sortColumn) {\r\n\r\n        let tmpSortColumns = options.sortColumn;\r\n\r\n        if (tmpSortColumns && typeof tmpSortColumns !== 'object') {\r\n            tmpSortColumns = [tmpSortColumns];\r\n        }\r\n\r\n        if (tmpSortColumns instanceof Array ||\r\n            typeof tmpSortColumns === 'object') {\r\n\r\n            for (let i = 0, len = tmpSortColumns.length; i < len; i++) {\r\n                let sortColumn = tmpSortColumns[i];\r\n                if (typeof sortColumn === 'string') {\r\n                    sortColumn = { column: sortColumn, descending: false };\r\n                }\r\n                let col = p.columns.get(sortColumn.column);\r\n                sortColumns.push({\r\n                    column: sortColumn.column,\r\n                    comparePath: col.comparePath || col.dataPath,\r\n                    descending: sortColumn.descending,\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @field {RowCollection} _rows */\r\n    p.rows = new RowCollection({ sortColumn: sortColumns });\r\n    p.rows.onComparatorRequired = function(column, descending){\r\n        if (o.onComparatorRequired) {\r\n            return o.onComparatorRequired(column, descending);\r\n        }\r\n    };\r\n\r\n    /** @private\r\n     * @field {RowCollection} _filteredRows */\r\n    p.filteredRows = null;\r\n\r\n    /*\r\n     Setup hover mechanism.\r\n     We need this to be high performance, as there may be MANY cells to call this on, on creation and destruction.\r\n     Using native events to spare the overhead of jQuery's event binding, and even just the creation of the jQuery collection object.\r\n     */\r\n\r\n    /**\r\n     * @param {MouseEvent} evt\r\n     * @this {HTMLElement}\r\n     * */\r\n    let hoverMouseOverHandler = function (evt) {\r\n        evt = evt || event;\r\n        let relatedTarget = evt.fromElement || evt.relatedTarget;\r\n        if (relatedTarget == this || $.contains(this, relatedTarget)) return;\r\n        if (this['__previewCell'] && (relatedTarget == this['__previewCell'] || $.contains(this['__previewCell'], relatedTarget))) return;\r\n        that._cellMouseOverEvent.call(that, this);\r\n    };\r\n\r\n    /**\r\n     * @param {MouseEvent} evt\r\n     * @this {HTMLElement}\r\n     * */\r\n    let hoverMouseOutHandler = function (evt) {\r\n        evt = evt || event;\r\n        let relatedTarget = evt.toElement || evt.relatedTarget;\r\n        if (relatedTarget == this || $.contains(this, relatedTarget)) return;\r\n        if (this['__previewCell'] && (relatedTarget == this['__previewCell'] || $.contains(this['__previewCell'], relatedTarget))) return;\r\n        that._cellMouseOutEvent.call(that, this);\r\n    };\r\n\r\n    if ('addEventListener' in window) {\r\n\r\n        /**\r\n         * @param {HTMLElement} el cell or header-cell\r\n         * */\r\n        p._bindCellHoverIn = function (el) {\r\n            if (!el['__hoverIn']) {\r\n                el.addEventListener('mouseover', el['__hoverIn'] = hoverMouseOverHandler.bind(el));\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @param {HTMLElement} el cell or header-cell\r\n         * */\r\n        p._unbindCellHoverIn = function (el) {\r\n            if (el['__hoverIn']) {\r\n                el.removeEventListener('mouseover', el['__hoverIn']);\r\n                el['__hoverIn'] = null;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @param {HTMLElement} el cell or header-cell\r\n         * @returns {DGTable} self\r\n         * */\r\n        p._bindCellHoverOut = function (el) {\r\n            if (!el['__hoverOut']) {\r\n                el.addEventListener('mouseout', el['__hoverOut'] = hoverMouseOutHandler.bind(el['__cell'] || el));\r\n            }\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * @param {HTMLElement} el cell or header-cell\r\n         * @returns {DGTable} self\r\n         * */\r\n        p._unbindCellHoverOut = function (el) {\r\n            if (el['__hoverOut']) {\r\n                el.removeEventListener('mouseout', el['__hoverOut']);\r\n                el['__hoverOut'] = null;\r\n            }\r\n            return this;\r\n        };\r\n\r\n    } else {\r\n\r\n        /**\r\n         * @param {HTMLElement} el cell or header-cell\r\n         * */\r\n        p._bindCellHoverIn = function (el) {\r\n            if (!el['__hoverIn']) {\r\n                el.attachEvent('mouseover', el['__hoverIn'] = hoverMouseOverHandler.bind(el));\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @param {HTMLElement} el cell or header-cell\r\n         * */\r\n        p._unbindCellHoverIn = function (el) {\r\n            if (el['__hoverIn']) {\r\n                el.detachEvent('mouseover', el['__hoverIn']);\r\n                el['__hoverIn'] = null;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @param {HTMLElement} el cell or header-cell\r\n         * */\r\n        p._bindCellHoverOut = function (el) {\r\n            if (!el['__hoverOut']) {\r\n                el.attachEvent('mouseout', el['__hoverOut'] = hoverMouseOutHandler.bind(el['__cell'] || el));\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @param {HTMLElement} el cell or header-cell\r\n         * @returns {DGTable} self\r\n         * */\r\n        p._unbindCellHoverOut = function (el) {\r\n            if (el['__hoverOut']) {\r\n                el.detachEvent('mouseout', el['__hoverOut']);\r\n                el['__hoverOut'] = null;\r\n            }\r\n            return this;\r\n        };\r\n\r\n    }\r\n};\r\n\r\n/**\r\n * Add an event listener\r\n * @public\r\n * @expose\r\n * @param {String} eventName\r\n * @param {Function} callback\r\n * @returns {DGTable}\r\n */\r\nDGTable.prototype.on = function (eventName, callback) {\r\n    let that = this, events = that.p.events;\r\n\r\n    if (typeof callback !== 'function')\r\n        return that;\r\n\r\n    if (!hasOwnProperty.call(events, eventName))\r\n        events[eventName] = [];\r\n\r\n    events[eventName].push({\r\n        cb: callback,\r\n        once: false,\r\n    });\r\n\r\n    return that;\r\n};\r\n\r\n/**\r\n * Add an event listener for a one shot\r\n * @public\r\n * @expose\r\n * @param {String} eventName\r\n * @param {Function} callback\r\n * @returns {DGTable}\r\n */\r\nDGTable.prototype.once = function (eventName, callback) {\r\n    let that = this, events = that.p.events;\r\n\r\n    if (typeof callback !== 'function')\r\n        return that;\r\n\r\n    if (!hasOwnProperty.call(events, eventName))\r\n        events[eventName] = [];\r\n\r\n    events[eventName].push({\r\n        cb: callback,\r\n        once: true,\r\n    });\r\n\r\n    return that;\r\n};\r\n\r\n/**\r\n * Remove an event listener\r\n * @public\r\n * @expose\r\n * @param {String} eventName\r\n * @param {Function} callback\r\n * @returns {DGTable}\r\n */\r\nDGTable.prototype.off = function (eventName, callback) {\r\n    let events = this.p.events;\r\n\r\n    if (!hasOwnProperty.call(events, eventName))\r\n        return this;\r\n\r\n    let callbacks = events[eventName];\r\n    for (let i = 0; i < callbacks.length; i++) {\r\n        let item = callbacks[i];\r\n        if (callback && item.cb !== callback) continue;\r\n        callbacks.splice(i--, 1);\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\nDGTable.prototype.trigger = function (eventName) {\r\n    let events = this.p.events;\r\n\r\n    if (hasOwnProperty.call(events, eventName)) {\r\n        let callbacks = events[eventName];\r\n        for (let i = 0; i < callbacks.length; i++) {\r\n            let item = callbacks[i];\r\n            if (item.once) {\r\n                callbacks.splice(i--, 1);\r\n            }\r\n            item.cb.apply(this, Array.prototype.slice.call(arguments, 1));\r\n        }\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * Detect column width mode\r\n * @private\r\n * @param {Number|String} width\r\n * @param {Number} minWidth\r\n * @returns {Object} parsed width\r\n */\r\nDGTable.prototype._parseColumnWidth = function (width, minWidth) {\r\n\r\n    let widthSize = Math.max(0, parseFloat(width)),\r\n        widthMode = ColumnWidthMode.AUTO; // Default\r\n\r\n    if (widthSize > 0) {\r\n        // Well, it's sure is not AUTO, as we have a value\r\n\r\n        if (width == widthSize + '%') {\r\n            // It's a percentage!\r\n\r\n            widthMode = ColumnWidthMode.RELATIVE;\r\n            widthSize /= 100;\r\n        } else if (widthSize > 0 && widthSize < 1) {\r\n            // It's a decimal value, as a relative value!\r\n\r\n            widthMode = ColumnWidthMode.RELATIVE;\r\n        } else {\r\n            // It's an absolute size!\r\n\r\n            if (widthSize < minWidth) {\r\n                widthSize = minWidth;\r\n            }\r\n            widthMode = ColumnWidthMode.ABSOLUTE;\r\n        }\r\n    }\r\n\r\n    return { width: widthSize, mode: widthMode };\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {COLUMN_OPTIONS} columnData\r\n */\r\nDGTable.prototype._initColumnFromData = function(columnData) {\r\n\r\n    let parsedWidth = this._parseColumnWidth(columnData.width, columnData.ignoreMin ? 0 : this.o.minColumnWidth);\r\n\r\n    let col = {\r\n        name: columnData.name,\r\n        label: columnData.label === undefined ? columnData.name : columnData.label,\r\n        width: parsedWidth.width,\r\n        widthMode: parsedWidth.mode,\r\n        resizable: columnData.resizable === undefined ? true : columnData.resizable,\r\n        sortable: columnData.sortable === undefined ? true : columnData.sortable,\r\n        movable: columnData.movable === undefined ? true : columnData.movable,\r\n        visible: columnData.visible === undefined ? true : columnData.visible,\r\n        cellClasses: columnData.cellClasses === undefined ? this.o.cellClasses : columnData.cellClasses,\r\n        ignoreMin: columnData.ignoreMin === undefined ? false : !!columnData.ignoreMin,\r\n    };\r\n\r\n    col.dataPath = columnData.dataPath === undefined ? col.name : columnData.dataPath;\r\n    col.comparePath = columnData.comparePath === undefined ? col.dataPath : columnData.comparePath;\r\n\r\n    if (typeof col.dataPath === 'string') {\r\n        col.dataPath = col.dataPath.split('.');\r\n    }\r\n    if (typeof col.comparePath === 'string') {\r\n        col.comparePath = col.comparePath.split('.');\r\n    }\r\n\r\n    return col;\r\n};\r\n\r\n/**\r\n * Destroy, releasing all memory, events and DOM elements\r\n * @public\r\n * @expose\r\n */\r\nDGTable.prototype.close = DGTable.prototype.remove = DGTable.prototype.destroy = function () {\r\n\r\n    let that = this,\r\n        p = that.p || {},\r\n        $el = that.$el;\r\n\r\n    if (that.__removed) {\r\n        return that;\r\n    }\r\n\r\n    if (p.$resizer) {\r\n        p.$resizer.remove();\r\n        p.$resizer = null;\r\n    }\r\n\r\n    if (p.$tbody) {\r\n        let trs = p.$tbody[0].childNodes;\r\n        for (let i = 0, len = trs.length; i < len; i++) {\r\n            that.trigger('rowdestroy', trs[i]);\r\n        }\r\n    }\r\n\r\n    // Using quotes for __super__ because Google Closure Compiler has a bug...\r\n\r\n    this._destroyHeaderCells()._unbindCellEventsForTable();\r\n    if (p.$table) {\r\n        p.$table.empty();\r\n    }\r\n    if (p.$tbody) {\r\n        p.$tbody.empty();\r\n    }\r\n\r\n    if (p.workerListeners) {\r\n        for (let j = 0; j < p.workerListeners.length; j++) {\r\n            let worker = p.workerListeners[j];\r\n            worker.worker.removeEventListener('message', worker.listener, false);\r\n        }\r\n        p.workerListeners.length = 0;\r\n    }\r\n\r\n    p.rows.length = p.columns.length = 0;\r\n\r\n    if (p._deferredRender) {\r\n        clearTimeout(p._deferredRender);\r\n    }\r\n\r\n    // Cleanup\r\n    for (let prop in that) {\r\n        if (hasOwnProperty.call(that, prop)) {\r\n            that[prop] = null;\r\n        }\r\n    }\r\n\r\n    that.__removed = true;\r\n\r\n    if ($el) {\r\n        $el.remove();\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._unbindCellEventsForTable = function() {\r\n    const p = this.p;\r\n    \r\n    if (p.headerRow) {\r\n        for (let i = 0, rows = p.headerRow.childNodes, rowCount = rows.length; i < rowCount; i++) {\r\n            let rowToClean = rows[i];\r\n            for (let j = 0, cells = rowToClean.childNodes, cellCount = cells.length; j < cellCount; j++) {\r\n                p._unbindCellHoverIn(cells[j]);\r\n            }\r\n        }\r\n    }\r\n    \r\n    if (p.tbody) {\r\n        for (let i = 0, rows = p.tbody.childNodes, rowCount = rows.length; i < rowCount; i++) {\r\n            this._unbindCellEventsForRow(rows[i]);\r\n        }\r\n    }\r\n    \r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {HTMLElement} rowToClean\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._unbindCellEventsForRow = function(rowToClean) {\r\n    const p = this.p;\r\n    for (let i = 0, cells = rowToClean.childNodes, cellCount = cells.length; i < cellCount; i++) {\r\n        p._unbindCellHoverIn(cells[i]);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.render = function () {\r\n    const o = this.o, p = this.p;\r\n\r\n    if (!this.el.offsetParent) {\r\n        if (!p._deferredRender) {\r\n            p._deferredRender = setTimeout(() => {\r\n                p._deferredRender = null;\r\n                if (!this.__removed && this.el.offsetParent) {\r\n                    this.render();\r\n                }\r\n            });\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    let renderedRows, rowCount;\r\n\r\n    if (p.tableSkeletonNeedsRendering === true) {\r\n        p.tableSkeletonNeedsRendering = false;\r\n\r\n        if (o.width == DGTable.Width.AUTO) {\r\n            // We need to do this to return to the specified widths instead. The arrows added to the column widths...\r\n            this._clearSortArrows();\r\n        }\r\n\r\n        let lastScrollTop = p.table ? p.table.scrollTop : 0,\r\n            lastScrollLeft = p.table ? p.table.scrollLeft : 0;\r\n\r\n        this._renderSkeletonBase()\r\n            ._renderSkeletonBody()\r\n            .tableWidthChanged(true, false) // Take this chance to calculate required column widths\r\n            ._renderSkeletonHeaderCells();\r\n            \r\n        if (!o.virtualTable) {\r\n            let rows = p.filteredRows || p.rows;\r\n            rowCount = rows.length;\r\n            renderedRows = this.renderRows(0, rowCount - 1);\r\n            p.$tbody.html('').append(renderedRows);\r\n            this._updateLastCellWidthFromScrollbar(true);\r\n        } else {\r\n            this._updateLastCellWidthFromScrollbar(); // Detect vertical scrollbar height\r\n        }\r\n\r\n        p.table.scrollTop = lastScrollTop;\r\n        p.table.scrollLeft = lastScrollLeft;\r\n        p.header.scrollLeft = lastScrollLeft;\r\n\r\n        this._updateTableWidth(true);\r\n\r\n        // Show sort arrows\r\n        for (let i = 0; i < p.rows.sortColumn.length; i++) {\r\n            this._showSortArrow(p.rows.sortColumn[i].column, p.rows.sortColumn[i].descending);\r\n        }\r\n        if (o.adjustColumnWidthForSortArrow && p.rows.sortColumn.length) {\r\n            this.tableWidthChanged(true);\r\n        } else if (!o.virtualTable) {\r\n            this.tableWidthChanged();\r\n        }\r\n\r\n        this.trigger('renderskeleton');\r\n\r\n        if (o.virtualTable) {\r\n            p.$table.on('scroll', this._onVirtualTableScrolled.bind(this));\r\n            this.render();\r\n        }\r\n\r\n    } else if (o.virtualTable) {\r\n        rowCount = (p.filteredRows || p.rows).length;\r\n        let scrollTop = p.table.scrollTop;\r\n        let firstVisible = Math.floor((scrollTop - p.virtualRowHeightFirst) / p.virtualRowHeight) + 1 - o.rowsBufferSize;\r\n        let lastVisible = Math.ceil(((scrollTop - p.virtualRowHeightFirst + p.visibleHeight) / p.virtualRowHeight)) + o.rowsBufferSize;\r\n        if (firstVisible < 0) firstVisible = 0;\r\n        if (lastVisible >= rowCount) {\r\n            lastVisible = rowCount - 1;\r\n        }\r\n\r\n        let oldFirstVisible = -1, oldLastVisible = -1;\r\n        let tbodyChildNodes = p.tbody.childNodes;\r\n        if (tbodyChildNodes.length) {\r\n            oldFirstVisible = tbodyChildNodes[0]['rowIndex'];\r\n            oldLastVisible = tbodyChildNodes[tbodyChildNodes.length - 1]['rowIndex'];\r\n        }\r\n\r\n        let countToRemove;\r\n\r\n        if (oldFirstVisible !== -1 && oldFirstVisible < firstVisible) {\r\n            countToRemove = Math.min(oldLastVisible + 1, firstVisible) - oldFirstVisible;\r\n            for (let i = 0; i < countToRemove; i++) {\r\n                this.trigger('rowdestroy', tbodyChildNodes[0]);\r\n                this._unbindCellEventsForRow(tbodyChildNodes[0]);\r\n                p.tbody.removeChild(tbodyChildNodes[0]);\r\n            }\r\n            oldFirstVisible += countToRemove;\r\n            if (oldFirstVisible > oldLastVisible) {\r\n                oldFirstVisible = oldLastVisible = -1;\r\n            }\r\n        } else if (oldLastVisible !== -1 && oldLastVisible > lastVisible) {\r\n            countToRemove = oldLastVisible - Math.max(oldFirstVisible - 1, lastVisible);\r\n            for (let i = 0; i < countToRemove; i++) {\r\n                this.trigger('rowdestroy', tbodyChildNodes[tbodyChildNodes.length - 1]);\r\n                this._unbindCellEventsForRow(tbodyChildNodes[tbodyChildNodes.length - 1]);\r\n                p.tbody.removeChild(tbodyChildNodes[tbodyChildNodes.length - 1]);\r\n            }\r\n            if (oldLastVisible < oldFirstVisible) {\r\n                oldFirstVisible = oldLastVisible = -1;\r\n            }\r\n        }\r\n\r\n        if (firstVisible < oldFirstVisible) {\r\n            renderedRows = this.renderRows(firstVisible, Math.min(lastVisible, oldFirstVisible - 1));\r\n            p.$tbody.prepend(renderedRows);\r\n        }\r\n        if (lastVisible > oldLastVisible || oldLastVisible === -1) {\r\n            renderedRows = this.renderRows(oldLastVisible === -1 ? firstVisible : oldLastVisible + 1, lastVisible);\r\n            p.$tbody.append(renderedRows);\r\n        }\r\n    }\r\n    this.trigger('render');\r\n    return this;\r\n};\r\n\r\n/**\r\n * Forces a full render of the table\r\n * @public\r\n * @expose\r\n * @param {Boolean=true} render - Should render now?\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.clearAndRender = function (render) {\r\n    let p = this.p;\r\n\r\n    p.tableSkeletonNeedsRendering = true;\r\n\r\n    if (render === undefined || render) {\r\n        this.render();\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * Render rows\r\n * @private\r\n * @param {Number} first first row to render\r\n * @param {Number} last last row to render\r\n * @returns {DocumentFragment} fragment containing all rendered rows\r\n */\r\nDGTable.prototype.renderRows = function (first, last) {\r\n    const o = this.o, p = this.p;\r\n        \r\n    let tableClassName = o.tableClassName,\r\n        rowClassName = tableClassName + '-row',\r\n        cellClassName = tableClassName + '-cell',\r\n        rows = p.filteredRows || p.rows,\r\n        isDataFiltered = !!p.filteredRows,\r\n        allowCellPreview = o.allowCellPreview,\r\n        visibleColumns = p.visibleColumns,\r\n        isVirtual = o.virtualTable,\r\n        virtualRowHeightFirst = p.virtualRowHeightFirst,\r\n        virtualRowHeight = p.virtualRowHeight,\r\n        top,\r\n        physicalRowIndex;\r\n\r\n    let colCount = visibleColumns.length;\r\n    for (let colIndex = 0, column; colIndex < colCount; colIndex++) {\r\n        column = visibleColumns[colIndex];\r\n        column._finalWidth = (column.actualWidthConsideringScrollbarWidth || column.actualWidth);\r\n    }\r\n\r\n    let bodyFragment = document.createDocumentFragment();\r\n\r\n    let isRtl = this._isTableRtl(),\r\n        virtualRowXAttr = isRtl ? 'right' : 'left';\r\n\r\n    for (let i = first, rowCount = rows.length;\r\n         i < rowCount && i <= last;\r\n         i++) {\r\n\r\n        let rowData = rows[i];\r\n        physicalRowIndex = isDataFiltered ? rowData['__i'] : i;\r\n\r\n        let row = createElement('div');\r\n        row.className = rowClassName;\r\n        row['rowIndex'] = i;\r\n        row['physicalRowIndex'] = physicalRowIndex;\r\n\r\n        for (let colIndex = 0; colIndex < colCount; colIndex++) {\r\n            let column = visibleColumns[colIndex];\r\n            let cell = createElement('div');\r\n            cell['columnName'] = column.name;\r\n            cell.setAttribute('data-column', column.name);\r\n            cell.className = cellClassName;\r\n            cell.style.width = column._finalWidth + 'px';\r\n            if (column.cellClasses) cell.className += ' ' + column.cellClasses;\r\n            if (allowCellPreview) {\r\n                p._bindCellHoverIn(cell);\r\n            }\r\n            \r\n            let cellInner = cell.appendChild(createElement('div'));\r\n            cellInner.innerHTML = this._getHtmlForCell(rowData, column);\r\n            \r\n            row.appendChild(cell);\r\n        }\r\n\r\n        if (isVirtual) {\r\n            top = i > 0 ? virtualRowHeightFirst + (i - 1) * virtualRowHeight : 0;\r\n            row.style.position = 'absolute';\r\n            row.style[virtualRowXAttr] = 0;\r\n            row.style.top = top + 'px';\r\n        }\r\n\r\n        bodyFragment.appendChild(row);\r\n\r\n        this.trigger('rowcreate', i, physicalRowIndex, row, rowData);\r\n    }\r\n\r\n    return bodyFragment;\r\n};\r\n\r\n/**\r\n * Calculate virtual table height for scrollbar\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._calculateVirtualHeight = function () {\r\n    let p = this.p;\r\n\r\n    if (p.tbody) {\r\n        let rowCount = (p.filteredRows || p.rows).length;\r\n        let height = p.virtualRowHeight * rowCount;\r\n        if (rowCount) {\r\n            height += (p.virtualRowHeightFirst - p.virtualRowHeight);\r\n            height += (p.virtualRowHeightLast - p.virtualRowHeight);\r\n        }\r\n        // At least 1 pixel - to show scrollers correctly.\r\n        if (height < 1) {\r\n            height = 1;\r\n        }\r\n        p.tbody.style.height = height + 'px';\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Calculate the size required for the table body width (which is the row's width)\r\n * @private\r\n * @returns {Number} calculated width\r\n */\r\nDGTable.prototype._calculateTbodyWidth = function () {\r\n    const p = this.p;\r\n        \r\n    let tableClassName = this.o.tableClassName,\r\n        rowClassName = tableClassName + '-row',\r\n        cellClassName = tableClassName + '-cell',\r\n        visibleColumns = p.visibleColumns,\r\n        colCount = visibleColumns.length,\r\n        cell,\r\n        cellInner,\r\n        colIndex,\r\n        column;\r\n\r\n    let $row = $('<div>').addClass(rowClassName).css('float', 'left');\r\n    let sumActualWidth = 0;\r\n\r\n    for (colIndex = 0; colIndex < colCount; colIndex++) {\r\n        column = visibleColumns[colIndex];\r\n        cell = createElement('div');\r\n        cell.className = cellClassName;\r\n        cell.style.width = column.actualWidth + 'px';\r\n        if (column.cellClasses) cell.className += ' ' + column.cellClasses;\r\n        cellInner = cell.appendChild(createElement('div'));\r\n        $row.append(cell);\r\n        sumActualWidth += column.actualWidth;\r\n    }\r\n\r\n    let $thisWrapper = $('<div>')\r\n        .addClass(this.el.className)\r\n        .css({ 'z-index': -1, 'position': 'absolute', left: '0', top: '-9999px', 'float': 'left', width: '1px', overflow: 'hidden' })\r\n        .append(\r\n            $('<div>').addClass(tableClassName).append(\r\n                $('<div>').addClass(tableClassName + '-body').css('width', sumActualWidth + 10000).append(\r\n                    $row,\r\n                ),\r\n            ),\r\n        );\r\n\r\n    $thisWrapper.appendTo(document.body);\r\n\r\n    let fractionTest = $('<div style=\"border:1.5px solid #000;width:0;height:0;position:absolute;left:0;top:-9999px\">').appendTo(document.body);\r\n    let hasFractions = parseFloat(fractionTest.css('border-width'));\r\n    hasFractions = Math.round(hasFractions) != hasFractions;\r\n    fractionTest.remove();\r\n\r\n    let width = CssUtil.outerWidth($row);\r\n    width -= p.scrollbarWidth || 0;\r\n\r\n    if (hasFractions) {\r\n        width++;\r\n    }\r\n\r\n    $thisWrapper.remove();\r\n    return width;\r\n};\r\n\r\n/**\r\n * Sets the columns of the table\r\n * @public\r\n * @expose\r\n * @param {COLUMN_OPTIONS[]} columns - Column definitions array\r\n * @param {Boolean=true} render - Should render now?\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setColumns = function (columns, render) {\r\n    const p = this.p;\r\n        \r\n    columns = columns || [];\r\n\r\n    let normalizedCols = new ColumnCollection();\r\n    for (let i = 0, order = 0; i < columns.length; i++) {\r\n\r\n        let columnData = columns[i];\r\n        let normalizedColumn = this._initColumnFromData(columnData);\r\n\r\n        if (columnData.order !== undefined) {\r\n            if (columnData.order > order) {\r\n                order = columnData.order + 1;\r\n            }\r\n            normalizedColumn.order = columnData.order;\r\n        } else {\r\n            normalizedColumn.order = order++;\r\n        }\r\n\r\n        normalizedCols.push(normalizedColumn);\r\n    }\r\n    normalizedCols.normalizeOrder();\r\n\r\n    p.columns = normalizedCols;\r\n    p.visibleColumns = normalizedCols.getVisibleColumns();\r\n    \r\n    this._ensureVisibleColumns().clearAndRender(render);\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * Add a column to the table\r\n * @public\r\n * @expose\r\n * @param {COLUMN_OPTIONS} columnData column properties\r\n * @param {String|Number} [before=-1] column name or order to be inserted before\r\n * @param {Boolean=true} render - Should render now?\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.addColumn = function (columnData, before, render) {\r\n    const p = this.p;\r\n    let columns = p.columns;\r\n\r\n    if (columnData && !columns.get(columnData.name)) {\r\n        let beforeColumn = null;\r\n        if (before !== undefined) {\r\n            beforeColumn = columns.get(before) || columns.getByOrder(before);\r\n        }\r\n\r\n        let column = this._initColumnFromData(columnData);\r\n        column.order = beforeColumn ? beforeColumn.order : (columns.getMaxOrder() + 1);\r\n\r\n        for (let i = columns.getMaxOrder(), to = column.order; i >= to ; i--) {\r\n            let col = columns.getByOrder(i);\r\n            if (col) {\r\n                col.order++;\r\n            }\r\n        }\r\n\r\n        columns.push(column);\r\n        columns.normalizeOrder();\r\n\r\n        p.visibleColumns = columns.getVisibleColumns();\r\n        this._ensureVisibleColumns().clearAndRender(render);\r\n\r\n        this.trigger('addcolumn', column.name);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Remove a column from the table\r\n * @public\r\n * @expose\r\n * @param {String} column column name\r\n * @param {Boolean=true} render - Should render now?\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.removeColumn = function (column, render) {\r\n    const p = this.p;\r\n    let columns = p.columns;\r\n\r\n    let colIdx = columns.indexOf(column);\r\n    if (colIdx > -1) {\r\n        columns.splice(colIdx, 1);\r\n        columns.normalizeOrder();\r\n\r\n        p.visibleColumns = columns.getVisibleColumns();\r\n        this._ensureVisibleColumns().clearAndRender(render);\r\n\r\n        this.trigger('removecolumn', column);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Sets a new cell formatter.\r\n * @public\r\n * @expose\r\n * @param {function(value: *, columnName: String, row: Object):String|null} [formatter=null] - The cell formatter. Should return an HTML.\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setCellFormatter = function (formatter) {\r\n    /**\r\n     * @private\r\n     * @field {Function} cellFormatter */\r\n    this.o.cellFormatter = formatter || function (val) {\r\n        return (typeof val === 'string') ? htmlEncode(val) : val;\r\n    };\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * Sets a new header cell formatter.\r\n * @public\r\n * @expose\r\n * @param {function(label: String, columnName: String):String|null} [formatter=null] - The cell formatter. Should return an HTML.\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setHeaderCellFormatter = function (formatter) {\r\n    /**\r\n     * @private\r\n     * @field {Function} headerCellFormatter */\r\n    this.o.headerCellFormatter = formatter || function (val) {\r\n        return (typeof val === 'string') ? htmlEncode(val) : val;\r\n    };\r\n        \r\n    return this;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @param {function(row:Object,args:Object):Boolean|null} [filterFunc=null] - The filter function to work with filters. Default is a by-colum filter.\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setFilter = function (filterFunc) {\r\n    /** @private\r\n     * @field {Function} filter */\r\n    this.o.filter = filterFunc;\r\n    return this;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @param {Object|null} args - Options to pass to the filter function\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.filter = function (args) {\r\n    const p = this.p;\r\n    \r\n    let filterFunc = this.o.filter || ByColumnFilter;\r\n    \r\n    // Deprecated use of older by-column filter\r\n    if (typeof arguments[0] === 'string' && typeof arguments[1] === 'string') {\r\n        args = {\r\n            column: arguments[0],\r\n            keyword: arguments[1],\r\n            caseSensitive: arguments[2],\r\n        };\r\n    }\r\n    \r\n    let hadFilter = !!p.filteredRows;\r\n    if (p.filteredRows) {\r\n        p.filteredRows = null; // Allow releasing array memory now\r\n    }\r\n\r\n    // Shallow-clone the args, as the filter function may want to modify it for keeping state\r\n    p.filterArgs = (typeof args === 'object' && !Array.isArray(args)) ? $.extend({}, args) : args;\r\n    p.filteredRows = p.rows.filteredCollection(filterFunc, args);\r\n\r\n    if (hadFilter || p.filteredRows) {\r\n        this.clearAndRender();\r\n        this.trigger('filter', args);\r\n    }\r\n    \r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._refilter = function() {\r\n    const p = this.p;\r\n\r\n    if (p.filteredRows && p.filterArgs) {\r\n        let filterFunc = this.o.filter || ByColumnFilter;\r\n        p.filteredRows = p.rows.filteredCollection(filterFunc, p.filterArgs);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Set a new label to a column\r\n * @public\r\n * @expose\r\n * @param {String} column Name of the column\r\n * @param {String} label New label for the column\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setColumnLabel = function (column, label) {\r\n    const p = this.p;\r\n\r\n    let col = p.columns.get(column);\r\n    if (col) {\r\n        col.label = label === undefined ? col.name : label;\r\n\r\n        if (col.element) {\r\n            for (let i = 0; i < col.element[0].firstChild.childNodes.length; i++) {\r\n                let node = col.element[0].firstChild.childNodes[i];\r\n                if (node.nodeType === 3) {\r\n                    node.textContent = col.label;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Move a column to a new position\r\n * @public\r\n * @expose\r\n * @param {String|Number} src Name or position of the column to be moved\r\n * @param {String|Number} dest Name of the column currently in the desired position, or the position itself\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.moveColumn = function (src, dest) {\r\n    const o = this.o, p = this.p;\r\n        \r\n    let columns = p.columns,\r\n        col, destCol;\r\n\r\n    if (typeof src === 'string') {\r\n        col = columns.get(src);\r\n    } else if (typeof src === 'number') {\r\n        col = p.visibleColumns[src];\r\n    }\r\n    if (typeof dest === 'string') {\r\n        destCol = columns.get(dest);\r\n    } else if (typeof dest === 'number') {\r\n        destCol = p.visibleColumns[dest];\r\n    }\r\n\r\n    if (col && destCol && src !== dest) {\r\n        let srcOrder = col.order, destOrder = destCol.order;\r\n\r\n        p.visibleColumns = columns.moveColumn(col, destCol).getVisibleColumns();\r\n        this._ensureVisibleColumns();\r\n\r\n        if (o.virtualTable) {\r\n            this.clearAndRender()\r\n                ._updateLastCellWidthFromScrollbar(true);\r\n        } else {\r\n            let headerCell = p.$headerRow.find('>div.' + o.tableClassName + '-header-cell');\r\n            let beforePos = srcOrder < destOrder ? destOrder + 1 : destOrder,\r\n                fromPos = srcOrder;\r\n            headerCell[0].parentNode.insertBefore(headerCell[fromPos], headerCell[beforePos]);\r\n\r\n            let srcWidth = p.visibleColumns[srcOrder];\r\n            srcWidth = (srcWidth.actualWidthConsideringScrollbarWidth || srcWidth.actualWidth) + 'px';\r\n            let destWidth = p.visibleColumns[destOrder];\r\n            destWidth = (destWidth.actualWidthConsideringScrollbarWidth || destWidth.actualWidth) + 'px';\r\n\r\n            let tbodyChildren = p.$tbody[0].childNodes;\r\n            for (let i = 0, count = tbodyChildren.length; i < count; i++) {\r\n                let row = tbodyChildren[i];\r\n                if (row.nodeType !== 1) continue;\r\n                row.insertBefore(row.childNodes[fromPos], row.childNodes[beforePos]);\r\n                row.childNodes[destOrder].firstChild.style.width = destWidth;\r\n                row.childNodes[srcOrder].firstChild.style.width = srcWidth;\r\n            }\r\n        }\r\n\r\n        this.trigger('movecolumn', col.name, srcOrder, destOrder);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Sort the table\r\n * @public\r\n * @expose\r\n * @param {String?} column Name of the column to sort on (or null to remove sort arrow)\r\n * @param {Boolean=} descending Sort in descending order\r\n * @param {Boolean} [add=false] Should this sort be on top of the existing sort? (For multiple column sort)\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.sort = function (column, descending, add) {\r\n    const o = this.o, p = this.p;\r\n    \r\n    let columns = p.columns,\r\n        col = columns.get(column);\r\n\r\n    let currentSort = p.rows.sortColumn;\r\n        \r\n    if (col) {\r\n\r\n        if (currentSort.length && currentSort[currentSort.length - 1].column == column) {\r\n            // Recognize current descending mode, if currently sorting by this column\r\n            descending = descending === undefined ? !currentSort[currentSort.length - 1].descending : descending;\r\n        }\r\n\r\n        if (add) { // Add the sort to current sort stack\r\n\r\n            for (let i = 0; i < currentSort.length; i++) {\r\n                if (currentSort[i].column == col.name) {\r\n                    if (i < currentSort.length - 1) {\r\n                        currentSort.length = 0;\r\n                    } else {\r\n                        currentSort.splice(currentSort.length - 1, 1);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n            if ((o.sortableColumns > 0 /* allow manual sort when disabled */ && currentSort.length >= o.sortableColumns) || currentSort.length >= p.visibleColumns.length) {\r\n                currentSort.length = 0;\r\n            }\r\n\r\n        } else { // Sort only by this column\r\n            currentSort.length = 0;\r\n        }\r\n\r\n        // Default to ascending\r\n        descending = descending === undefined ? false : descending;\r\n\r\n        // Set the required column in the front of the stack\r\n        currentSort.push({\r\n            column: col.name,\r\n            comparePath: col.comparePath || col.dataPath,\r\n            descending: !!descending,\r\n        });\r\n    } else {\r\n        currentSort.length = 0;\r\n    }\r\n\r\n    this._clearSortArrows();\r\n\r\n    for (let i = 0; i < currentSort.length; i++) {\r\n        this._showSortArrow(currentSort[i].column, currentSort[i].descending);\r\n    }\r\n\r\n    if (o.adjustColumnWidthForSortArrow && !o._tableSkeletonNeedsRendering) {\r\n        this.tableWidthChanged(true);\r\n    }\r\n\r\n    if (o.virtualTable) {\r\n        while (p.tbody && p.tbody.firstChild) {\r\n            this.trigger('rowdestroy', p.tbody.firstChild);\r\n            this._unbindCellEventsForRow(p.tbody.firstChild);\r\n            p.tbody.removeChild(p.tbody.firstChild);\r\n        }\r\n    } else {\r\n        p.tableSkeletonNeedsRendering = true;\r\n    }\r\n\r\n    p.rows.sortColumn = currentSort;\r\n    \r\n    if (currentSort.length) {\r\n        p.rows.sort(!!p.filteredRows);\r\n        if (p.filteredRows) {\r\n            p.filteredRows.sort(!!p.filteredRows);\r\n        }\r\n    }\r\n\r\n    // Build output for event, with option names that will survive compilers\r\n    let sorts = [];\r\n    for (let i = 0; i < currentSort.length; i++) {\r\n        sorts.push({ 'column': currentSort[i].column, 'descending': currentSort[i].descending });\r\n    }\r\n    this.trigger('sort', sorts);\r\n    \r\n    return this;\r\n};\r\n\r\n/**\r\n * Re-sort the table using current sort specifiers\r\n * @public\r\n * @expose\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.resort = function () {\r\n    const p = this.p;\r\n    let columns = p.columns;\r\n\r\n    let currentSort = p.rows.sortColumn;\r\n    if (currentSort.length) {\r\n        \r\n        for (let i = 0; i < currentSort.length; i++) {\r\n            if (!columns.get(currentSort[i].column)) {\r\n                currentSort.splice(i--, 1);\r\n            }\r\n        }\r\n        \r\n        p.rows.sortColumn = currentSort;\r\n        if (currentSort.length) {\r\n            p.rows.sort(!!p.filteredRows);\r\n            if (p.filteredRows) {\r\n                p.filteredRows.sort(!!p.filteredRows);\r\n            }\r\n        }\r\n\r\n        // Build output for event, with option names that will survive compilers\r\n        let sorts = [];\r\n        for (let i = 0; i < currentSort.length; i++) {\r\n            sorts.push({ 'column': currentSort[i].column, 'descending': currentSort[i].descending });\r\n        }\r\n        this.trigger('sort', sorts);\r\n    }\r\n    \r\n    \r\n    return this;\r\n};\r\n\r\n/**\r\n * Make sure there's at least one column visible\r\n * @private\r\n * @expose\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._ensureVisibleColumns = function () {\r\n    const p = this.p;\r\n\r\n    if (p.visibleColumns.length === 0 && p.columns.length) {\r\n        p.columns[0].visible = true;\r\n        p.visibleColumns.push(p.columns[0]);\r\n        this.trigger('showcolumn', p.columns[0].name);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Show or hide a column\r\n * @public\r\n * @expose\r\n * @param {String} column Unique column name\r\n * @param {Boolean} visible New visibility mode for the column\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setColumnVisible = function (column, visible) {\r\n    const p = this.p;\r\n\r\n    let col = p.columns.get(column);\r\n\r\n    //noinspection PointlessBooleanExpressionJS\r\n    visible = !!visible;\r\n\r\n    if (col && !!col.visible != visible) {\r\n        col.visible = visible;\r\n        p.visibleColumns = p.columns.getVisibleColumns();\r\n        this.trigger(visible ? 'showcolumn' : 'hidecolumn', column);\r\n        this._ensureVisibleColumns();\r\n        this.clearAndRender();\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Get the visibility mode of a column\r\n * @public\r\n * @expose\r\n * @returns {Boolean} true if visible\r\n */\r\nDGTable.prototype.isColumnVisible = function (column) {\r\n    const p = this.p;\r\n    let col = p.columns.get(column);\r\n    if (col) {\r\n        return col.visible;\r\n    }\r\n    return false;\r\n};\r\n\r\n/**\r\n * Globally set the minimum column width\r\n * @public\r\n * @expose\r\n * @param {Number} minColumnWidth Minimum column width\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setMinColumnWidth = function (minColumnWidth) {\r\n    let o = this.o;\r\n    minColumnWidth = Math.max(minColumnWidth, 0);\r\n    if (o.minColumnWidth != minColumnWidth) {\r\n        o.minColumnWidth = minColumnWidth;\r\n        this.tableWidthChanged(true);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Get the current minimum column width\r\n * @public\r\n * @expose\r\n * @returns {Number} Minimum column width\r\n */\r\nDGTable.prototype.getMinColumnWidth = function () {\r\n    return this.o.minColumnWidth;\r\n};\r\n\r\n/**\r\n * Set the limit on concurrent columns sorted\r\n * @public\r\n * @expose\r\n * @param {Number} sortableColumns How many sortable columns to allow?\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setSortableColumns = function (sortableColumns) {\r\n    const p = this.p, o = this.o;\r\n    if (o.sortableColumns != sortableColumns) {\r\n        o.sortableColumns = sortableColumns;\r\n        if (p.$table) {\r\n            let headerCell = p.$headerRow.find('>div.' + o.tableClassName + '-header-cell');\r\n            for (let i = 0; i < headerCell.length; i++) {\r\n                $(headerCell[0])[(o.sortableColumns > 0 && p.visibleColumns[i].sortable) ? 'addClass' : 'removeClass']('sortable');\r\n            }\r\n        }\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Get the limit on concurrent columns sorted\r\n * @public\r\n * @expose\r\n * @returns {Number} How many sortable columns are allowed?\r\n */\r\nDGTable.prototype.getSortableColumns = function () {\r\n    return this.o.sortableColumns;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @param {Boolean?} movableColumns=true are the columns movable?\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setMovableColumns = function (movableColumns) {\r\n    let o = this.o;\r\n    //noinspection PointlessBooleanExpressionJS\r\n    movableColumns = movableColumns === undefined ? true : !!movableColumns;\r\n    if (o.movableColumns != movableColumns) {\r\n        o.movableColumns = movableColumns;\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @returns {Boolean} are the columns movable?\r\n */\r\nDGTable.prototype.getMovableColumns = function () {\r\n    return this.o.movableColumns;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @param {Boolean} resizableColumns=true are the columns resizable?\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setResizableColumns = function (resizableColumns) {\r\n    let o = this.o;\r\n    //noinspection PointlessBooleanExpressionJS\r\n    resizableColumns = resizableColumns === undefined ? true : !!resizableColumns;\r\n    if (o.resizableColumns != resizableColumns) {\r\n        o.resizableColumns = resizableColumns;\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @returns {Boolean} are the columns resizable?\r\n */\r\nDGTable.prototype.getResizableColumns = function () {\r\n    return this.o.resizableColumns;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @param {{function(string,boolean):{function(a:*,b:*):boolean}}} comparatorCallback a callback function that returns the comparator for a specific column\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setComparatorCallback = function (comparatorCallback) {\r\n    let o = this.o;\r\n    if (o.onComparatorRequired != comparatorCallback) {\r\n        o.onComparatorRequired = comparatorCallback;\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Set a new width to a column\r\n * @public\r\n * @expose\r\n * @param {String} column name of the column to resize\r\n * @param {Number|String} width new column as pixels, or relative size (0.5, 50%)\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setColumnWidth = function (column, width) {\r\n\r\n    const p = this.p;\r\n\r\n    let col = p.columns.get(column);\r\n\r\n    let parsedWidth = this._parseColumnWidth(width, col.ignoreMin ? 0 : this.o.minColumnWidth);\r\n\r\n    if (col) {\r\n        let oldWidth = this._serializeColumnWidth(col);\r\n\r\n        col.width = parsedWidth.width;\r\n        col.widthMode = parsedWidth.mode;\r\n\r\n        let newWidth = this._serializeColumnWidth(col);\r\n\r\n        if (oldWidth != newWidth) {\r\n            this.tableWidthChanged(true); // Calculate actual sizes\r\n        }\r\n\r\n        this.trigger('columnwidth', col.name, oldWidth, newWidth);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @param {String} column name of the column\r\n * @returns {String|null} the serialized width of the specified column, or null if column not found\r\n */\r\nDGTable.prototype.getColumnWidth = function (column) {\r\n    const p = this.p;\r\n\r\n    let col = p.columns.get(column);\r\n    if (col) {\r\n        return this._serializeColumnWidth(col);\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @param {String} column name of the column\r\n * @returns {SERIALIZED_COLUMN|null} configuration for all columns\r\n */\r\nDGTable.prototype.getColumnConfig = function (column) {\r\n    const p = this.p;\r\n    let col = p.columns.get(column);\r\n    if (col) {\r\n        return {\r\n            'order': col.order,\r\n            'width': this._serializeColumnWidth(col),\r\n            'visible': col.visible,\r\n            'label': col.label,\r\n        };\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Returns a config object for the columns, to allow saving configurations for next time...\r\n * @public\r\n * @expose\r\n * @returns {Object} configuration for all columns\r\n */\r\nDGTable.prototype.getColumnsConfig = function () {\r\n    const p = this.p;\r\n\r\n    let config = {};\r\n    for (let i = 0; i < p.columns.length; i++) {\r\n        config[p.columns[i].name] = this.getColumnConfig(p.columns[i].name);\r\n    }\r\n    return config;\r\n};\r\n\r\n/**\r\n * Returns an array of the currently sorted columns\r\n * @public\r\n * @expose\r\n * @returns {Array.<SERIALIZED_COLUMN_SORT>} configuration for all columns\r\n */\r\nDGTable.prototype.getSortedColumns = function () {\r\n    const p = this.p;\r\n\r\n    let sorted = [];\r\n    for (let i = 0; i < p.rows.sortColumn.length; i++) {\r\n        let sort = p.rows.sortColumn[i];\r\n        sorted.push({ column: sort.column, descending: sort.descending });\r\n    }\r\n    return sorted;\r\n};\r\n\r\n/**\r\n * Returns the HTML string for a specific cell. Can be used externally for special cases (i.e. when setting a fresh HTML in the cell preview through the callback).\r\n * @public\r\n * @expose\r\n * @param {Number} row - index of the row\r\n * @param {String} columnName - name of the column\r\n * @returns {String} HTML string for the specified cell\r\n */\r\nDGTable.prototype.getHtmlForCell = function (row, columnName) {\r\n    const p = this.p;\r\n\r\n    if (row < 0 || row > p.rows.length - 1) return null;\r\n    let column = p.columns.get(columnName);\r\n    if (!column) return null;\r\n    let rowData = p.rows[row];\r\n\r\n    return this._getHtmlForCell(rowData, column);\r\n};\r\n\r\n/**\r\n * Returns the HTML string for a specific cell. Can be used externally for special cases (i.e. when setting a fresh HTML in the cell preview through the callback).\r\n * @public\r\n * @expose\r\n * @param {Object} rowData - row data\r\n * @param {Object} column - column data\r\n * @returns {String} HTML string for the specified cell\r\n */\r\nDGTable.prototype._getHtmlForCell = function (rowData, column) {\r\n    let dataPath = column.dataPath;\r\n    let colValue = rowData[dataPath[0]];\r\n    for (let dataPathIndex = 1; dataPathIndex < dataPath.length; dataPathIndex++) {\r\n        if (colValue == null) break;\r\n        colValue = colValue && colValue[dataPath[dataPathIndex]];\r\n    }\r\n\r\n    let content = this.o.cellFormatter(colValue, column.name, rowData);\r\n    if (content === undefined) {\r\n        content = '';\r\n    }\r\n    \r\n    return content;\r\n};\r\n\r\n/**\r\n * Returns the y pos of a row by index\r\n * @public\r\n * @expose\r\n * @param {Number} rowIndex - index of the row\r\n * @returns {Number|null} Y pos\r\n */\r\nDGTable.prototype.getRowYPos = function (rowIndex) {\r\n    const p = this.p;\r\n    \r\n    if (this.o.virtualTable) {\r\n        return rowIndex > 0 ? p.virtualRowHeightFirst + (rowIndex - 1) * p.virtualRowHeight : 0;\r\n    } else {\r\n        let row = p.tbody.childNodes[rowIndex];\r\n        return row ? row.offsetTop : null;\r\n    }\r\n};\r\n\r\n/**\r\n * Returns the row data for a specific row\r\n * @public\r\n * @expose\r\n * @param {Number} row index of the row\r\n * @returns {Object} Row data\r\n */\r\nDGTable.prototype.getDataForRow = function (row) {\r\n    const p = this.p;\r\n\r\n    if (row < 0 || row > p.rows.length - 1) return null;\r\n    return p.rows[row];\r\n};\r\n\r\n/**\r\n * Gets the number of rows\r\n * @public\r\n * @expose\r\n * @returns {Number} Row count\r\n */\r\nDGTable.prototype.getRowCount = function () {\r\n    const p = this.p;\r\n    return p.rows ? p.rows.length : 0;\r\n};\r\n\r\n/**\r\n * Returns the physical row index for specific row\r\n * @public\r\n * @expose\r\n * @param {Object} rowData - Row data to find\r\n * @returns {Number} Row index\r\n */\r\nDGTable.prototype.getIndexForRow = function (rowData) {\r\n    const p = this.p;\r\n    return p.rows.indexOf(rowData);\r\n};\r\n\r\n/**\r\n * Gets the number of filtered rows\r\n * @public\r\n * @expose\r\n * @returns {Number} Filtered row count\r\n */\r\nDGTable.prototype.getFilteredRowCount = function () {\r\n    const p = this.p;\r\n    return (p.filteredRows || p.rows).length;\r\n};\r\n\r\n/**\r\n * Returns the filtered row index for specific row\r\n * @public\r\n * @expose\r\n * @param {Object} rowData - Row data to find\r\n * @returns {Number} Row index\r\n */\r\nDGTable.prototype.getIndexForFilteredRow = function (rowData) {\r\n    const p = this.p;\r\n    return (p.filteredRows || p.rows).indexOf(rowData);\r\n};\r\n\r\n/**\r\n * Returns the row data for a specific row\r\n * @public\r\n * @expose\r\n * @param {Number} row index of the filtered row\r\n * @returns {Object} Row data\r\n */\r\nDGTable.prototype.getDataForFilteredRow = function (row) {\r\n    const p = this.p;\r\n    if (row < 0 || row > (p.filteredRows || p.rows).length - 1) return null;\r\n    return (p.filteredRows || p.rows)[row];\r\n};\r\n\r\n/**\r\n * Returns DOM element of the header row\r\n * @public\r\n * @expose\r\n * @returns {Element} Row element\r\n */\r\nDGTable.prototype.getHeaderRowElement = function () {\r\n    return this.p.headerRow;\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {Element} el\r\n * @returns {Number} width\r\n */\r\nDGTable.prototype._horizontalPadding = function(el) {\r\n    return ((parseFloat($.css(el, 'padding-left')) || 0) +\r\n    (parseFloat($.css(el, 'padding-right')) || 0));\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {Element} el\r\n * @returns {Number} width\r\n */\r\nDGTable.prototype._horizontalBorderWidth = function(el) {\r\n    return ((parseFloat($.css(el, 'border-left')) || 0) +\r\n    (parseFloat($.css(el, 'border-right')) || 0));\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {Number} width\r\n */\r\nDGTable.prototype._calculateWidthAvailableForColumns = function() {\r\n    const o = this.o, p = this.p;\r\n\r\n    // Changing display mode briefly, to prevent taking in account the  parent's scrollbar width when we are the cause for it\r\n    let oldDisplay, lastScrollTop, lastScrollLeft;\r\n    if (p.$table) {\r\n        lastScrollTop = p.table ? p.table.scrollTop : 0;\r\n        lastScrollLeft = p.table ? p.table.scrollLeft : 0;\r\n\r\n        if (o.virtualTable) {\r\n            oldDisplay = p.$table[0].style.display;\r\n            p.$table[0].style.display = 'none';\r\n        }\r\n    }\r\n\r\n    let detectedWidth = CssUtil.width(this.$el);\r\n\r\n    if (p.$table) {\r\n        if (o.virtualTable) {\r\n            p.$table[0].style.display = oldDisplay;\r\n        }\r\n\r\n        p.table.scrollTop = lastScrollTop;\r\n        p.table.scrollLeft = lastScrollLeft;\r\n        p.header.scrollLeft = lastScrollLeft;\r\n    }\r\n\r\n    let tableClassName = o.tableClassName;\r\n\r\n    let $thisWrapper = $('<div>').addClass(this.el.className).css({ 'z-index': -1, 'position': 'absolute', left: '0', top: '-9999px' });\r\n    let $header = $('<div>').addClass(tableClassName + '-header').appendTo($thisWrapper);\r\n    let $headerRow = $('<div>').addClass(tableClassName + '-header-row').appendTo($header);\r\n    for (let i = 0; i < p.visibleColumns.length; i++) {\r\n        $headerRow.append($('<div><div></div></div>').addClass(tableClassName + '-header-cell').addClass(p.visibleColumns[i].cellClasses || ''));\r\n    }\r\n    $thisWrapper.appendTo(document.body);\r\n\r\n    detectedWidth -= this._horizontalBorderWidth($headerRow[0]);\r\n\r\n    let $cells = $headerRow.find('>div.' + tableClassName + '-header-cell');\r\n    for (let i = 0; i < $cells.length; i++) {\r\n        let $cell = $($cells[i]);\r\n\r\n        let isBoxing = $cell.css('boxSizing') === 'border-box';\r\n        if (!isBoxing) {\r\n            detectedWidth -=\r\n                (parseFloat($cell.css('border-right-width')) || 0) +\r\n                (parseFloat($cell.css('border-left-width')) || 0) +\r\n                (this._horizontalPadding($cell[0])); // CELL's padding\r\n        }\r\n    }\r\n\r\n    if ($thisWrapper) {\r\n        $thisWrapper.remove();\r\n    }\r\n\r\n    return Math.max(0, detectedWidth);\r\n};\r\n\r\n/**\r\n * Notify the table that its width has changed\r\n * @public\r\n * @expose\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.tableWidthChanged = (function () {\r\n\r\n    let getTextWidth = function(text) {\r\n        let tableClassName = this.o.tableClassName;\r\n\r\n        let $cell, $tableWrapper = $('<div>').addClass(this.$el).append(\r\n            $('<div>').addClass(tableClassName + '-header').append(\r\n                $('<div>').addClass(tableClassName + '-header-row').append(\r\n                    $cell = $('<div>').addClass(tableClassName + '-header-cell').append(\r\n                        $('<div>').text(text),\r\n                    ),\r\n                ),\r\n            ),\r\n        ).css({ 'position': 'absolute', top: '-9999px', 'visibility': 'hidden' });\r\n        $tableWrapper.appendTo(document.body);\r\n\r\n        let width = CssUtil.width($cell);\r\n\r\n        $tableWrapper.remove();\r\n\r\n        return width;\r\n    };\r\n\r\n    let lastDetectedWidth = null;\r\n\r\n    /**\r\n     * @public\r\n     * @expose\r\n     * @param {Boolean} [forceUpdate=false]\r\n     * @param {Boolean} [renderColumns=true]\r\n     * @returns {DGTable} self\r\n     */\r\n    return function(forceUpdate, renderColumns) {\r\n\r\n        let that = this,\r\n            o = that.o,\r\n            p = that.p,\r\n            detectedWidth = this._calculateWidthAvailableForColumns(),\r\n            sizeLeft = detectedWidth,\r\n            relatives = 0;\r\n\r\n        renderColumns = renderColumns === undefined || renderColumns;\r\n\r\n        let tableWidthBeforeCalculations = 0;\r\n\r\n        if (!p.tbody) {\r\n            renderColumns = false;\r\n        }\r\n\r\n        if (renderColumns) {\r\n            tableWidthBeforeCalculations = parseFloat(p.tbody.style.minWidth) || 0;\r\n        }\r\n\r\n        if (sizeLeft != lastDetectedWidth || forceUpdate) {\r\n            lastDetectedWidth = detectedWidth;\r\n\r\n            let absWidthTotal = 0, changedColumnIndexes = [], totalRelativePercentage = 0;\r\n\r\n            for (let i = 0; i < p.columns.length; i++) {\r\n                p.columns[i].actualWidthConsideringScrollbarWidth = null;\r\n            }\r\n\r\n            for (let i = 0; i < p.visibleColumns.length; i++) {\r\n                let col = p.visibleColumns[i];\r\n                if (col.widthMode === ColumnWidthMode.ABSOLUTE) {\r\n                    let width = col.width;\r\n                    width += col.arrowProposedWidth || 0; // Sort-arrow width\r\n                    if (!col.ignoreMin && width < o.minColumnWidth) {\r\n                        width = o.minColumnWidth;\r\n                    }\r\n                    sizeLeft -= width;\r\n                    absWidthTotal += width;\r\n\r\n                    // Update actualWidth\r\n                    if (width !== col.actualWidth) {\r\n                        col.actualWidth = width;\r\n                        changedColumnIndexes.push(i);\r\n                    }\r\n                } else if (col.widthMode === ColumnWidthMode.AUTO) {\r\n                    let width = getTextWidth.call(this, col.label) + 20;\r\n                    width += col.arrowProposedWidth || 0; // Sort-arrow width\r\n                    if (!col.ignoreMin && width < o.minColumnWidth) {\r\n                        width = o.minColumnWidth;\r\n                    }\r\n                    sizeLeft -= width;\r\n                    absWidthTotal += width;\r\n\r\n                    // Update actualWidth\r\n                    if (width !== col.actualWidth) {\r\n                        col.actualWidth = width;\r\n                        if (!o.convertColumnWidthsToRelative) {\r\n                            changedColumnIndexes.push(i);\r\n                        }\r\n                    }\r\n                } else if (col.widthMode === ColumnWidthMode.RELATIVE) {\r\n                    totalRelativePercentage += col.width;\r\n                    relatives++;\r\n                }\r\n            }\r\n\r\n            // Normalize relative sizes if needed\r\n            if (o.convertColumnWidthsToRelative) {\r\n                for (let i = 0; i < p.visibleColumns.length; i++) {\r\n                    let col = p.visibleColumns[i];\r\n                    if (col.widthMode === ColumnWidthMode.AUTO) {\r\n                        col.widthMode = ColumnWidthMode.RELATIVE;\r\n                        sizeLeft += col.actualWidth;\r\n                        col.width = col.actualWidth / absWidthTotal;\r\n                        totalRelativePercentage += col.width;\r\n                        relatives++;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Normalize relative sizes if needed\r\n            if (relatives && ((totalRelativePercentage < 1 && o.relativeWidthGrowsToFillWidth) ||\r\n                (totalRelativePercentage > 1 && o.relativeWidthShrinksToFillWidth))) {\r\n                for (let i = 0; i < p.visibleColumns.length; i++) {\r\n                    let col = p.visibleColumns[i];\r\n                    if (col.widthMode === ColumnWidthMode.RELATIVE) {\r\n                        col.width /= totalRelativePercentage;\r\n                    }\r\n                }\r\n            }\r\n\r\n            let sizeLeftForRelative = Math.max(0, sizeLeft); // Use this as the space to take the relative widths out of\r\n            if (sizeLeftForRelative === 0) {\r\n                sizeLeftForRelative = p.table.clientWidth;\r\n            }\r\n\r\n            let minColumnWidthRelative = (o.minColumnWidth / sizeLeftForRelative);\r\n            if (isNaN(minColumnWidthRelative)) {\r\n                minColumnWidthRelative = 0;\r\n            }\r\n            if (minColumnWidthRelative > 0) {\r\n                let extraRelative = 0, delta;\r\n\r\n                // First pass - make sure they are all constrained to the minimum width\r\n                for (let i = 0; i < p.visibleColumns.length; i++) {\r\n                    let col = p.visibleColumns[i];\r\n                    if (col.widthMode === ColumnWidthMode.RELATIVE) {\r\n                        if (!col.ignoreMin && col.width < minColumnWidthRelative) {\r\n                            extraRelative += minColumnWidthRelative - col.width;\r\n                            col.width = minColumnWidthRelative;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Second pass - try to take the extra width out of the other columns to compensate\r\n                for (let i = 0; i < p.visibleColumns.length; i++) {\r\n                    let col = p.visibleColumns[i];\r\n                    if (col.widthMode === ColumnWidthMode.RELATIVE) {\r\n                        if (!col.ignoreMin && col.width > minColumnWidthRelative) {\r\n                            if (extraRelative > 0) {\r\n                                delta = Math.min(extraRelative, col.width - minColumnWidthRelative);\r\n                                col.width -= delta;\r\n                                extraRelative -= delta;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            \r\n            // Try to fill width\r\n            if (o.autoFillTableWidth && sizeLeft > 0) {\r\n                let nonResizableTotal = 0;\r\n                let sizeLeftToFill = sizeLeft;\r\n                \r\n                for (let i = 0; i < p.visibleColumns.length; i++) {\r\n                    let col = p.visibleColumns[i];\r\n                    if (!col.resizable && col.widthMode === ColumnWidthMode.ABSOLUTE)\r\n                        nonResizableTotal += col.width;\r\n                    \r\n                    if (col.widthMode === ColumnWidthMode.RELATIVE)\r\n                        sizeLeftToFill -= Math.round(sizeLeftForRelative * col.width);\r\n                }\r\n                \r\n                let conv = ((detectedWidth - nonResizableTotal) / (detectedWidth - sizeLeftToFill - nonResizableTotal)) || NaN;\r\n                for (let i = 0; i < p.visibleColumns.length && sizeLeftToFill > 0; i++) {\r\n                    let col = p.visibleColumns[i];\r\n                    if (!col.resizable && col.widthMode === ColumnWidthMode.ABSOLUTE)\r\n                        continue;\r\n                    \r\n                    if (col.widthMode === ColumnWidthMode.RELATIVE) {\r\n                        col.width *= conv;\r\n                    } else {\r\n                        let width = col.actualWidth * conv;\r\n                        if (col.actualWidth !== width) {\r\n                            col.actualWidth = width;\r\n                            if (changedColumnIndexes.indexOf(i) === -1)\r\n                                changedColumnIndexes.push(i);\r\n                        }\r\n                    } \r\n                }\r\n            }\r\n            \r\n            // Materialize relative sizes\r\n            for (let i = 0; i < p.visibleColumns.length; i++) {\r\n                let col = p.visibleColumns[i];\r\n                if (col.widthMode === ColumnWidthMode.RELATIVE) {\r\n                    let width = Math.round(sizeLeftForRelative * col.width);\r\n                    sizeLeft -= width;\r\n                    relatives--;\r\n\r\n                    // Take care of rounding errors\r\n                    if (relatives === 0 && sizeLeft === 1) { // Take care of rounding errors\r\n                        width++;\r\n                        sizeLeft--;\r\n                    }\r\n                    if (sizeLeft === -1) {\r\n                        width--;\r\n                        sizeLeft++;\r\n                    }\r\n\r\n                    // Update actualWidth\r\n                    if (width !== col.actualWidth) {\r\n                        col.actualWidth = width;\r\n                        changedColumnIndexes.push(i);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (p.visibleColumns.length) {\r\n                // (There should always be at least 1 column visible, but just in case)\r\n                p.visibleColumns[p.visibleColumns.length - 1].actualWidthConsideringScrollbarWidth =\r\n                    p.visibleColumns[p.visibleColumns.length - 1].actualWidth - (p.scrollbarWidth || 0);\r\n            }\r\n\r\n            if (renderColumns) {\r\n                let tableWidth = this._calculateTbodyWidth();\r\n\r\n                if (tableWidthBeforeCalculations < tableWidth) {\r\n                    this._updateTableWidth(false);\r\n                }\r\n\r\n                for (let i = 0; i < changedColumnIndexes.length; i++) {\r\n                    this._resizeColumnElements(changedColumnIndexes[i]);\r\n                }\r\n\r\n                if (tableWidthBeforeCalculations > tableWidth) {\r\n                    this._updateTableWidth(false);\r\n                }\r\n            }\r\n        }\r\n\r\n        return this;\r\n    };\r\n})();\r\n\r\n/**\r\n * Notify the table that its height has changed\r\n * @public\r\n * @expose\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.tableHeightChanged = function () {\r\n    let that = this,\r\n        o = that.o,\r\n        p = that.p;\r\n\r\n    if (!p.$table) {\r\n        return that;\r\n    }\r\n\r\n    let height = CssUtil.innerHeight(that.$el)\r\n        - (parseFloat(p.$table.css('border-top-width')) || 0) // Subtract top border of inner element\r\n        - (parseFloat(p.$table.css('border-bottom-width')) || 0); // Subtract bottom border of inner element\r\n\r\n    if (height != o.height) {\r\n\r\n        o.height = height;\r\n\r\n        if (p.tbody) {\r\n            // At least 1 pixel - to show scrollers correctly.\r\n            p.tbody.style.height = Math.max(o.height - CssUtil.outerHeight(p.$headerRow), 1) + 'px';\r\n        }\r\n\r\n        if (o.virtualTable) {\r\n            that.clearAndRender();\r\n        }\r\n    }\r\n\r\n    return that;\r\n};\r\n\r\n/**\r\n * Add rows to the table\r\n * @public\r\n * @expose\r\n * @param {Object[]} data - array of rows to add to the table\r\n * @param {Number} [at=-1] - where to add the rows at\r\n * @param {Boolean} [resort=false] - should resort all rows?\r\n * @param {Boolean} [render=true]\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.addRows = function (data, at, resort, render) {\r\n    let that = this,\r\n        p = that.p;\r\n        \r\n    if (typeof at === 'boolean') {\r\n        render = resort;\r\n        resort = at;\r\n        at = -1;\r\n    }\r\n    \r\n    if (typeof at !== 'number')\r\n        at = -1;\r\n    \r\n    if (at < 0 || at > p.rows.length)\r\n        at = p.rows.length;\r\n    \r\n    render = (render === undefined) ? true : !!render;\r\n\r\n    if (data) {\r\n        p.rows.add(data, at);\r\n        \r\n        if (p.filteredRows || (resort && p.rows.sortColumn.length)) {\r\n            \r\n            if (resort && p.rows.sortColumn.length) {\r\n                this.resort();\r\n            } else {\r\n                this._refilter();\r\n            }\r\n            \r\n            p.tableSkeletonNeedsRendering = true;\r\n            \r\n            if (render) {\r\n                // Render the skeleton with all rows from scratch\r\n                this.render();\r\n            }\r\n            \r\n        } else if (render) {\r\n            let childNodes = p.tbody.childNodes;\r\n            \r\n            if (that.o.virtualTable) {\r\n                \r\n                while (p.tbody.firstChild) {\r\n                    this.trigger('rowdestroy', p.tbody.firstChild);\r\n                    this._unbindCellEventsForRow(p.tbody.firstChild);\r\n                    p.tbody.removeChild(p.tbody.firstChild);\r\n                }\r\n\r\n                this._calculateVirtualHeight() // Calculate virtual height\r\n                    ._updateLastCellWidthFromScrollbar() // Detect vertical scrollbar height\r\n                    .render()\r\n                    ._updateTableWidth(false); // Update table width to suit the required width considering vertical scrollbar\r\n                \r\n            } else if (p.$tbody) {\r\n                \r\n                let firstRow = at,\r\n                    lastRow = at + data.length - 1;\r\n                \r\n                let renderedRows = that.renderRows(firstRow, lastRow);\r\n                p.tbody.insertBefore(renderedRows, childNodes[at] || null);\r\n                \r\n                for (let i = lastRow + 1; i < childNodes.length; i++) {\r\n                    let row = childNodes[i];\r\n                    row['rowIndex'] += data.length;\r\n                    row['physicalRowIndex'] += data.length;\r\n                }\r\n                               \r\n                this.render()\r\n                    ._updateLastCellWidthFromScrollbar() // Detect vertical scrollbar height, and update existing last cells\r\n                    ._updateTableWidth(true); // Update table width to suit the required width considering vertical scrollbar\r\n\r\n            }\r\n        }\r\n\r\n        this.trigger('addrows', data.length, false);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Removes a row from the table\r\n * @public\r\n * @expose\r\n * @param {Number} physicalRowIndex - index\r\n * @param {Number} count - how many rows to remove\r\n * @param {Boolean=true} render\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.removeRows = function (physicalRowIndex, count, render) {\r\n    let that = this,\r\n        p = that.p;\r\n        \r\n    if (typeof count !== 'number' || count <= 0) return this;\r\n\r\n    if (physicalRowIndex < 0 || physicalRowIndex > p.rows.length - 1) return this;\r\n\r\n    p.rows.splice(physicalRowIndex, count);\r\n    render = (render === undefined) ? true : !!render;\r\n    \r\n    if (p.filteredRows) {\r\n        \r\n        this._refilter();\r\n        \r\n        p.tableSkeletonNeedsRendering = true;\r\n        \r\n        if (render) {\r\n            // Render the skeleton with all rows from scratch\r\n            this.render();\r\n        }\r\n        \r\n    } else if (render) {\r\n        \r\n        let childNodes = p.tbody.childNodes;\r\n        \r\n        if (this.o.virtualTable) {\r\n                \r\n            while (p.tbody.firstChild) {\r\n                this.trigger('rowdestroy', p.tbody.firstChild);\r\n                this._unbindCellEventsForRow(p.tbody.firstChild);\r\n                p.tbody.removeChild(p.tbody.firstChild);\r\n            }\r\n            \r\n            this._calculateVirtualHeight()\r\n                ._updateLastCellWidthFromScrollbar()\r\n                .render()\r\n                ._updateTableWidth(false); // Update table width to suit the required width considering vertical scrollbar\r\n                \r\n                \r\n        } else {\r\n            \r\n            let countRemoved = 0, lastRowIndex = physicalRowIndex + count - 1;\r\n            \r\n            for (let i = 0; i < childNodes.length; i++) {\r\n                let row = childNodes[i];\r\n                let index = row['physicalRowIndex'];\r\n                \r\n                if (index >= physicalRowIndex) {\r\n                    if (index <= lastRowIndex) {\r\n                        this.trigger('rowdestroy', row);\r\n                        this._unbindCellEventsForRow(row);\r\n                        p.tbody.removeChild(row);\r\n                        i--;\r\n                    } else {\r\n                        row['physicalRowIndex'] -= count;\r\n                    }\r\n                } else {\r\n                    row['rowIndex'] = i;\r\n                }\r\n            }\r\n                        \r\n            this.render()\r\n                ._updateLastCellWidthFromScrollbar()\r\n                ._updateTableWidth(true); // Update table width to suit the required width considering vertical scrollbar\r\n                \r\n        }\r\n    }\r\n    \r\n    return this;\r\n};\r\n\r\n/**\r\n * Removes a row from the table\r\n * @public\r\n * @expose\r\n * @param {Number} physicalRowIndex - index\r\n * @param {Boolean=true} render\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.removeRow = function (physicalRowIndex, render) {\r\n    return this.removeRows(physicalRowIndex, 1, render);\r\n};\r\n\r\n/**\r\n * Refreshes the row specified\r\n * @public\r\n * @expose\r\n * @param {Number} physicalRowIndex index\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.refreshRow = function(physicalRowIndex) {\r\n    let that = this,\r\n        p = that.p;\r\n\r\n    if (physicalRowIndex < 0 || physicalRowIndex > p.rows.length - 1) return this;\r\n\r\n    // Find out if the row is in the rendered dataset\r\n    let rowIndex = -1;\r\n    if (p.filteredRows && (rowIndex = p.filteredRows.indexOf(p.rows[physicalRowIndex])) === -1) return this;\r\n\r\n    if (rowIndex === -1) {\r\n        rowIndex = physicalRowIndex;\r\n    }\r\n\r\n    let childNodes = p.tbody.childNodes;\r\n\r\n    if (this.o.virtualTable) {\r\n        // Now make sure that the row actually rendered, as this is a virtual table\r\n        let isRowVisible = false;\r\n        let i = 0;\r\n        \r\n        for (; i < childNodes.length; i++) {\r\n            if (childNodes[i]['physicalRowIndex'] === physicalRowIndex) {\r\n                isRowVisible = true;\r\n                this.trigger('rowdestroy', childNodes[i]);\r\n                this._unbindCellEventsForRow(childNodes[i]);\r\n                p.tbody.removeChild(childNodes[i]);\r\n                break;\r\n            }\r\n        }\r\n        \r\n        if (isRowVisible) {\r\n            let renderedRow = this.renderRows(rowIndex, rowIndex);\r\n            p.tbody.insertBefore(renderedRow, childNodes[i] || null);\r\n        }\r\n    } else {\r\n        this.trigger('rowdestroy', childNodes[rowIndex]);\r\n        this._unbindCellEventsForRow(childNodes[rowIndex]);\r\n        p.tbody.removeChild(childNodes[rowIndex]);\r\n        let renderedRow = this.renderRows(rowIndex, rowIndex);\r\n        p.tbody.insertBefore(renderedRow, childNodes[rowIndex] || null);\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * Get the DOM element for the specified row, if it exists\r\n * @public\r\n * @expose\r\n * @param {Number} physicalRowIndex index\r\n * @returns {Element?} row or null\r\n */\r\nDGTable.prototype.getRowElement = function(physicalRowIndex) {\r\n    let that = this,\r\n        p = that.p;\r\n\r\n    if (physicalRowIndex < 0 || physicalRowIndex > p.rows.length - 1) return null;\r\n\r\n    // Find out if the row is in the rendered dataset\r\n    let rowIndex = -1;\r\n    if (p.filteredRows && (rowIndex = p.filteredRows.indexOf(p.rows[physicalRowIndex])) === -1) return this;\r\n\r\n    if (rowIndex === -1) {\r\n        rowIndex = physicalRowIndex;\r\n    }\r\n\r\n    let childNodes = p.tbody.childNodes;\r\n\r\n    if (this.o.virtualTable) {\r\n        // Now make sure that the row actually rendered, as this is a virtual table\r\n        for (let i = 0; i < childNodes.length; i++) {\r\n            if (childNodes[i]['physicalRowIndex'] === physicalRowIndex) {\r\n                return childNodes[i];\r\n            }\r\n        }\r\n    } else {\r\n        return childNodes[rowIndex];\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\n/**\r\n * Refreshes all virtual rows\r\n * @public\r\n * @expose\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.refreshAllVirtualRows = function () {\r\n\r\n    const p = this.p;\r\n\r\n    if (this.o.virtualTable) {\r\n        // Now make sure that the row actually rendered, as this is a virtual table\r\n        let rowsToRender = [];\r\n        let childNodes = p.tbody.childNodes;\r\n        \r\n        for (let i = 0, rowCount = childNodes.length; i < rowCount; i++) {\r\n            rowsToRender.push(childNodes[i]['physicalRowIndex']);\r\n            this.trigger('rowdestroy', childNodes[i]);\r\n            this._unbindCellEventsForRow(childNodes[i]);\r\n            p.tbody.removeChild(childNodes[i]);\r\n            i--;\r\n            rowCount--;\r\n        }\r\n        \r\n        for (let i = 0; i < rowsToRender.length; i++) {\r\n            let renderedRow = this.renderRows(rowsToRender[i], rowsToRender[i]);\r\n            p.tbody.appendChild(renderedRow);\r\n        }\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * Replace the whole dataset\r\n * @public\r\n * @expose\r\n * @param {Object[]} data array of rows to add to the table\r\n * @param {Boolean} [resort=false] should resort all rows?\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.setRows = function (data, resort) {\r\n    let that = this,\r\n        p = that.p;\r\n\r\n    // this.scrollTop = this.$el.find('.table').scrollTop();\r\n    p.rows.reset(data);\r\n\r\n    if (resort && p.rows.sortColumn.length) {\r\n        this.resort();\r\n    } else {\r\n        this._refilter();\r\n    }\r\n\r\n    this.clearAndRender().trigger('addrows', data.length, true);\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * Creates a URL representing the data in the specified element.\r\n * This uses the Blob or BlobBuilder of the modern browsers.\r\n * The url can be used for a Web Worker.\r\n * @public\r\n * @expose\r\n * @param {string} id Id of the element containing your data\r\n * @returns {String|null} the url, or null if not supported\r\n */\r\nDGTable.prototype.getUrlForElementContent = function (id) {\r\n    let blob,\r\n        el = document.getElementById(id);\r\n    if (el) {\r\n        let data = el.textContent;\r\n        if (typeof Blob === 'function') {\r\n            blob = new Blob([data]);\r\n        } else {\r\n            let BlobBuilder = global.BlobBuilder || global.WebKitBlobBuilder || global.MozBlobBuilder || global.MSBlobBuilder;\r\n            if (!BlobBuilder) {\r\n                return null;\r\n            }\r\n            let builder = new BlobBuilder();\r\n            builder.append(data);\r\n            blob = builder.getBlob();\r\n        }\r\n        return (global.URL || global.webkitURL).createObjectURL(blob);\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * @public\r\n * @expose\r\n * @returns {Boolean} A value indicating whether Web Workers are supported\r\n */\r\nDGTable.prototype.isWorkerSupported = function() {\r\n    return global['Worker'] instanceof Function;\r\n};\r\n\r\n/**\r\n * Creates a Web Worker for updating the table.\r\n * @public\r\n * @expose\r\n * @param {string} url Url to the script for the Web Worker\r\n * @param {Boolean=true} start if true, starts the Worker immediately\r\n * @returns {Worker?} the Web Worker, or null if not supported\r\n */\r\nDGTable.prototype.createWebWorker = function (url, start, resort) {\r\n    if (this.isWorkerSupported()) {\r\n        let that = this,\r\n            p = that.p;\r\n\r\n        let worker = new Worker(url);\r\n        let listener = function (evt) {\r\n            if (evt.data.append) {\r\n                that.addRows(evt.data.rows, resort);\r\n            } else {\r\n                that.setRows(evt.data.rows, resort);\r\n            }\r\n        };\r\n        worker.addEventListener('message', listener, false);\r\n        if (!p.workerListeners) {\r\n            p.workerListeners = [];\r\n        }\r\n        p.workerListeners.push({ worker: worker, listener: listener });\r\n        if (start || start === undefined) {\r\n            worker.postMessage(null);\r\n        }\r\n        return worker;\r\n    }\r\n    return null;\r\n};\r\n\r\n/**\r\n * Unbinds a Web Worker from the table, stopping updates.\r\n * @public\r\n * @expose\r\n * @param {Worker} worker the Web Worker\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.unbindWebWorker = function (worker) {\r\n    let that = this,\r\n        p = that.p;\r\n\r\n    if (p.workerListeners) {\r\n        for (let j = 0; j < p.workerListeners.length; j++) {\r\n            if (p.workerListeners[j].worker == worker) {\r\n                worker.removeEventListener('message', p.workerListeners[j].listener, false);\r\n                p.workerListeners.splice(j, 1);\r\n                j--;\r\n            }\r\n        }\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * A synonym for hideCellPreview()\r\n * @public\r\n * @expose\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.abortCellPreview = function() {\r\n    this.hideCellPreview();\r\n    return this;\r\n};\r\n\r\n/**\r\n * Cancel a resize in progress\r\n * @expose\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.cancelColumnResize = function() {\r\n    const p = this.p;\r\n\r\n    if (p.$resizer) {\r\n        p.$resizer.remove();\r\n        p.$resizer = null;\r\n        $(document).off('mousemove.dgtable', p.onMouseMoveResizeAreaBound)\r\n            .off('mouseup.dgtable', p.onEndDragColumnHeaderBound);\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * @param {jQuery_Event} event\r\n */\r\nDGTable.prototype._onVirtualTableScrolled = function (_event) {\r\n    this.render();\r\n};\r\n\r\n/**\r\n * @param {jQuery_Event} event\r\n */\r\nDGTable.prototype._onTableScrolledHorizontally = function (_event) {\r\n    const p = this.p;\r\n\r\n    p.header.scrollLeft = p.table.scrollLeft;\r\n};\r\n\r\n/**previousElementSibling\r\n * Reverse-calculate the column to resize from mouse position\r\n * @private\r\n * @param {jQuery_Event} e jQuery mouse event\r\n * @returns {String} name of the column which the mouse is over, or null if the mouse is not in resize position\r\n */\r\nDGTable.prototype._getColumnByResizePosition = function (e) {\r\n\r\n    let that = this,\r\n        o = that.o,\r\n        rtl = this._isTableRtl();\r\n\r\n    let $headerCell = $(e.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName),\r\n        headerCell = $headerCell[0];\r\n    if (headerCell['__cell']) {\r\n        headerCell = headerCell['__cell'];\r\n        $headerCell = $(headerCell);\r\n    }\r\n\r\n    let previousElementSibling = $headerCell[0].previousSibling;\r\n    while (previousElementSibling && previousElementSibling.nodeType != 1) {\r\n        previousElementSibling = previousElementSibling.previousSibling;\r\n    }\r\n\r\n    let firstCol = !previousElementSibling;\r\n\r\n    let mouseX = ((e.pageX != null ? e.pageX : e.originalEvent.pageX) || e.originalEvent.clientX) - $headerCell.offset().left;\r\n\r\n    if (rtl) {\r\n        if (!firstCol && CssUtil.outerWidth($headerCell) - mouseX <= o.resizeAreaWidth / 2) {\r\n            return previousElementSibling['columnName'];\r\n        } else if (mouseX <= o.resizeAreaWidth / 2) {\r\n            return headerCell['columnName'];\r\n        }\r\n    } else {\r\n        if (!firstCol && mouseX <= o.resizeAreaWidth / 2) {\r\n            return previousElementSibling['columnName'];\r\n        } else if (CssUtil.outerWidth($headerCell) - mouseX <= o.resizeAreaWidth / 2) {\r\n            return headerCell['columnName'];\r\n        }\r\n    }\r\n\r\n    return null;\r\n};\r\n\r\n/**\r\n * @param {jQuery_Event} event\r\n */\r\nDGTable.prototype._onTouchStartColumnHeader = function (event) {\r\n    const p = this.p;\r\n\r\n    if (p.currentTouchId) return;\r\n\r\n    let startTouch = event.originalEvent.changedTouches[0];\r\n    p.currentTouchId = startTouch.identifier;\r\n\r\n    let $eventTarget = $(event.currentTarget);\r\n\r\n    let startPos = { x: startTouch.pageX, y: startTouch.pageY },\r\n        currentPos = startPos,\r\n        distanceTreshold = 9;\r\n        \r\n    let tapAndHoldTimeout;\r\n\r\n    let unbind = function () {\r\n        p.currentTouchId = null;\r\n        $eventTarget.off('touchend').off('touchcancel');\r\n        clearTimeout(tapAndHoldTimeout);\r\n    };\r\n\r\n    let fakeEvent = function (name) {\r\n        let fakeEvent = $.Event(name);\r\n        let extendObjects = Array.prototype.slice.call(arguments, 1);\r\n        $.each(['target', 'clientX', 'clientY', 'offsetX', 'offsetY', 'screenX', 'screenY', 'pageX', 'pageY', 'which'],\r\n            function () {\r\n                fakeEvent[this] = event[this];\r\n                for (let i = 0; i < extendObjects.length; i++) {\r\n                    if (extendObjects[i][this] != null) {\r\n                        fakeEvent[this] = extendObjects[i][this];\r\n                    }\r\n                }\r\n            });\r\n        return fakeEvent;\r\n    };\r\n\r\n    $eventTarget.trigger(fakeEvent('mousedown', event.originalEvent.changedTouches[0], { 'which': 1 }));\r\n\r\n    tapAndHoldTimeout = setTimeout(() => {\r\n        unbind();\r\n\r\n        // Prevent simulated mouse events after touchend\r\n        $eventTarget\r\n            .one('touchend', (event) => {\r\n                event.preventDefault();\r\n                $eventTarget.off('touchend').off('touchcancel');\r\n            })\r\n            .one('touchcancel', (_event) => {\r\n                $eventTarget.off('touchend').off('touchcancel');\r\n            });\r\n\r\n        let distanceTravelled = Math.sqrt(Math.pow(Math.abs(currentPos.x - startPos.x), 2) + Math.pow(Math.abs(currentPos.y - startPos.y), 2));\r\n\r\n        if (distanceTravelled < distanceTreshold) {\r\n            this.cancelColumnResize();\r\n            $eventTarget.trigger(fakeEvent('mouseup', event.originalEvent.changedTouches[0], { 'which': 3 }));\r\n        }\r\n\r\n    }, 500);\r\n\r\n    $eventTarget\r\n        .on('touchend', (event) => {\r\n            let touch = find(event.originalEvent.changedTouches, (touch) => touch.identifier === p.currentTouchId);\r\n            if (!touch) return;\r\n\r\n            unbind();\r\n\r\n            event.preventDefault(); // Prevent simulated mouse events\r\n\r\n            currentPos = { x: touch.pageX, y: touch.pageY };\r\n            let distanceTravelled = Math.sqrt(Math.pow(Math.abs(currentPos.x - startPos.x), 2) + Math.pow(Math.abs(currentPos.y - startPos.y), 2));\r\n\r\n            if (distanceTravelled < distanceTreshold || p.$resizer) {\r\n                $eventTarget.trigger(fakeEvent('mouseup', touch, { 'which': 1 }));\r\n                $eventTarget.trigger(fakeEvent('click', touch, { 'which': 1 }));\r\n            }\r\n\r\n        })\r\n        .on('touchcancel', () => {\r\n            unbind();\r\n        })\r\n        .on('touchmove', (event) => {\r\n            let touch = find(event.originalEvent.changedTouches, (touch) => touch.identifier === p.currentTouchId);\r\n            if (!touch) return;\r\n\r\n            // Keep track of current position, so we know if we need to cancel the tap-and-hold\r\n            currentPos = { x: touch.pageX, y: touch.pageY };\r\n\r\n            if (p.$resizer) {\r\n                event.preventDefault();\r\n\r\n                $eventTarget.trigger(fakeEvent('mousemove', touch));\r\n            }\r\n        });\r\n};\r\n\r\n/**\r\n * @param {jQuery_Event} e event\r\n */\r\nDGTable.prototype._onMouseDownColumnHeader = function (event) {\r\n    if (event.which !== 1) return this; // Only treat left-clicks\r\n\r\n    let that = this,\r\n        o = that.o,\r\n        p = that.p,\r\n        col = this._getColumnByResizePosition(event);\r\n\r\n    if (col) {\r\n        let column = p.columns.get(col);\r\n        if (!o.resizableColumns || !column || !column.resizable) {\r\n            return false;\r\n        }\r\n\r\n        let rtl = this._isTableRtl();\r\n\r\n        if (p.$resizer) {\r\n            $(p.$resizer).remove();\r\n        }\r\n        p.$resizer = $('<div></div>')\r\n            .addClass(o.resizerClassName)\r\n            .css({\r\n                'position': 'absolute',\r\n                'display': 'block',\r\n                'z-index': -1,\r\n                'visibility': 'hidden',\r\n                'width': '2px',\r\n                'background': '#000',\r\n                'opacity': 0.7,\r\n            })\r\n            .appendTo(this.$el);\r\n\r\n        let selectedHeaderCell = column.element,\r\n            commonAncestor = p.$resizer.parent();\r\n\r\n        let posCol = selectedHeaderCell.offset(),\r\n            posRelative = commonAncestor.offset();\r\n        if (ieVersion === 8) {\r\n            posCol = selectedHeaderCell.offset(); // IE8 bug, first time it receives zeros...\r\n        }\r\n        posRelative.left += parseFloat(commonAncestor.css('border-left-width')) || 0;\r\n        posRelative.top += parseFloat(commonAncestor.css('border-top-width')) || 0;\r\n        posCol.left -= posRelative.left;\r\n        posCol.top -= posRelative.top;\r\n        posCol.top -= parseFloat(selectedHeaderCell.css('border-top-width')) || 0;\r\n        let resizerWidth = CssUtil.outerWidth(p.$resizer);\r\n        if (rtl) {\r\n            posCol.left -= Math.ceil((parseFloat(selectedHeaderCell.css('border-left-width')) || 0) / 2);\r\n            posCol.left -= Math.ceil(resizerWidth / 2);\r\n        } else {\r\n            posCol.left += CssUtil.outerWidth(selectedHeaderCell);\r\n            posCol.left += Math.ceil((parseFloat(selectedHeaderCell.css('border-right-width')) || 0) / 2);\r\n            posCol.left -= Math.ceil(resizerWidth / 2);\r\n        }\r\n\r\n        p.$resizer\r\n            .css({\r\n                'z-index': '10',\r\n                'visibility': 'visible',\r\n                'left': posCol.left,\r\n                'top': posCol.top,\r\n                'height': CssUtil.height(this.$el),\r\n            })[0]['columnName'] = selectedHeaderCell[0]['columnName'];\r\n            \r\n        try { p.$resizer[0].style.zIndex = ''; }\r\n        catch (ignored) { /* we're ok with this */ }\r\n\r\n        $(document).on('mousemove.dgtable', p.onMouseMoveResizeAreaBound);\r\n        $(document).on('mouseup.dgtable', p.onEndDragColumnHeaderBound);\r\n\r\n        event.preventDefault();\r\n    }\r\n};\r\n\r\n/**\r\n * @param {jQuery_Event} event event\r\n */\r\nDGTable.prototype._onMouseMoveColumnHeader = function (event) {\r\n\r\n    let that = this,\r\n        o = that.o,\r\n        p = that.p;\r\n\r\n    if (o.resizableColumns) {\r\n        let col = this._getColumnByResizePosition(event);\r\n        let headerCell = $(event.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName)[0];\r\n        if (!col || !p.columns.get(col).resizable) {\r\n            headerCell.style.cursor = '';\r\n        } else {\r\n            headerCell.style.cursor = 'e-resize';\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @param {jQuery_Event} event\r\n */\r\nDGTable.prototype._onMouseUpColumnHeader = function (event) {\r\n    if (event.which === 3) {\r\n        let o = this.o;\r\n        let $headerCell = $(event.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName);\r\n        let bounds = $headerCell.offset();\r\n        bounds['width'] = CssUtil.outerWidth($headerCell);\r\n        bounds['height'] = CssUtil.outerHeight($headerCell);\r\n        this.trigger('headercontextmenu', $headerCell[0]['columnName'], event.pageX, event.pageY, bounds);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {jQuery_Event} event event\r\n */\r\nDGTable.prototype._onMouseLeaveColumnHeader = function (event) {\r\n    let o = this.o;\r\n    let headerCell = $(event.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName)[0];\r\n    headerCell.style.cursor = '';\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {jQuery_Event} event event\r\n */\r\nDGTable.prototype._onClickColumnHeader = function (event) {\r\n    if (!this._getColumnByResizePosition(event)) {\r\n\r\n        let that = this,\r\n            o = that.o,\r\n            p = that.p;\r\n\r\n        let headerCell = $(event.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName)[0];\r\n        if (o.sortableColumns) {\r\n            let column = p.columns.get(headerCell['columnName']);\r\n            if (column && column.sortable) {\r\n                this.sort(headerCell['columnName'], undefined, true).render();\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {jQuery_Event} event event\r\n */\r\nDGTable.prototype._onStartDragColumnHeader = function (event) {\r\n\r\n    let that = this,\r\n        o = that.o,\r\n        p = that.p;\r\n\r\n    if (o.movableColumns) {\r\n\r\n        let $headerCell = $(event.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName);\r\n        let column = p.columns.get($headerCell[0]['columnName']);\r\n        if (column && column.movable) {\r\n            $headerCell[0].style.opacity = 0.35;\r\n            p.dragId = Math.random() * 0x9999999; // Recognize this ID on drop\r\n            event.originalEvent.dataTransfer.setData('text', JSON.stringify({ dragId: p.dragId, column: column.name }));\r\n        } else {\r\n            event.preventDefault();\r\n        }\r\n\r\n    } else {\r\n\r\n        event.preventDefault();\r\n\r\n    }\r\n\r\n    return undefined;\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {MouseEvent} event event\r\n */\r\nDGTable.prototype._onMouseMoveResizeArea = function (event) {\r\n\r\n    let that = this,\r\n        p = that.p;\r\n\r\n    let column = p.columns.get(p.$resizer[0]['columnName']);\r\n    let rtl = this._isTableRtl();\r\n\r\n    let selectedHeaderCell = column.element,\r\n        commonAncestor = p.$resizer.parent();\r\n    let posCol = selectedHeaderCell.offset(), posRelative = commonAncestor.offset();\r\n    posRelative.left += parseFloat(commonAncestor.css('border-left-width')) || 0;\r\n    posCol.left -= posRelative.left;\r\n    let resizerWidth = CssUtil.outerWidth(p.$resizer);\r\n    \r\n    let isBoxing = selectedHeaderCell.css('box-sizing') === 'border-box';\r\n    \r\n    let actualX = event.pageX - posRelative.left;\r\n    let minX = posCol.left;\r\n\r\n    minX -= Math.ceil(resizerWidth / 2);\r\n\r\n    if (rtl) {\r\n        minX += CssUtil.outerWidth(selectedHeaderCell);\r\n        minX -= column.ignoreMin ? 0 : this.o.minColumnWidth;\r\n\r\n        if (!isBoxing) {\r\n            minX -= Math.ceil((parseFloat(selectedHeaderCell.css('border-left-width')) || 0) / 2);\r\n            minX -= this._horizontalPadding(selectedHeaderCell[0]);\r\n        }\r\n\r\n        if (actualX > minX) {\r\n            actualX = minX;\r\n        }\r\n    } else {\r\n        minX += column.ignoreMin ? 0 : this.o.minColumnWidth;\r\n        \r\n        if (!isBoxing) {\r\n            minX += Math.ceil((parseFloat(selectedHeaderCell.css('border-right-width')) || 0) / 2);\r\n            minX += this._horizontalPadding(selectedHeaderCell[0]);\r\n        }\r\n\r\n        if (actualX < minX) {\r\n            actualX = minX;\r\n        }\r\n    }\r\n\r\n    p.$resizer.css('left', actualX + 'px');\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {Event} event event\r\n */\r\nDGTable.prototype._onEndDragColumnHeader = function (event) {\r\n\r\n    let that = this,\r\n        o = that.o,\r\n        p = that.p;\r\n\r\n    if (!p.$resizer) {\r\n        event.target.style.opacity = null;\r\n    } else {\r\n        $(document).off('mousemove.dgtable', p.onMouseMoveResizeAreaBound)\r\n            .off('mouseup.dgtable', p.onEndDragColumnHeaderBound);\r\n\r\n        let column = p.columns.get(p.$resizer[0]['columnName']);\r\n        let rtl = this._isTableRtl();\r\n\r\n        let selectedHeaderCell = column.element,\r\n            commonAncestor = p.$resizer.parent();\r\n        let posCol = selectedHeaderCell.offset(), posRelative = commonAncestor.offset();\r\n        posRelative.left += parseFloat(commonAncestor.css('border-left-width')) || 0;\r\n        posCol.left -= posRelative.left;\r\n        let resizerWidth = CssUtil.outerWidth(p.$resizer);\r\n        \r\n        let isBoxing = selectedHeaderCell.css('box-sizing') === 'border-box';\r\n\r\n        let actualX = event.pageX - posRelative.left;\r\n        let baseX = posCol.left, minX = posCol.left;\r\n        let width = 0;\r\n\r\n        baseX -= Math.ceil(resizerWidth / 2);\r\n\r\n        if (rtl) {\r\n\r\n            if (!isBoxing) {\r\n                actualX += this._horizontalPadding(selectedHeaderCell[0]);\r\n                actualX += parseFloat(selectedHeaderCell.css('border-left-width')) || 0;\r\n                actualX += parseFloat(selectedHeaderCell.css('border-right-width')) || 0;\r\n            }\r\n\r\n            baseX += CssUtil.outerWidth(selectedHeaderCell);\r\n            \r\n            minX = baseX - (column.ignoreMin ? 0 : this.o.minColumnWidth);\r\n            if (actualX > minX) {\r\n                actualX = minX;\r\n            }\r\n\r\n            width = baseX - actualX;\r\n        } else {\r\n\r\n            if (!isBoxing) {\r\n                actualX -= this._horizontalPadding(selectedHeaderCell[0]);\r\n                actualX -= parseFloat(selectedHeaderCell.css('border-left-width')) || 0;\r\n                actualX -= parseFloat(selectedHeaderCell.css('border-right-width')) || 0;\r\n            }\r\n\r\n            minX = baseX + (column.ignoreMin ? 0 : this.o.minColumnWidth);\r\n            if (actualX < minX) {\r\n                actualX = minX;\r\n            }\r\n\r\n            width = actualX - baseX;\r\n        }\r\n        \r\n        p.$resizer.remove();\r\n        p.$resizer = null;\r\n\r\n        let sizeToSet = width;\r\n\r\n        if (column.widthMode === ColumnWidthMode.RELATIVE) {\r\n            let detectedWidth = this._calculateWidthAvailableForColumns();\r\n\r\n            let sizeLeft = detectedWidth;\r\n            //sizeLeft -= p.table.offsetWidth - p.table.clientWidth;\r\n\r\n            let totalRelativePercentage = 0;\r\n            let relatives = 0;\r\n\r\n            for (let i = 0; i < p.visibleColumns.length; i++) {\r\n                let col = p.visibleColumns[i];\r\n                if (col.name === column.name) continue;\r\n\r\n                if (col.widthMode == ColumnWidthMode.RELATIVE) {\r\n                    totalRelativePercentage += col.width;\r\n                    relatives++;\r\n                } else {\r\n                    sizeLeft -= col.actualWidth;\r\n                }\r\n            }\r\n\r\n            sizeLeft = Math.max(1, sizeLeft);\r\n            sizeToSet = width / sizeLeft;\r\n\r\n            if (relatives > 0) {\r\n                // When there's more than one relative overall,\r\n                //   we can do relative enlarging/shrinking.\r\n                // Otherwise, we can end up having a 0 width.\r\n\r\n                let unNormalizedSizeToSet = sizeToSet / ((1 - sizeToSet) / totalRelativePercentage);\r\n\r\n                totalRelativePercentage += sizeToSet;\r\n\r\n                // Account for relative widths scaling later\r\n                if ((totalRelativePercentage < 1 && o.relativeWidthGrowsToFillWidth) ||\r\n                    (totalRelativePercentage > 1 && o.relativeWidthShrinksToFillWidth)) {\r\n                    sizeToSet = unNormalizedSizeToSet;\r\n                }\r\n            }\r\n            \r\n            sizeToSet *= 100;\r\n            sizeToSet += '%';\r\n        }\r\n\r\n        this.setColumnWidth(column.name, sizeToSet);\r\n    }\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {jQuery_Event} event event\r\n */\r\nDGTable.prototype._onDragEnterColumnHeader = function (event) {\r\n    let that = this,\r\n        o = that.o,\r\n        p = that.p;\r\n\r\n    if (o.movableColumns) {\r\n        let dataTransferred = event.originalEvent.dataTransfer.getData('text');\r\n        if (dataTransferred) {\r\n            dataTransferred = JSON.parse(dataTransferred);\r\n        }\r\n        else {\r\n            dataTransferred = null; // WebKit does not provide the dataTransfer on dragenter?..\r\n        }\r\n\r\n        let $headerCell = $(event.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName);\r\n        if (!dataTransferred ||\r\n            (p.dragId == dataTransferred.dragId && $headerCell['columnName'] !== dataTransferred.column)) {\r\n\r\n            let column = p.columns.get($headerCell[0]['columnName']);\r\n            if (column && (column.movable || column != p.visibleColumns[0])) {\r\n                $($headerCell).addClass('drag-over');\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {jQuery_Event} event event\r\n */\r\nDGTable.prototype._onDragOverColumnHeader = function (event) {\r\n    event.preventDefault();\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {jQuery_Event} event event\r\n */\r\nDGTable.prototype._onDragLeaveColumnHeader = function (event) {\r\n    let o = this.o;\r\n    let $headerCell = $(event.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName);\r\n    if ( !$($headerCell[0].firstChild)\r\n            .has(event.originalEvent.relatedTarget).length ) {\r\n        $headerCell.removeClass('drag-over');\r\n    }\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {jQuery_Event} event event\r\n */\r\nDGTable.prototype._onDropColumnHeader = function (event) {\r\n    event.preventDefault();\r\n\r\n    let that = this,\r\n        o = that.o,\r\n        p = that.p;\r\n\r\n    let dataTransferred = JSON.parse(event.originalEvent.dataTransfer.getData('text'));\r\n    let $headerCell = $(event.target).closest('div.' + o.tableClassName + '-header-cell,div.' + o.cellPreviewClassName);\r\n    if (o.movableColumns && dataTransferred.dragId == p.dragId) {\r\n        let srcColName = dataTransferred.column,\r\n            destColName = $headerCell[0]['columnName'],\r\n            srcCol = p.columns.get(srcColName),\r\n            destCol = p.columns.get(destColName);\r\n        if (srcCol && destCol && srcCol.movable && (destCol.movable || destCol != p.visibleColumns[0])) {\r\n            this.moveColumn(srcColName, destColName);\r\n        }\r\n    }\r\n    $($headerCell).removeClass('drag-over');\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._clearSortArrows = function () {\r\n\r\n    let that = this,\r\n        p = that.p;\r\n\r\n    if (p.$table) {\r\n        let tableClassName = this.o.tableClassName;\r\n        let sortedColumns = p.$headerRow.find('>div.' + tableClassName + '-header-cell.sorted');\r\n        let arrows = sortedColumns.find('>div>.sort-arrow');\r\n        for (let arrow of arrows) {\r\n            let col = p.columns.get(arrow.parentNode.parentNode['columnName']);\r\n            if (col) {\r\n                col.arrowProposedWidth = 0;\r\n            }\r\n        }\r\n        arrows.remove();\r\n        sortedColumns.removeClass('sorted').removeClass('desc');\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {String} column the name of the sort column\r\n * @param {Boolean} descending table is sorted descending\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._showSortArrow = function (column, descending) {\r\n\r\n    let that = this,\r\n        p = that.p;\r\n\r\n    let col = p.columns.get(column);\r\n    if (!col) return false;\r\n    \r\n    let arrow = createElement('span');\r\n    arrow.className = 'sort-arrow';\r\n\r\n    if (col.element) {\r\n        col.element.addClass(descending ? 'sorted desc' : 'sorted');\r\n        col.element[0].firstChild.insertBefore(arrow, col.element[0].firstChild.firstChild);\r\n    }\r\n\r\n    if (col.widthMode != ColumnWidthMode.RELATIVE && this.o.adjustColumnWidthForSortArrow) {\r\n        col.arrowProposedWidth = arrow.scrollWidth + (parseFloat($(arrow).css('margin-right')) || 0) + (parseFloat($(arrow).css('margin-left')) || 0);\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {Number} cellIndex index of the column in the DOM\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._resizeColumnElements = function (cellIndex) {\r\n\r\n    let that = this,\r\n        p = that.p;\r\n\r\n    let headerCells = p.$headerRow.find('div.' + this.o.tableClassName + '-header-cell');\r\n    let col = p.columns.get(headerCells[cellIndex]['columnName']);\r\n\r\n    if (col) {\r\n        headerCells[cellIndex].style.width = (col.actualWidthConsideringScrollbarWidth || col.actualWidth) + 'px';\r\n\r\n        let width = (col.actualWidthConsideringScrollbarWidth || col.actualWidth) + 'px';\r\n        let tbodyChildren = p.$tbody[0].childNodes;\r\n        for (let i = 0, count = tbodyChildren.length; i < count; i++) {\r\n            let headerRow = tbodyChildren[i];\r\n            if (headerRow.nodeType !== 1) continue;\r\n            headerRow.childNodes[cellIndex].style.width = width;\r\n        }\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * @returns {DGTable} self\r\n * */\r\nDGTable.prototype._destroyHeaderCells = function() {\r\n\r\n    let that = this,\r\n        o = that.o,\r\n        p = that.p;\r\n\r\n    if (p.$headerRow) {\r\n        this.trigger('headerrowdestroy', p.headerRow);\r\n        p.$headerRow.find('div.' + o.tableClassName + '-header-cell').remove();\r\n        p.$headerRow = null;\r\n        p.headerRow = null;\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._renderSkeletonBase = function () {\r\n    let that = this,\r\n        p = that.p,\r\n        o = that.o;\r\n    \r\n    // Clean up old elements\r\n    \r\n    if (p.$table && o.virtualTable) {\r\n        p.$table.remove();\r\n        if (p.$tbody) {\r\n            let rows = p.$tbody[0].childNodes;\r\n            for (let i = 0, len = rows.length; i < len; i++) {\r\n                that.trigger('rowdestroy', rows[i]);\r\n                that._unbindCellEventsForRow(rows[i]);\r\n            }\r\n        }\r\n        p.$table = p.table = p.$tbody = p.tbody = null;\r\n    }\r\n    \r\n    that._destroyHeaderCells();\r\n    p.currentTouchId = null;\r\n    if (p.$header) {\r\n        p.$header.remove();\r\n    }    \r\n\r\n    // Create new base elements\r\n    let tableClassName = o.tableClassName,\r\n        headerCellClassName = tableClassName + '-header-cell',\r\n        header = createElement('div'),\r\n        $header = $(header),\r\n        headerRow = createElement('div'),\r\n        $headerRow = $(headerRow);\r\n\r\n    header.className = tableClassName + '-header';\r\n    headerRow.className = tableClassName + '-header-row';\r\n    \r\n    p.$header = $header;\r\n    p.header = header;\r\n    p.$headerRow = $headerRow;\r\n    p.headerRow = headerRow;\r\n    $headerRow.appendTo(p.$header);\r\n    $header.prependTo(this.$el);\r\n    \r\n    relativizeElement(that.$el);\r\n    \r\n    if (o.width == DGTable.Width.SCROLL) {\r\n        this.el.style.overflow = 'hidden';\r\n    } else {\r\n        this.el.style.overflow = '';\r\n    }\r\n    \r\n    if (!o.height && o.virtualTable) {\r\n        o.height = CssUtil.innerHeight(this.$el);\r\n    }\r\n    \r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._renderSkeletonHeaderCells = function () {\r\n    let that = this,\r\n        p = that.p,\r\n        o = that.o;\r\n        \r\n    let allowCellPreview = o.allowCellPreview,\r\n        allowHeaderCellPreview = o.allowHeaderCellPreview;\r\n\r\n    let tableClassName = o.tableClassName,\r\n        headerCellClassName = tableClassName + '-header-cell',\r\n        header = p.header,\r\n        $header = p.$header,\r\n        headerRow = p.headerRow,\r\n        $headerRow = p.$headerRow;\r\n\r\n    let ieDragDropHandler;\r\n    if (hasIeDragAndDropBug) {\r\n        ieDragDropHandler = function(evt) {\r\n            evt.preventDefault();\r\n            this.dragDrop();\r\n            return false;\r\n        };\r\n    }\r\n\r\n    let preventDefault = function (event) { event.preventDefault(); };\r\n\r\n    // Create header cells\r\n    for (let i = 0; i < p.visibleColumns.length; i++) {\r\n        let column = p.visibleColumns[i];\r\n        if (column.visible) {\r\n            let cell = createElement('div');\r\n            let $cell = $(cell);\r\n            cell.draggable = true;\r\n            cell.className = headerCellClassName;\r\n            cell.style.width = column.actualWidth + 'px';\r\n            if (o.sortableColumns && column.sortable) {\r\n                cell.className += ' sortable';\r\n            }\r\n            cell['columnName'] = column.name;\r\n            cell.setAttribute('data-column', column.name);\r\n            \r\n            let cellInside = createElement('div');\r\n            cellInside.innerHTML = o.headerCellFormatter(column.label, column.name);\r\n            cell.appendChild(cellInside);\r\n            if (allowCellPreview && allowHeaderCellPreview) {\r\n                p._bindCellHoverIn(cell);\r\n            }\r\n            headerRow.appendChild(cell);\r\n\r\n            p.visibleColumns[i].element = $cell;\r\n\r\n            $cell.on('mousedown.dgtable', that._onMouseDownColumnHeader.bind(that))\r\n                .on('mousemove.dgtable', that._onMouseMoveColumnHeader.bind(that))\r\n                .on('mouseup.dgtable', that._onMouseUpColumnHeader.bind(that))\r\n                .on('mouseleave.dgtable', that._onMouseLeaveColumnHeader.bind(that))\r\n                .on('touchstart.dgtable', that._onTouchStartColumnHeader.bind(that))\r\n                .on('dragstart.dgtable', that._onStartDragColumnHeader.bind(that))\r\n                .on('click.dgtable', that._onClickColumnHeader.bind(that))\r\n                .on('contextmenu.dgtable', preventDefault);\r\n            $(cellInside)\r\n                .on('dragenter.dgtable', that._onDragEnterColumnHeader.bind(that))\r\n                .on('dragover.dgtable', that._onDragOverColumnHeader.bind(that))\r\n                .on('dragleave.dgtable', that._onDragLeaveColumnHeader.bind(that))\r\n                .on('drop.dgtable', that._onDropColumnHeader.bind(that));\r\n\r\n            if (hasIeDragAndDropBug) {\r\n                $cell.on('selectstart.dgtable', ieDragDropHandler.bind(cell));\r\n            }\r\n\r\n            // Disable these to allow our own context menu events without interruption\r\n            $cell.css({ '-webkit-touch-callout': 'none', '-webkit-user-select': 'none', '-moz-user-select': 'none', '-ms-user-select': 'none', '-o-user-select': 'none', 'user-select': 'none' });\r\n        }\r\n    }\r\n\r\n    this.trigger('headerrowcreate', headerRow);\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._renderSkeletonBody = function () {\r\n    let that = this,\r\n        p = that.p,\r\n        o = that.o;\r\n\r\n    let tableClassName = o.tableClassName;\r\n        \r\n    // Calculate virtual row heights\r\n    if (o.virtualTable && !p.virtualRowHeight) {\r\n        let createDummyRow = function() {\r\n            let row = createElement('div'),\r\n                cell = row.appendChild(createElement('div')),\r\n                cellInner = cell.appendChild(createElement('div'));\r\n            row.className = tableClassName + '-row';\r\n            cell.className = tableClassName + '-cell';\r\n            cellInner.innerHTML = '0';\r\n            row.style.visibility = 'hidden';\r\n            row.style.position = 'absolute';\r\n            return row;\r\n        };\r\n\r\n        let $dummyTbody, $dummyWrapper = $('<div>')\r\n            .addClass(that.el.className)\r\n            .css({ 'z-index': -1, 'position': 'absolute', left: '0', top: '-9999px', width: '1px', overflow: 'hidden' })\r\n            .append(\r\n                $('<div>').addClass(tableClassName).append(\r\n                    $dummyTbody = $('<div>').addClass(tableClassName + '-body').css('width', 99999),\r\n                ),\r\n            );\r\n\r\n        $dummyWrapper.appendTo(document.body);\r\n\r\n        let row1 = createDummyRow(), row2 = createDummyRow(), row3 = createDummyRow();\r\n        $dummyTbody.append(row1, row2, row3);\r\n\r\n        p.virtualRowHeightFirst = CssUtil.outerHeight(row1);\r\n        p.virtualRowHeight = CssUtil.outerHeight(row2);\r\n        p.virtualRowHeightLast = CssUtil.outerHeight(row3);\r\n\r\n        p.virtualRowHeightMin = Math.min(Math.min(p.virtualRowHeightFirst, p.virtualRowHeight), p.virtualRowHeightLast);\r\n        p.virtualRowHeightMax = Math.max(Math.max(p.virtualRowHeightFirst, p.virtualRowHeight), p.virtualRowHeightLast);\r\n\r\n        $dummyWrapper.remove();\r\n    }\r\n\r\n    // Create inner table and tbody\r\n    if (!p.$table) {\r\n\r\n        let fragment = document.createDocumentFragment();\r\n        \r\n        // Create the inner table element\r\n        let table = createElement('div');\r\n        let $table = $(table);\r\n        table.className = tableClassName;\r\n\r\n        if (o.virtualTable) {\r\n            table.className += ' virtual';\r\n        }\r\n\r\n        let tableHeight = (o.height - CssUtil.outerHeight(p.$headerRow));\r\n        if ($table.css('box-sizing') !== 'border-box') {\r\n            tableHeight -= parseFloat($table.css('border-top-width')) || 0;\r\n            tableHeight -= parseFloat($table.css('border-bottom-width')) || 0;\r\n            tableHeight -= parseFloat($table.css('padding-top')) || 0;\r\n            tableHeight -= parseFloat($table.css('padding-bottom')) || 0;\r\n        }\r\n        p.visibleHeight = tableHeight;\r\n        table.style.height = o.height ? tableHeight + 'px' : 'auto';\r\n        table.style.display = 'block';\r\n        table.style.overflowY = 'auto';\r\n        table.style.overflowX = o.width == DGTable.Width.SCROLL ? 'auto' : 'hidden';\r\n        fragment.appendChild(table);\r\n\r\n        // Create the \"tbody\" element\r\n        let tbody = createElement('div');\r\n        let $tbody = $(tbody);\r\n        tbody.className = o.tableClassName + '-body';\r\n        p.table = table;\r\n        p.tbody = tbody;\r\n        p.$table = $table;\r\n        p.$tbody = $tbody;\r\n\r\n        if (o.virtualTable) {\r\n            p.virtualVisibleRows = Math.ceil(p.visibleHeight / p.virtualRowHeightMin);\r\n        }\r\n\r\n        that._calculateVirtualHeight();\r\n\r\n        relativizeElement($tbody);\r\n        relativizeElement($table);\r\n\r\n        table.appendChild(tbody);\r\n        that.el.appendChild(fragment);\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {DGTable} self\r\n * @deprecated\r\n */\r\nDGTable.prototype._renderSkeleton = function () {\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._updateLastCellWidthFromScrollbar = function(force) {\r\n\r\n    const p = this.p;\r\n\r\n    // Calculate scrollbar's width and reduce from lat column's width\r\n    let scrollbarWidth = p.table.offsetWidth - p.table.clientWidth;\r\n    if (scrollbarWidth != p.scrollbarWidth || force) {\r\n        p.scrollbarWidth = scrollbarWidth;\r\n        for (let i = 0; i < p.columns.length; i++) {\r\n            p.columns[i].actualWidthConsideringScrollbarWidth = null;\r\n        }\r\n\r\n        if (p.scrollbarWidth > 0 && p.visibleColumns.length > 0) {\r\n            // (There should always be at least 1 column visible, but just in case)\r\n            let lastColIndex = p.visibleColumns.length - 1;\r\n\r\n            p.visibleColumns[lastColIndex].actualWidthConsideringScrollbarWidth = p.visibleColumns[lastColIndex].actualWidth - p.scrollbarWidth;\r\n            let lastColWidth = p.visibleColumns[lastColIndex].actualWidthConsideringScrollbarWidth + 'px';\r\n            let tbodyChildren = p.tbody.childNodes;\r\n            for (let i = 0, count = tbodyChildren.length; i < count; i++) {\r\n                let row = tbodyChildren[i];\r\n                if (row.nodeType !== 1) continue;\r\n                row.childNodes[lastColIndex].style.width = lastColWidth;\r\n            }\r\n\r\n            p.headerRow.childNodes[lastColIndex].style.width = lastColWidth;\r\n        }\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * Explicitly set the width of the table based on the sum of the column widths\r\n * @private\r\n * @param {boolean} parentSizeMayHaveChanged Parent size may have changed, treat rendering accordingly\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype._updateTableWidth = function (parentSizeMayHaveChanged) {\r\n    const o = this.o, p = this.p;\r\n    let width = this._calculateTbodyWidth();\r\n\r\n    p.tbody.style.minWidth = width + 'px';\r\n    p.headerRow.style.minWidth = (width + (p.scrollbarWidth || 0)) + 'px';\r\n\r\n    p.$table.off('scroll', p.onTableScrolledHorizontallyBound);\r\n\r\n    if (o.width == DGTable.Width.AUTO) {\r\n        // Update wrapper element's size to fully contain the table body\r\n\r\n        CssUtil.width(p.$table, CssUtil.outerWidth(p.$tbody));\r\n        CssUtil.width(this.$el, CssUtil.outerWidth(p.$table));\r\n\r\n    } else if (o.width == DGTable.Width.SCROLL) {\r\n\r\n        if (parentSizeMayHaveChanged) {\r\n            let lastScrollTop = p.table ? p.table.scrollTop : 0,\r\n                lastScrollLeft = p.table ? p.table.scrollLeft : 0;\r\n\r\n            // BUGFIX: Relayout before recording the widths\r\n            webkitRenderBugfix(this.el);\r\n\r\n            p.table.scrollTop = lastScrollTop;\r\n            p.table.scrollLeft = lastScrollLeft;\r\n            p.header.scrollLeft = lastScrollLeft;\r\n        }\r\n\r\n        p.$table.on('scroll', p.onTableScrolledHorizontallyBound);\r\n    }\r\n\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n * @returns {Boolean}\r\n */\r\nDGTable.prototype._isTableRtl = function() {\r\n    return this.p.$table.css('direction') === 'rtl';\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {Object} column column object\r\n * @returns {String}\r\n */\r\nDGTable.prototype._serializeColumnWidth = function(column) {\r\n    return column.widthMode === ColumnWidthMode.AUTO ? 'auto' :\r\n        column.widthMode === ColumnWidthMode.RELATIVE ? column.width * 100 + '%' :\r\n            column.width;\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {HTMLElement} el\r\n */\r\nDGTable.prototype._cellMouseOverEvent = function(el) {\r\n    const o = this.o, p = this.p;\r\n\r\n    let elInner = el.firstChild;\r\n\r\n    if ((elInner.scrollWidth - elInner.clientWidth > 1) ||\r\n        (elInner.scrollHeight - elInner.clientHeight > 1)) {\r\n\r\n        this.hideCellPreview();\r\n        p.abortCellPreview = false;\r\n\r\n        let $el = $(el), $elInner = $(elInner);\r\n        let previewCell = createElement('div'), $previewCell = $(previewCell);\r\n        previewCell.innerHTML = el.innerHTML;\r\n        previewCell.className = o.cellPreviewClassName;\r\n\r\n        let isHeaderCell = $el.hasClass(o.tableClassName + '-header-cell');\r\n        if (isHeaderCell) {\r\n            previewCell.className += ' header';\r\n            if ($el.hasClass('sortable')) {\r\n                previewCell.className += ' sortable';\r\n            }\r\n\r\n            previewCell.draggable = true;\r\n\r\n            $(previewCell).on('mousedown', this._onMouseDownColumnHeader.bind(this))\r\n                .on('mousemove', this._onMouseMoveColumnHeader.bind(this))\r\n                .on('mouseup', this._onMouseUpColumnHeader.bind(this))\r\n                .on('mouseleave', this._onMouseLeaveColumnHeader.bind(this))\r\n                .on('touchstart', this._onTouchStartColumnHeader.bind(this))\r\n                .on('dragstart', this._onStartDragColumnHeader.bind(this))\r\n                .on('click', this._onClickColumnHeader.bind(this))\r\n                .on('contextmenu.dgtable', function (event) { event.preventDefault(); });\r\n            $(previewCell.firstChild)\r\n                .on('dragenter', this._onDragEnterColumnHeader.bind(this))\r\n                .on('dragover', this._onDragOverColumnHeader.bind(this))\r\n                .on('dragleave', this._onDragLeaveColumnHeader.bind(this))\r\n                .on('drop', this._onDropColumnHeader.bind(this));\r\n\r\n            if (hasIeDragAndDropBug) {\r\n                $(previewCell).on('selectstart', (function(evt) {\r\n                    evt.preventDefault();\r\n                    this.dragDrop();\r\n                    return false;\r\n                }).bind(previewCell));\r\n            }\r\n        }\r\n\r\n        let paddingL = parseFloat($el.css('padding-left')) || 0,\r\n            paddingR = parseFloat($el.css('padding-right')) || 0,\r\n            paddingT = parseFloat($el.css('padding-top')) || 0,\r\n            paddingB = parseFloat($el.css('padding-bottom')) || 0;\r\n\r\n        let requiredWidth = elInner.scrollWidth + (el.clientWidth - elInner.offsetWidth);\r\n\r\n        let borderBox = $el.css('box-sizing') === 'border-box';\r\n        if (borderBox) {\r\n            $previewCell.css('box-sizing', 'border-box');\r\n        } else {\r\n            requiredWidth -= paddingL + paddingR;\r\n            $previewCell.css('margin-top', parseFloat($(el).css('border-top-width')) || 0);\r\n        }\r\n\r\n        if (!p.transparentBgColor1) {\r\n            // Detect browser's transparent spec\r\n            let tempDiv = document.createElement('div');\r\n            tempDiv.style.backgroundColor = 'transparent';\r\n            p.transparentBgColor1 = $(tempDiv).css('background-color');\r\n            tempDiv.style.backgroundColor = 'rgba(0,0,0,0)';\r\n            p.transparentBgColor2 = $(tempDiv).css('background-color');\r\n        }\r\n\r\n        let css = {\r\n            'box-sizing': borderBox ? 'border-box' : 'content-box',\r\n            'width': requiredWidth,\r\n            'min-height': CssUtil.height($el),\r\n            'padding-left': paddingL,\r\n            'padding-right': paddingR,\r\n            'padding-top': paddingT,\r\n            'padding-bottom': paddingB,\r\n            'overflow': 'hidden',\r\n            'position': 'absolute',\r\n            'z-index': '-1',\r\n            'left': '0',\r\n            'top': '0',\r\n            'cursor': 'default',\r\n        };\r\n\r\n        if (css) {\r\n            let bgColor = $(el).css('background-color');\r\n            if (bgColor === p.transparentBgColor1 || bgColor === p.transparentBgColor2) {\r\n                bgColor = $(el.parentNode).css('background-color');\r\n            }\r\n            if (bgColor === p.transparentBgColor1 || bgColor === p.transparentBgColor2) {\r\n                bgColor = '#fff';\r\n            }\r\n            css['background-color'] = bgColor;\r\n        }\r\n\r\n        $previewCell.css(css);\r\n\r\n        this.el.appendChild(previewCell);\r\n\r\n        $(previewCell.firstChild).css({\r\n            'direction': $elInner.css('direction'),\r\n            'white-space': $elInner.css('white-space'),\r\n        });\r\n\r\n        if (isHeaderCell) {\r\n            // Disable these to allow our own context menu events without interruption\r\n            $previewCell.css({\r\n                '-webkit-touch-callout': 'none',\r\n                '-webkit-user-select': 'none',\r\n                '-moz-user-select': 'none',\r\n                '-ms-user-select': 'none',\r\n                '-o-user-select': 'none',\r\n                'user-select': 'none',\r\n            });\r\n        }\r\n\r\n        previewCell['rowIndex'] = el.parentNode['rowIndex'];\r\n        let physicalRowIndex = previewCell['physicalRowIndex'] = el.parentNode['physicalRowIndex'];\r\n        previewCell['columnName'] = p.visibleColumns[nativeIndexOf.call(el.parentNode.childNodes, el)].name;\r\n\r\n        try {\r\n            let selection = SelectionHelper.saveSelection(el);\r\n            if (selection)\r\n                SelectionHelper.restoreSelection(previewCell, selection);\r\n        } catch (ignored) { /* we're ok with this */ }\r\n        \r\n        this.trigger(\r\n            'cellpreview',\r\n            previewCell.firstChild,\r\n            physicalRowIndex == null ? null : physicalRowIndex,\r\n            previewCell['columnName'],\r\n            physicalRowIndex == null ? null : p.rows[physicalRowIndex],\r\n            el,\r\n        );\r\n\r\n        if (p.abortCellPreview) {\r\n            $previewCell.remove();\r\n            return;\r\n        }\r\n\r\n        let $parent = this.$el;\r\n        let $scrollParent = $parent[0] === window ? $(document) : $parent;\r\n\r\n        let offset = $el.offset();\r\n        let parentOffset = $parent.offset();\r\n        let rtl = $el.css('float') === 'right';\r\n        let prop = rtl ? 'right' : 'left';\r\n\r\n        // Handle RTL, go from the other side\r\n        if (rtl) {\r\n            let windowWidth = $(window).width();\r\n            offset.right = windowWidth - (offset.left + CssUtil.outerWidth($el));\r\n            parentOffset.right = windowWidth - (parentOffset.left + CssUtil.outerWidth($parent));\r\n        }\r\n\r\n        // If the parent has borders, then it would offset the offset...\r\n        offset.left -= parseFloat($parent.css('border-left-width')) || 0;\r\n        offset.right -= parseFloat($parent.css('border-right-width')) || 0;\r\n        offset.top -= parseFloat($parent.css('border-top-width')) || 0;\r\n\r\n        // Handle border widths of the element being offset\r\n        offset[prop] += parseFloat($(el).css('border-' + prop + '-width')) || 0;\r\n        offset.top += parseFloat($(el).css('border-top-width')) || parseFloat($(el).css('border-bottom-width')) || 0;\r\n\r\n        // Subtract offsets to get offset relative to parent\r\n        offset.left -= parentOffset.left;\r\n        offset.right -= parentOffset.right;\r\n        offset.top -= parentOffset.top;\r\n\r\n        // Constrain horizontally\r\n        let minHorz = 0,\r\n            maxHorz = $parent - CssUtil.outerWidth($previewCell);\r\n        offset[prop] = offset[prop] < minHorz ?\r\n            minHorz :\r\n            (offset[prop] > maxHorz ? maxHorz : offset[prop]);\r\n\r\n        // Constrain vertically\r\n        let totalHeight = CssUtil.outerHeight($el);\r\n        let maxTop = $scrollParent.scrollTop() + CssUtil.innerHeight($parent) - totalHeight;\r\n        if (offset.top > maxTop) {\r\n            offset.top = Math.max(0, maxTop);\r\n        }\r\n\r\n        // Apply css to preview cell\r\n        let previewCss = {\r\n            top: offset.top,\r\n            'z-index': 9999,\r\n        };\r\n        previewCss[prop] = offset[prop];\r\n\r\n        $previewCell.css(previewCss);\r\n\r\n        previewCell['__cell'] = el;\r\n        p.$cellPreviewCell = $previewCell;\r\n        el['__previewCell'] = previewCell;\r\n\r\n        p._bindCellHoverOut(el);\r\n        p._bindCellHoverOut(previewCell);\r\n\r\n        $previewCell.on('mousewheel', (event) => {\r\n            let originalEvent = event.originalEvent;\r\n            let xy = originalEvent.wheelDelta || -originalEvent.detail,\r\n                x = originalEvent.wheelDeltaX || (originalEvent.axis == 1 ? xy : 0),\r\n                y = originalEvent.wheelDeltaY || (originalEvent.axis == 2 ? xy : 0);\r\n\r\n            if (xy) {\r\n                this.hideCellPreview();\r\n            }\r\n\r\n            if (y && p.table.scrollHeight > p.table.clientHeight) {\r\n                let scrollTop = (y * -1) + p.$table.scrollTop();\r\n                p.$table.scrollTop(scrollTop);\r\n            }\r\n\r\n            if (x && p.table.scrollWidth > p.table.clientWidth) {\r\n                let scrollLeft = (x * -1) + p.$table.scrollLeft();\r\n                p.$table.scrollLeft(scrollLeft);\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\n/**\r\n * @private\r\n * @param {HTMLElement} el\r\n */\r\nDGTable.prototype._cellMouseOutEvent = function(_el) {\r\n    this.hideCellPreview();\r\n};\r\n\r\n/**\r\n * Hides the current cell preview,\r\n * or prevents the one that is currently trying to show (in the 'cellpreview' event)\r\n * @public\r\n * @expose\r\n * @returns {DGTable} self\r\n */\r\nDGTable.prototype.hideCellPreview = function() {\r\n    const p = this.p;\r\n    \r\n    if (p.$cellPreviewCell) {\r\n        let previewCell = p.$cellPreviewCell[0];\r\n        let origCell = previewCell['__cell'];\r\n        let selection;\r\n        \r\n        try {\r\n            selection = SelectionHelper.saveSelection(previewCell);\r\n        } catch (ignored) { /* we're ok with this */ }\r\n        \r\n        p.$cellPreviewCell.remove();\r\n        p._unbindCellHoverOut(origCell);\r\n        p._unbindCellHoverOut(previewCell);\r\n        \r\n        try {\r\n            if (selection)\r\n                SelectionHelper.restoreSelection(origCell, selection);\r\n        } catch (ignored) { /* we're ok with this */ }\r\n\r\n        this.trigger('cellpreviewdestroy', previewCell.firstChild, previewCell['physicalRowIndex'], previewCell['columnName'], origCell);\r\n\r\n        origCell['__previewCell'] = null;\r\n        previewCell['__cell'] = null;\r\n\r\n        p.$cellPreviewCell = null;\r\n        p.abortCellPreview = false;\r\n    } else {\r\n        p.abortCellPreview = true;\r\n    }\r\n    \r\n    return this;\r\n};\r\n\r\n// It's a shame the Google Closure Compiler does not support exposing a nested @param\r\n\r\n/**\r\n * @typedef {Object} SERIALIZED_COLUMN\r\n * @property {Number|null|undefined} [order=0]\r\n * @property {String|null|undefined} [width='auto']\r\n * @property {Boolean|null|undefined} [visible=true]\r\n * */\r\n\r\n/**\r\n * @typedef {Object} SERIALIZED_COLUMN_SORT\r\n * @property {String|null|undefined} [column='']\r\n * @property {Boolean|null|undefined} [descending=false]\r\n * */\r\n\r\n/**\r\n * @enum {ColumnWidthMode|number|undefined}\r\n * @const\r\n * @typedef {ColumnWidthMode}\r\n */\r\nconst ColumnWidthMode = {\r\n    /** @const*/ AUTO: 0,\r\n    /** @const*/ ABSOLUTE: 1,\r\n    /** @const*/ RELATIVE: 2,\r\n};\r\n\r\n/**\r\n * @enum {DGTable.Width|String|undefined}\r\n * @const\r\n * @typedef {DGTable.Width}\r\n */\r\nDGTable.Width = {\r\n    /** @const*/ NONE: 'none',\r\n    /** @const*/ AUTO: 'auto',\r\n    /** @const*/ SCROLL: 'scroll',\r\n};\r\n\r\n/**\r\n * @expose\r\n * @typedef {Object} COLUMN_SORT_OPTIONS\r\n * @property {String|null|undefined} column\r\n * @property {Boolean|null|undefined} [descending=false]\r\n * */\r\n\r\n/**\r\n * @expose\r\n * @typedef {Object} COLUMN_OPTIONS\r\n * @property {String|null|undefined} width\r\n * @property {String|null|undefined} name\r\n * @property {String|null|undefined} label\r\n * @property {String|null|undefined} dataPath - defaults to `name`\r\n * @property {String|null|undefined} comparePath - defaults to `dataPath`\r\n * @property {Number|String|null|undefined} comparePath\r\n * @property {Boolean|null|undefined} [resizable=true]\r\n * @property {Boolean|null|undefined} [movable=true]\r\n * @property {Boolean|null|undefined} [sortable=true]\r\n * @property {Boolean|null|undefined} [visible=true]\r\n * @property {String|null|undefined} [cellClasses]\r\n * @property {Boolean|null|undefined} [ignoreMin=false]\r\n * */\r\n\r\n/**\r\n * @typedef {Object} DGTable.Options\r\n * @property {COLUMN_OPTIONS[]} [columns]\r\n * @property {Number} [height]\r\n * @property {DGTable.Width} [width]\r\n * @property {Boolean|null|undefined} [virtualTable=true]\r\n * @property {Boolean|null|undefined} [resizableColumns=true]\r\n * @property {Boolean|null|undefined} [movableColumns=true]\r\n * @property {Number|null|undefined} [sortableColumns=1]\r\n * @property {Boolean|null|undefined} [adjustColumnWidthForSortArrow=true]\r\n * @property {Boolean|null|undefined} [relativeWidthGrowsToFillWidth=true]\r\n * @property {Boolean|null|undefined} [relativeWidthShrinksToFillWidth=false]\r\n * @property {Boolean|null|undefined} [convertColumnWidthsToRelative=false]\r\n * @property {Boolean|null|undefined} [autoFillTableWidth=false]\r\n * @property {String|null|undefined} [cellClasses]\r\n * @property {String|String[]|COLUMN_SORT_OPTIONS|COLUMN_SORT_OPTIONS[]} [sortColumn]\r\n * @property {Function|null|undefined} [cellFormatter=null]\r\n * @property {Function|null|undefined} [headerCellFormatter=null]\r\n * @property {Number|null|undefined} [rowsBufferSize=10]\r\n * @property {Number|null|undefined} [minColumnWidth=35]\r\n * @property {Number|null|undefined} [resizeAreaWidth=8]\r\n * @property {{function(string,boolean):{function(a:*,b:*):boolean}}} [onComparatorRequired]\r\n * @property {String|null|undefined} [resizerClassName=undefined]\r\n * @property {String|null|undefined} [tableClassName=undefined]\r\n * @property {Boolean|null|undefined} [allowCellPreview=true]\r\n * @property {Boolean|null|undefined} [allowHeaderCellPreview=true]\r\n * @property {String|null|undefined} [cellPreviewClassName=undefined]\r\n * @property {Boolean|null|undefined} [cellPreviewAutoBackground=true]\r\n * @property {Element|null|undefined} [el=undefined]\r\n * @property {String|null|undefined} [className=undefined]\r\n * @property {Function|null|undefined} [filter=undefined]\r\n * */\r\n\r\n/**\r\n * @typedef {{\r\n     *  currentTarget: Element,\r\n     *  data: Object.<string, *>,\r\n     *  delegateTarget: Element,\r\n     *  isDefaultPrevented: Boolean,\r\n     *  isImmediatePropagationStopped: Boolean,\r\n     *  isPropagationStopped: Boolean,\r\n     *  namespace: string,\r\n     *  originalEvent: MouseEvent|TouchEvent|Event,\r\n     *  pageX: Number,\r\n     *  pageY: Number,\r\n     *  preventDefault: Function,\r\n     *  props: Object.<string, *>,\r\n     *  relatedTarget: Element,\r\n     *  result: *,\r\n     *  stopImmediatePropagation: Function,\r\n     *  stopPropagation: Function,\r\n     *  target: Element,\r\n     *  timeStamp: Number,\r\n     *  type: string,\r\n     *  which: Number\r\n     * }} jQuery_Event\r\n * */\r\n\r\nif (!$.controls) {\r\n    $.controls = {};\r\n}\r\n\r\n$.controls.dgtable = DGTable;\r\n\r\nexport default DGTable;"],"names":["indexOf","Array","prototype","includes","array","item","call","find","predicate","i","len","length","htmlEncode","text","replace","RowCollection","collection","Object","assign","initialize","apply","arguments","options","sortColumn","add","rows","at","isArray","splice","push","reset","filteredCollection","filterFunc","args","row","onComparatorRequired","onSort","nativeSort","sort","getDefaultComparator","column","descending","columnName","comparePath","split","pathLength","hasPath","lessVal","moreVal","leftRow","rightRow","leftVal","rightVal","silent","comparators","comparator","bind","value","ColumnCollection","get","name","getByOrder","order","normalizeOrder","ordered","col1","col2","getVisibleColumns","visible","getMaxOrder","moveColumn","src","dest","srcOrder","destOrder","col","$","jQuery","hasComputedStyle","document","defaultView","getComputedStyle","jQuerySupportsFractions","fn","jquery","cssExpands","sizeKeys","CssUtil","generateSizeFunction","key","cssExpand","inner","outer","el","Element","style","currentStyle","isBoxing","size","border","padding","includeMargins","parseFloat","margin","undefined","generatejQueryFunction","ret","slice","isChildOf","child","parent","parentNode","SelectionHelper","saveSelection","range","window","getSelection","getRangeAt","commonAncestorContainer","preSelectionRange","cloneRange","selectNodeContents","setEnd","startContainer","startOffset","start","toString","end","restoreSelection","savedSel","charIndex","nodeStack","node","foundStart","stop","createRange","setStart","collapse","pop","nodeType","nextCharIndex","childNodes","sel","removeAllRanges","addRange","ByColumnFilter","keyword","actualVal","caseSensitive","toLowerCase","nativeIndexOf","userAgent","navigator","ieVersion","substr","hasIeDragAndDropBug","createElement","hasOwnProperty","webkitRenderBugfix","oldDisplay","display","offsetHeight","relativizeElement","$el","css","DGTable","Function","concat","VERSION","that","o","p","events","addClass","className","data","on","destroy","onMouseMoveResizeAreaBound","_onMouseMoveResizeArea","onEndDragColumnHeaderBound","_onEndDragColumnHeader","onTableScrolledHorizontallyBound","_onTableScrolledHorizontally","tableSkeletonNeedsRendering","virtualTable","rowsBufferSize","minColumnWidth","Math","max","resizeAreaWidth","resizableColumns","movableColumns","sortableColumns","parseInt","adjustColumnWidthForSortArrow","convertColumnWidthsToRelative","autoFillTableWidth","cellClasses","resizerClassName","tableClassName","allowCellPreview","allowHeaderCellPreview","cellPreviewClassName","cellPreviewAutoBackground","width","Width","NONE","relativeWidthGrowsToFillWidth","relativeWidthShrinksToFillWidth","setCellFormatter","cellFormatter","setHeaderCellFormatter","headerCellFormatter","setFilter","filter","height","setColumns","columns","sortColumns","tmpSortColumns","dataPath","filteredRows","hoverMouseOverHandler","evt","event","relatedTarget","fromElement","contains","_cellMouseOverEvent","hoverMouseOutHandler","toElement","_cellMouseOutEvent","_bindCellHoverIn","addEventListener","_unbindCellHoverIn","removeEventListener","_bindCellHoverOut","_unbindCellHoverOut","attachEvent","detachEvent","eventName","callback","cb","once","off","callbacks","trigger","_parseColumnWidth","minWidth","widthSize","widthMode","ColumnWidthMode","AUTO","RELATIVE","ABSOLUTE","mode","_initColumnFromData","columnData","parsedWidth","ignoreMin","label","resizable","sortable","movable","close","remove","__removed","$resizer","$tbody","trs","_destroyHeaderCells","_unbindCellEventsForTable","$table","empty","workerListeners","j","worker","listener","_deferredRender","clearTimeout","prop","headerRow","rowCount","rowToClean","cells","cellCount","tbody","_unbindCellEventsForRow","render","offsetParent","setTimeout","renderedRows","_clearSortArrows","lastScrollTop","table","scrollTop","lastScrollLeft","scrollLeft","_renderSkeletonBase","_renderSkeletonBody","tableWidthChanged","_renderSkeletonHeaderCells","renderRows","html","append","_updateLastCellWidthFromScrollbar","header","_updateTableWidth","_showSortArrow","_onVirtualTableScrolled","firstVisible","floor","virtualRowHeightFirst","virtualRowHeight","lastVisible","ceil","visibleHeight","oldFirstVisible","oldLastVisible","tbodyChildNodes","countToRemove","min","removeChild","prepend","clearAndRender","first","last","rowClassName","cellClassName","isDataFiltered","visibleColumns","isVirtual","top","physicalRowIndex","colCount","colIndex","_finalWidth","actualWidthConsideringScrollbarWidth","actualWidth","bodyFragment","createDocumentFragment","isRtl","_isTableRtl","virtualRowXAttr","rowData","cell","setAttribute","cellInner","appendChild","innerHTML","_getHtmlForCell","position","_calculateVirtualHeight","virtualRowHeightLast","_calculateTbodyWidth","$row","sumActualWidth","$thisWrapper","left","overflow","appendTo","body","fractionTest","hasFractions","round","outerWidth","scrollbarWidth","normalizedCols","normalizedColumn","_ensureVisibleColumns","addColumn","before","beforeColumn","to","removeColumn","colIdx","formatter","val","hadFilter","filterArgs","extend","_refilter","setColumnLabel","element","firstChild","textContent","destCol","headerCell","$headerRow","beforePos","fromPos","insertBefore","srcWidth","destWidth","tbodyChildren","count","currentSort","_tableSkeletonNeedsRendering","sorts","resort","setColumnVisible","isColumnVisible","setMinColumnWidth","getMinColumnWidth","setSortableColumns","getSortableColumns","setMovableColumns","getMovableColumns","setResizableColumns","getResizableColumns","setComparatorCallback","comparatorCallback","setColumnWidth","oldWidth","_serializeColumnWidth","newWidth","getColumnWidth","getColumnConfig","getColumnsConfig","config","getSortedColumns","sorted","getHtmlForCell","colValue","dataPathIndex","content","getRowYPos","rowIndex","offsetTop","getDataForRow","getRowCount","getIndexForRow","getFilteredRowCount","getIndexForFilteredRow","getDataForFilteredRow","getHeaderRowElement","_horizontalPadding","_horizontalBorderWidth","_calculateWidthAvailableForColumns","detectedWidth","$header","$cells","$cell","getTextWidth","$tableWrapper","lastDetectedWidth","forceUpdate","renderColumns","sizeLeft","relatives","tableWidthBeforeCalculations","absWidthTotal","changedColumnIndexes","totalRelativePercentage","arrowProposedWidth","sizeLeftForRelative","clientWidth","minColumnWidthRelative","isNaN","extraRelative","delta","nonResizableTotal","sizeLeftToFill","conv","NaN","tableWidth","_resizeColumnElements","tableHeightChanged","innerHeight","outerHeight","addRows","firstRow","lastRow","removeRows","lastRowIndex","index","removeRow","refreshRow","isRowVisible","renderedRow","getRowElement","refreshAllVirtualRows","rowsToRender","setRows","getUrlForElementContent","id","blob","getElementById","Blob","BlobBuilder","global","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","builder","getBlob","URL","webkitURL","createObjectURL","isWorkerSupported","createWebWorker","url","Worker","postMessage","unbindWebWorker","abortCellPreview","hideCellPreview","cancelColumnResize","_event","_getColumnByResizePosition","e","rtl","$headerCell","target","closest","previousElementSibling","previousSibling","firstCol","mouseX","pageX","originalEvent","clientX","offset","_onTouchStartColumnHeader","currentTouchId","startTouch","changedTouches","identifier","$eventTarget","currentTarget","startPos","x","y","pageY","currentPos","distanceTreshold","tapAndHoldTimeout","unbind","fakeEvent","Event","extendObjects","each","one","preventDefault","distanceTravelled","sqrt","pow","abs","touch","_onMouseDownColumnHeader","which","selectedHeaderCell","commonAncestor","posCol","posRelative","resizerWidth","zIndex","ignored","_onMouseMoveColumnHeader","cursor","_onMouseUpColumnHeader","bounds","_onMouseLeaveColumnHeader","_onClickColumnHeader","_onStartDragColumnHeader","opacity","dragId","random","dataTransfer","setData","JSON","stringify","actualX","minX","baseX","sizeToSet","unNormalizedSizeToSet","_onDragEnterColumnHeader","dataTransferred","getData","parse","_onDragOverColumnHeader","_onDragLeaveColumnHeader","has","removeClass","_onDropColumnHeader","srcColName","destColName","srcCol","sortedColumns","arrows","arrow","scrollWidth","cellIndex","headerCells","headerCellClassName","prependTo","SCROLL","ieDragDropHandler","dragDrop","draggable","cellInside","createDummyRow","visibility","$dummyTbody","$dummyWrapper","row1","row2","row3","virtualRowHeightMin","virtualRowHeightMax","fragment","tableHeight","overflowY","overflowX","virtualVisibleRows","_renderSkeleton","force","offsetWidth","lastColIndex","lastColWidth","parentSizeMayHaveChanged","elInner","scrollHeight","clientHeight","$elInner","previewCell","$previewCell","isHeaderCell","hasClass","paddingL","paddingR","paddingT","paddingB","requiredWidth","borderBox","transparentBgColor1","tempDiv","backgroundColor","transparentBgColor2","bgColor","selection","$parent","$scrollParent","parentOffset","windowWidth","right","minHorz","maxHorz","totalHeight","maxTop","previewCss","$cellPreviewCell","xy","wheelDelta","detail","wheelDeltaX","axis","wheelDeltaY","_el","origCell","controls","dgtable"],"mappings":"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"}