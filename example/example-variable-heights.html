<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding">
<title>DGTable.js Example</title>
<link rel="stylesheet" href="example.css">
<script src="dependencies/jquery.js"></script>
<script src="dependencies/underscore.js"></script>
<script src="dependencies/backbone.js"></script>
<script type="text/javascript" src="../src/DGTable.js"></script>
<script type="text/javascript" src="../src/DGTable.ColumnCollection.js"></script>
<script type="text/javascript" src="../src/DGTable.RowCollection.js"></script>
<!-- <script type="text/javascript" src="../compiled/DGTable.min.js"></script> -->
<script>
    var sampleData = [
        { first: 'Pearl', last: 'Button', address: '69 Hendford Hill', city: 'MOSS-SIDE' },
        { first: 'Daisy', last: 'Brockhouse', address: '4667 rue Levy', city: 'Montreal' },
        { first: 'Asphodel', last: 'Goodchild', address: '74 New Dover Rd', city: 'WALPOLE ST ANDREW' },
        { first: 'Primrose', last: 'Oldbuck', address: '1331 Sherwood Circle', city: 'Lafayette' },
        { first: 'Savanna', last: 'Took', address: '4200 Penn Street', city: 'Stlouis' },
        { first: 'Maxima', last: 'Sackville', address: 'Tabaré 22', city: 'Riachuelo' },
        { first: 'Pearl', last: 'Baggins', address: 'Del Monte 92', city: 'Los Titanes' },
        { first: 'Belladonna', last: 'Boffin', address: '63 Palmerston Street', city: 'Dinsdale' },
        { first: 'Rorimac', last: 'Bolger-Baggins', address: '3028 Scotchmere Dr', city: 'Sarnia' },
        { first: 'Merimac', last: 'Brown', address: 'Ibirapita 4', city: 'Montevideo' },
        { first: 'Olo', last: 'Maggot', address: '72 Golden Knowes Road', city: 'FRITH BANK' },
        { first: 'Primula', last: 'Goold', address: '4143 7th Ave', city: 'Calgary' },
        { first: 'Briffo', last: 'Mugwort', address: '139 Amun Place', city: 'Fairy Springs' },
        { first: 'Merimac', last: 'Banks', address: '180 Murray Street', city: 'Welbourn' },
        { first: 'Bowman', last: 'Goold', address: 'Del Monte 2', city: 'Lomas de Solymar' },
        { first: 'Athanaric', last: 'Goldworthy', address: '76 Front St', city: 'HENBURY' },
        { first: 'Poppy<br />Different height', last: 'Lightfoot', address: '2151 St Marys Rd', city: 'Winnipeg' },
        { first: 'Frodo', last: 'Brockhouse', address: '1878 Blanshard', city: 'Victoria' },
        { first: 'Elanor', last: 'Gawkroger', address: '46 Brook Street', city: 'Parkvale' },
        { first: 'Rowan', last: 'Grubb', address: '159 Karen Lane', city: 'Woolston' },
        { first: 'Tobold', last: 'Tunnelly', address: '4867 St Jean Baptiste St', city: 'La Pocatiere' },
        { first: 'Savanna', last: 'Sandyman', address: '2976 Jasper Ave', city: 'Edmonton' },
        { first: 'Hob', last: 'Grubb', address: '4517 Eagle Rd', city: 'Toronto' },
        { first: 'Razanur', last: 'Goodchild', address: '17 40th Street', city: 'Calgary' },
        { first: 'Cerdic', last: 'Rumble', address: 'Ituzaingó 73', city: 'Joanicó' },
        { first: 'Matilda', last: 'Button', address: '33 Broomfield Place', city: 'STONEHAVEN' },
        { first: 'Sméagol', last: 'Underhill', address: '21 Clifton Terrace', city: 'Washdyke' },
        { first: 'Gringamor', last: 'Bracegirdle', address: 'Guayabos 34', city: 'Capilla del Sauce' },
        { first: 'Pearl', last: 'Sandheaver', address: '61 Shire Oak Road', city: 'SCALE HOUSES' },
        { first: 'Malva', last: 'Gammidge', address: '48 Witney Way', city: 'KIRKTON OF STRATHMARTINE' },
        { first: 'Rowan', last: 'Smallburrow', address: '74 Harehills Lane', city: 'ROXWELL' },
        { first: 'Isengrim', last: 'Maggot', address: '4784 rue Saint-Antoine', city: 'Granby' },
        { first: 'Melba', last: 'Goold', address: 'Purificacion 3', city: 'Baltasar Brum' },
        { first: 'Rosa', last: 'Hogpen', address: '123 Carmen Road', city: 'Hornby' },
        { first: 'Amanda', last: 'Sackville', address: '2806 Caynor Circle', city: 'Somerville' },
        { first: 'Flavus', last: 'Boffin', address: '8 Homer Place Upper', city: 'Ilam' },
        { first: 'Frodo', last: 'Oldbuck', address: '74 Charles Street', city: 'Parahaki' },
        { first: 'Hildibrand', last: 'Grubb', address: '4396 Single Street', city: 'South Boston' },
        { first: 'Largo', last: 'Labingi', address: 'Ombù 53', city: 'Conchillas' },
        { first: 'Caramella', last: 'Brandybuck', address: '43 Corpening Drive', city: 'Southfield' },
        { first: 'Flambard', last: 'Greenhand', address: '910 Churchill Plaza', city: 'Sault Ste Marie' },
        { first: 'Seredic', last: 'Goodbody', address: '3517 Goldie Lane', city: 'Cincinnati' },
        { first: 'Carambo', last: 'Smallburrow', address: '10 Essex Rd', city: 'TARREL' },
        { first: 'Amalda', last: 'Hayward', address: '34 Brynglas Road', city: 'GLYNDE' },
        { first: 'Prima', last: 'Chubb', address: '4340 Apple Lane', city: 'Peoria' }
    ];
</script>
</head>
<body>
<div>
	<h3>Variable row heights is not supported yet in virtual mode. This is a test page to test the progress of this feature.</h3>

    <label for="filterInput">Filter by second column:</label>
    <input id="filterInput" type="text" onkeyup="table.filter('last', this.value);" /> <br />

    <button id="k100button">Add 100,000 records</button> | <button id="wwbutton">Create a web worker</button> |
    <button id="amsbutton">Allow multiple sort</button> | <button id="rcmpbutton">Set random comparator for sorting 4th column</button>

    <hr />

    <div id='example'></div>

    <script>
        var table = new DGTable({
            columns : [
                {name : 'first', label: 'Locked column', movable: false},
                {name : 'last', label: 'Test data'},
                {name : 'address', label: 'More'},
                {name : 'city', label: 'Example'}
            ],
            height : 500,
            formatter : function (val, colName) {
                if (colName === 'address') {
                    return '<i>' + val + '</i>';
                }
                return val;
            }
        });

        $('#example').append(table.el);

        table.render().addRows(sampleData);

        $('#k100button').on('click', function(){

            var data = [];
            for (var i = 1; i < 100000; i ++) {
                data.push({
                    'first': sampleData[Math.floor(Math.random() * sampleData.length)].first,
                    'last': sampleData[Math.floor(Math.random() * sampleData.length)].last,
                    'address': sampleData[Math.floor(Math.random() * sampleData.length)].address,
                    'city': sampleData[Math.floor(Math.random() * sampleData.length)].city
                });
            }
            table.addRows(data);

        });

        $('#wwbutton').on('click', function(){

            var workerUrl = table.getUrlForElementContent('data-worker-script');
            table.createWebWorker(workerUrl);

        });

        $('#amsbutton').on('click', function(){

            table.setSortableColumns(2);

        });

        $('#rcmpbutton').on('click', function(){

            table.setComparatorCallback(function(column, descending) {
                if (column == 'city') {
                    return function(left, right) {
                        return Math.floor(Math.random() * 3) - 1;
                    }
                }
                return null;
            })

        });

    </script>
</div>
<script type="text/x-worker-script" language="javascript" id="data-worker-script">
    var sampleData = [
        { first: 'Bilbo', last: 'Baggins', address: 'The Shire', city: 'Middle Earth' },
        { first: 'Frodo', last: 'Baggins', address: 'The Shire', city: 'Middle Earth' },
        { first: 'Precious', last: 'Baggins', address: 'Frodo\'s Finger', city: 'Middle Earth' }
    ];

    setInterval(function () {
        self.postMessage({rows: sampleData});
    }, 2000);
</script>
</body>
</html>